<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="TOKN">ï»¿</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="WHIT">	</span><span class="STRN">"translatorID"</span><span class="PUNC">:</span><span class="STRN">"d2c86970-04f7-4ba5-9de6-bec897930eb5"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="WHIT">	</span><span class="STRN">"translatorType"</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="WHIT">	</span><span class="STRN">"label"</span><span class="PUNC">:</span><span class="STRN">"MARC2"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="WHIT">	</span><span class="STRN">"creator"</span><span class="PUNC">:</span><span class="STRN">"Florian Ziche"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="WHIT">	</span><span class="STRN">"target"</span><span class="PUNC">:</span><span class="STRN">"marc2"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="WHIT">	</span><span class="STRN">"minVersion"</span><span class="PUNC">:</span><span class="STRN">"2.0"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="WHIT">	</span><span class="STRN">"maxVersion"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="WHIT">	</span><span class="STRN">"priority"</span><span class="PUNC">:</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="WHIT">	</span><span class="STRN">"inRepository"</span><span class="PUNC">:</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="WHIT">	</span><span class="STRN">"lastUpdated"</span><span class="PUNC">:</span><span class="STRN">"2010-09-04 22:45:00"</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 13</span> 
<span class='line'> 14</span> </span><span class="COMM">/**
<span class='line'> 15</span>  * @fileOverview Common functionality for handling MARC records.
<span class='line'> 16</span>  * @author Florian Ziche
<span class='line'> 17</span>  * @version 0.1
<span class='line'> 18</span>  */</span><span class="WHIT">
<span class='line'> 19</span> 
<span class='line'> 20</span> </span><span class="COMM">/**
<span class='line'> 21</span>  * @namespace Namespace containing the module's public members. 
<span class='line'> 22</span>  */</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Marc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 24</span> 
<span class='line'> 25</span> </span><span class="COMM">/**
<span class='line'> 26</span>  * @namespace Lists the currently known MARC types and their human-readable names.
<span class='line'> 27</span>  */</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="NAME">Marc.Types</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="WHIT">	</span><span class="STRN">"marc21"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"MARC-21"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="WHIT">	</span><span class="STRN">"unimarc"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Unimarc"</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 32</span> 
<span class='line'> 33</span> </span><span class="COMM">/**
<span class='line'> 34</span>  * @namespace Delimiter strings used in binary MARC files.
<span class='line'> 35</span>  */</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="NAME">Marc.Delimiters</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="WHIT">	</span><span class="NAME">FIELD_TERMINATOR</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"\x1E"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="WHIT">	</span><span class="NAME">RECORD_TERMINATOR</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"\x1D"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="WHIT">	</span><span class="NAME">SUBFIELD_DELIMITER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"\x1F"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 40</span> </span><span class="WHIT">	</span><span class="NAME">SUBFIELD_SPLITTER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="REGX">/[\x1F\x1E]+/</span><span class="WHIT">
<span class='line'> 41</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 42</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="COMM">/**
<span class='line'> 44</span>  *  @namespace Initialization helpers.
<span class='line'> 45</span>  **/</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="NAME">Marc.Config</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 47</span> </span><span class="WHIT">	</span><span class="NAME">setTypeOptions</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 48</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">Marc.Types</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="WHIT">			</span><span class="NAME">Zotero.addOption</span><span class="PUNC">(</span><span class="NAME">Marc.Types</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 52</span> 
<span class='line'> 53</span> </span><span class="WHIT">	</span><span class="NAME">getTypeOption</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">Marc.Types</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 55</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Zotero.getOption</span><span class="PUNC">(</span><span class="NAME">Marc.Types</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 56</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 57</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 61</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 62</span> 
<span class='line'> 63</span> </span><span class="COMM">/**
<span class='line'> 64</span>  * Constructs a Marc.Tag.
<span class='line'> 65</span>  * @class Encapsulates information abaout a MARC field tag (e.g. "245")
<span class='line'> 66</span>  */</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="NAME">Marc.Tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">flags</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="WHIT">	</span><span class="NAME">this.tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="WHIT">	</span><span class="NAME">this.flags</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">flags</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> 
<span class='line'> 72</span> </span><span class="COMM">/** Flags describing tags characteristics. */</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="NAME">Marc.Tag.Flags</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="WHIT">	</span><span class="NAME">MANDATORY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="WHIT">	</span><span class="NAME">NOTREPEATABLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 77</span> 
<span class='line'> 78</span> 
<span class='line'> 79</span> </span><span class="NAME">Marc.Tag.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 80</span> </span><span class="WHIT">	</span><span class="NAME">constructor</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'> 82</span> 	 * @returns {String} the object's tag member (e.g. "245")
<span class='line'> 83</span> 	 */</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="WHIT">	</span><span class="NAME">toString</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.tag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 87</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 88</span> 
<span class='line'> 89</span> 
<span class='line'> 90</span> </span><span class="COMM">/**
<span class='line'> 91</span>  *  @namespace Marc-21 constants and utilities.
<span class='line'> 92</span>  **/</span><span class="WHIT">
<span class='line'> 93</span> </span><span class="NAME">Marc.Marc21</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 94</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'> 95</span> 	 * Returns a valid Zotero creatorType for a Marc-21 relator code.
<span class='line'> 96</span> 	 * @param {String} relatorCode the three-letter Marc-21 relator code
<span class='line'> 97</span> 	 * @see &lt;a href="http://www.loc.gov/marc/relators/relaterm.html">Marc-21 relators&lt;/a>
<span class='line'> 98</span> 	 */</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="WHIT">	</span><span class="NAME">getCreatorType</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">relatorCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>100</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">relatorCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>101</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"acp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Art copyist</span><span class="WHIT">
<span class='line'>102</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"anm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Animator</span><span class="WHIT">
<span class='line'>103</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"arc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Architect</span><span class="WHIT">
<span class='line'>104</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"art"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Artist</span><span class="WHIT">
<span class='line'>105</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"bdd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Binding designer</span><span class="WHIT">
<span class='line'>106</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"bjd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Bookjacket designer</span><span class="WHIT">
<span class='line'>107</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"bkd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Book designer</span><span class="WHIT">
<span class='line'>108</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"bnd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Binder</span><span class="WHIT">
<span class='line'>109</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"bpd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Bookplate designer</span><span class="WHIT">
<span class='line'>110</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"chr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Choreographer</span><span class="WHIT">
<span class='line'>111</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cll"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Calligrapher</span><span class="WHIT">
<span class='line'>112</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"clr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Colorist</span><span class="WHIT">
<span class='line'>113</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"clt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Collotyper</span><span class="WHIT">
<span class='line'>114</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cmt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Compositor</span><span class="WHIT">
<span class='line'>115</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cov"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Cover designer</span><span class="WHIT">
<span class='line'>116</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cst"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Costume designer</span><span class="WHIT">
<span class='line'>117</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dln"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Delineator</span><span class="WHIT">
<span class='line'>118</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"drm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Draftsman</span><span class="WHIT">
<span class='line'>119</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dsr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Designer</span><span class="WHIT">
<span class='line'>120</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"egr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Engraver</span><span class="WHIT">
<span class='line'>121</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"elt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Electrotyper</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"etr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Etcher</span><span class="WHIT">
<span class='line'>123</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"fac"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Facsimilist</span><span class="WHIT">
<span class='line'>124</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ill"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Illustrator</span><span class="WHIT">
<span class='line'>125</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ilu"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Illuminator</span><span class="WHIT">
<span class='line'>126</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lgd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Lighting designer</span><span class="WHIT">
<span class='line'>127</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lsa"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Landscape architect</span><span class="WHIT">
<span class='line'>128</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ltg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Lithographer</span><span class="WHIT">
<span class='line'>129</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mcp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Music copyist</span><span class="WHIT">
<span class='line'>130</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mrb"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Marbler</span><span class="WHIT">
<span class='line'>131</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mte"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Metal-engraver</span><span class="WHIT">
<span class='line'>132</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pht"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Photographer</span><span class="WHIT">
<span class='line'>133</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"prm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Printmaker</span><span class="WHIT">
<span class='line'>134</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rbr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Rubricator</span><span class="WHIT">
<span class='line'>135</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"scl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Sculptor</span><span class="WHIT">
<span class='line'>136</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"scr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Scribe</span><span class="WHIT">
<span class='line'>137</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"sds"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Sound designer</span><span class="WHIT">
<span class='line'>138</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"std"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Set designer</span><span class="WHIT">
<span class='line'>139</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"tyd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Type designer</span><span class="WHIT">
<span class='line'>140</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"tyg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Typographer</span><span class="WHIT">
<span class='line'>141</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"vdg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Videographer</span><span class="WHIT">
<span class='line'>142</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"wdc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Woodcutter</span><span class="WHIT">
<span class='line'>143</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"wde"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Wood-engraver</span><span class="WHIT">
<span class='line'>144</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"artist"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>145</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"act"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Actor</span><span class="WHIT">
<span class='line'>146</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cnd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Conductor</span><span class="WHIT">
<span class='line'>147</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dnc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Dancer</span><span class="WHIT">
<span class='line'>148</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"itr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Instrumentalist</span><span class="WHIT">
<span class='line'>149</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mus"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Musician</span><span class="WHIT">
<span class='line'>150</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ppt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Puppeteer</span><span class="WHIT">
<span class='line'>151</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"prf"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Performer</span><span class="WHIT">
<span class='line'>152</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"sng"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Singer</span><span class="WHIT">
<span class='line'>153</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"spk"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Speaker</span><span class="WHIT">
<span class='line'>154</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"stl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Storyteller</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"voc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Vocalist</span><span class="WHIT">
<span class='line'>156</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"performer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>157</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"adp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Adapter</span><span class="WHIT">
<span class='line'>158</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"aft"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Author of afterword, colophon, etc.</span><span class="WHIT">
<span class='line'>159</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"anl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Analyst</span><span class="WHIT">
<span class='line'>160</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"arr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Arranger</span><span class="WHIT">
<span class='line'>161</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"aui"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Author of introduction</span><span class="WHIT">
<span class='line'>162</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"blw"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Blurb writer</span><span class="WHIT">
<span class='line'>163</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"clb"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Collaborator</span><span class="WHIT">
<span class='line'>164</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cng"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Cinematographer</span><span class="WHIT">
<span class='line'>165</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"con"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Conservator</span><span class="WHIT">
<span class='line'>166</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ctb"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contributor</span><span class="WHIT">
<span class='line'>167</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ctr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contractor</span><span class="WHIT">
<span class='line'>168</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dtc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Data contributor</span><span class="WHIT">
<span class='line'>169</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dtm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Data manager</span><span class="WHIT">
<span class='line'>170</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"gis"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Geographic information specialist</span><span class="WHIT">
<span class='line'>171</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"nrt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Narrator</span><span class="WHIT">
<span class='line'>172</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"red"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Redactor</span><span class="WHIT">
<span class='line'>173</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"res"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Researcher</span><span class="WHIT">
<span class='line'>174</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rev"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Reviewer</span><span class="WHIT">
<span class='line'>175</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rpt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Reporter</span><span class="WHIT">
<span class='line'>176</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rsg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Restager</span><span class="WHIT">
<span class='line'>177</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rth"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Research team head</span><span class="WHIT">
<span class='line'>178</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rtm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Research team member</span><span class="WHIT">
<span class='line'>179</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"srv"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Surveyor</span><span class="WHIT">
<span class='line'>180</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"tch"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Teacher</span><span class="WHIT">
<span class='line'>181</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"wam"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Writer of accompanying material</span><span class="WHIT">
<span class='line'>182</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"contributor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>183</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ann"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Annotator</span><span class="WHIT">
<span class='line'>184</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cmm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Commentator</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cwt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Commentator for written text</span><span class="WHIT">
<span class='line'>186</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"commenter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>187</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ant"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Bibliographic antecedent //reviewedAuthor?</span><span class="WHIT">
<span class='line'>188</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"app"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Applicant</span><span class="WHIT">
<span class='line'>189</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"asg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Assignee</span><span class="WHIT">
<span class='line'>190</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"asn"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Associated name</span><span class="WHIT">
<span class='line'>191</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"auc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Auctioneer</span><span class="WHIT">
<span class='line'>192</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"bsl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Bookseller</span><span class="WHIT">
<span class='line'>193</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cli"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Client</span><span class="WHIT">
<span class='line'>194</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cns"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Censor</span><span class="WHIT">
<span class='line'>195</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"coe"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contestant -appellee</span><span class="WHIT">
<span class='line'>196</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"col"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Collector</span><span class="WHIT">
<span class='line'>197</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cos"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contestant</span><span class="WHIT">
<span class='line'>198</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cot"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contestant -appellant</span><span class="WHIT">
<span class='line'>199</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cpc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Copyright claimant</span><span class="WHIT">
<span class='line'>200</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cpe"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Complainant-appellee</span><span class="WHIT">
<span class='line'>201</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cph"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Copyright holder</span><span class="WHIT">
<span class='line'>202</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cpl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Complainant</span><span class="WHIT">
<span class='line'>203</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cpt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Complainant-appellant</span><span class="WHIT">
<span class='line'>204</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"crr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Corrector</span><span class="WHIT">
<span class='line'>205</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cte"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contestee-appellee</span><span class="WHIT">
<span class='line'>206</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cts"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contestee</span><span class="WHIT">
<span class='line'>207</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ctt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Contestee-appellant</span><span class="WHIT">
<span class='line'>208</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dfd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Defendant</span><span class="WHIT">
<span class='line'>209</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dfe"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Defendant-appellee</span><span class="WHIT">
<span class='line'>210</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dft"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Defendant-appellant</span><span class="WHIT">
<span class='line'>211</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dgg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Degree grantor</span><span class="WHIT">
<span class='line'>212</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dnr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Donor</span><span class="WHIT">
<span class='line'>213</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dpb"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Distribution place</span><span class="WHIT">
<span class='line'>214</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dpc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Depicted</span><span class="WHIT">
<span class='line'>215</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dpt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Depositor</span><span class="WHIT">
<span class='line'>216</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dst"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Distributor</span><span class="WHIT">
<span class='line'>217</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dte"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Dedicatee</span><span class="WHIT">
<span class='line'>218</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dto"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Dedicator</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"evp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Event place</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"fmo"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Former owner</span><span class="WHIT">
<span class='line'>221</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"fpy"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//First party</span><span class="WHIT">
<span class='line'>222</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"frg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Forger</span><span class="WHIT">
<span class='line'>223</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"hnr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Honoree</span><span class="WHIT">
<span class='line'>224</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ins"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Inscriber</span><span class="WHIT">
<span class='line'>225</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lbr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Laboratory</span><span class="WHIT">
<span class='line'>226</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ldr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Laboratory director</span><span class="WHIT">
<span class='line'>227</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"led"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Lead</span><span class="WHIT">
<span class='line'>228</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lee"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Libelee-appellee</span><span class="WHIT">
<span class='line'>229</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lel"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Libelee</span><span class="WHIT">
<span class='line'>230</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"len"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Lender</span><span class="WHIT">
<span class='line'>231</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"let"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Libelee-appellant</span><span class="WHIT">
<span class='line'>232</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lie"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Libelant-appellee</span><span class="WHIT">
<span class='line'>233</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lil"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Libelant</span><span class="WHIT">
<span class='line'>234</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lit"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Libelant-appellant</span><span class="WHIT">
<span class='line'>235</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lse"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Licensee</span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lso"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Licensor</span><span class="WHIT">
<span class='line'>237</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mfp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Manufacture place</span><span class="WHIT">
<span class='line'>238</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mfr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Manufacturer</span><span class="WHIT">
<span class='line'>239</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mdc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Metadata contact</span><span class="WHIT">
<span class='line'>240</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mon"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Monitor</span><span class="WHIT">
<span class='line'>241</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"opn"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Opponent</span><span class="WHIT">
<span class='line'>242</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"org"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Originator</span><span class="WHIT">
<span class='line'>243</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"orm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Organizer of meeting</span><span class="WHIT">
<span class='line'>244</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"oth"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Other</span><span class="WHIT">
<span class='line'>245</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"own"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Owner</span><span class="WHIT">
<span class='line'>246</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pat"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Patron</span><span class="WHIT">
<span class='line'>247</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pbl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Publisher</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pma"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Permitting agency</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"prc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Process contact</span><span class="WHIT">
<span class='line'>250</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"prp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Production place</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pte"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Plaintiff -appellee</span><span class="WHIT">
<span class='line'>252</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ptf"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Plaintiff</span><span class="WHIT">
<span class='line'>253</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ptt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Plaintiff-appellant</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pup"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Publication place</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rps"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Repository</span><span class="WHIT">
<span class='line'>256</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rpy"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Responsible party</span><span class="WHIT">
<span class='line'>257</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rse"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Respondent-appellee</span><span class="WHIT">
<span class='line'>258</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rsp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Respondent</span><span class="WHIT">
<span class='line'>259</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rst"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Respondent-appellant</span><span class="WHIT">
<span class='line'>260</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"sgn"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Signer</span><span class="WHIT">
<span class='line'>261</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"spy"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Second party</span><span class="WHIT">
<span class='line'>262</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"stn"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Standards body</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"uvp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//University place</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"wit"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Witness</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"contributor"</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//undefined; ?</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"aqt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Author in quotations or text abstracts</span><span class="WHIT">
<span class='line'>267</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ard"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Artistic director</span><span class="WHIT">
<span class='line'>268</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cur"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Curator</span><span class="WHIT">
<span class='line'>269</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pdr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Project director</span><span class="WHIT">
<span class='line'>270</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"tcd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Technical director</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"director"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"att"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Attributed name</span><span class="WHIT">
<span class='line'>273</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"aut"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Author</span><span class="WHIT">
<span class='line'>274</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dis"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Dissertant</span><span class="WHIT">
<span class='line'>275</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dub"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Dubious author</span><span class="WHIT">
<span class='line'>276</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>277</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"aud"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Author of dialog</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"aus"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Author of screenplay</span><span class="WHIT">
<span class='line'>279</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"sce"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Scenarist</span><span class="WHIT">
<span class='line'>280</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"scriptwriter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>281</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"bkp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Book producer</span><span class="WHIT">
<span class='line'>282</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"producer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>283</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ccp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Conceptor</span><span class="WHIT">
<span class='line'>284</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"inv"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Inventor</span><span class="WHIT">
<span class='line'>285</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pth"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Patent holder</span><span class="WHIT">
<span class='line'>286</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"inventor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>287</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cmp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Composer</span><span class="WHIT">
<span class='line'>288</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"composer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>289</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"com"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Compiler</span><span class="WHIT">
<span class='line'>290</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"edt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Editor</span><span class="WHIT">
<span class='line'>291</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"flm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Film editor</span><span class="WHIT">
<span class='line'>292</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"editor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>293</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"cre"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Creator</span><span class="WHIT">
<span class='line'>294</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"drt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Director</span><span class="WHIT">
<span class='line'>295</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"fld"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Field director</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"msd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Musical director</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ths"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Thesis advisor</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"director"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>299</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"crp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Correspondent</span><span class="WHIT">
<span class='line'>300</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rcp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Recipient</span><span class="WHIT">
<span class='line'>301</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"recipient"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>302</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"csl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Consultant</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"csp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Consultant to a project</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"exp"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Expert</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"sad"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Scientific advisor</span><span class="WHIT">
<span class='line'>306</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"counsel"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ctg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Cartographer</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"cartographer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>309</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"elg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Electrician</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"eng"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Engineer</span><span class="WHIT">
<span class='line'>311</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mrk"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Markup editor</span><span class="WHIT">
<span class='line'>312</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pfr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Proofreader</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"plt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Platemaker</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pop"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Printer of plates</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ppm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Papermaker</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"prd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Production personnel</span><span class="WHIT">
<span class='line'>317</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pmn"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Production manager</span><span class="WHIT">
<span class='line'>318</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"prt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Printer</span><span class="WHIT">
<span class='line'>319</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"rce"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Recording engineer</span><span class="WHIT">
<span class='line'>320</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ren"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Renderer</span><span class="WHIT">
<span class='line'>321</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"sec"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Secretary</span><span class="WHIT">
<span class='line'>322</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"stm"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Stage manager</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"str"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Stereotyper</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"trc"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Transcriber</span><span class="WHIT">
<span class='line'>325</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"castMember"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>326</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"fnd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Funder</span><span class="WHIT">
<span class='line'>327</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"sht"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Supporting host</span><span class="WHIT">
<span class='line'>328</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"cosponsor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>329</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"hst"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Host</span><span class="WHIT">
<span class='line'>330</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"mod"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Moderator</span><span class="WHIT">
<span class='line'>331</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"presenter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>332</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ive"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Interviewee</span><span class="WHIT">
<span class='line'>333</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"interviewee"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>334</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ivr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Interviewer</span><span class="WHIT">
<span class='line'>335</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"interviewer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>336</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lbt"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Librettist</span><span class="WHIT">
<span class='line'>337</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"lyr"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Lyricist</span><span class="WHIT">
<span class='line'>338</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"wordsBy"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>339</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pbd"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Publishing director</span><span class="WHIT">
<span class='line'>340</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"seriesEditor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>341</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"prg"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Programmer</span><span class="WHIT">
<span class='line'>342</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"programmer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>343</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pro"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Producer</span><span class="WHIT">
<span class='line'>344</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"producer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>345</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"pta"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Patent applicant</span><span class="WHIT">
<span class='line'>346</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"attorneyAgent"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>347</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"spn"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Sponsor</span><span class="WHIT">
<span class='line'>348</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"sponsor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>349</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"trl"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//Translator</span><span class="WHIT">
<span class='line'>350</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"translator"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>352</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"contributor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>353</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>354</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>355</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>356</span> </span><span class="WHIT">	</span><span class="COMM">/** Match an MARC-21 script code to IANA. 
<span class='line'>357</span> 	 * @param {String} code A MARC-21 script code
<span class='line'>358</span> 	 * @returns {String}
<span class='line'>359</span> 	 * @see &lt;a href="http://www.loc.gov/marc/bibliographic/ecbdcntf.html">MARC Manual&lt;/a> 
<span class='line'>360</span> 	 * @see &lt;a href="http://www.iana.org/assignments/language-subtag-registry">IANA list&lt;/a> 
<span class='line'>361</span> 	 */</span><span class="WHIT">
<span class='line'>362</span> </span><span class="WHIT">	</span><span class="NAME">Scripts</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>363</span> </span><span class="WHIT">		</span><span class="STRN">"3"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Arab"</span><span class="PUNC">,</span><span class="WHIT">	</span><span class="COMM">//Arabic</span><span class="WHIT">
<span class='line'>364</span> </span><span class="WHIT">		</span><span class="STRN">"B"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Latn"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>365</span> </span><span class="WHIT">		</span><span class="STRN">"1"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Hans"</span><span class="PUNC">,</span><span class="WHIT">	</span><span class="COMM">//Chinese, Japanese, Korean (?? assume Hans)</span><span class="WHIT">
<span class='line'>366</span> </span><span class="WHIT">		</span><span class="STRN">"N"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Cyrl"</span><span class="PUNC">,</span><span class="WHIT">	</span><span class="COMM">//Cyrillic</span><span class="WHIT">
<span class='line'>367</span> </span><span class="WHIT">		</span><span class="STRN">"S"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Grek"</span><span class="PUNC">,</span><span class="WHIT">	</span><span class="COMM">//Greek</span><span class="WHIT">
<span class='line'>368</span> </span><span class="WHIT">		</span><span class="STRN">"2"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Hebr"</span><span class="WHIT">
<span class='line'>369</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>370</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span> 
<span class='line'>372</span> </span><span class="COMM">/**
<span class='line'>373</span>  * @namespace Mapping of human-readable names to Marc-21 tags. The type of each property
<span class='line'>374</span>  * is an object with a "tag" property containing the three-digit Marc-21 tag. 
<span class='line'>375</span>  */</span><span class="WHIT">
<span class='line'>376</span> </span><span class="NAME">Marc.Marc21.Tags</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>377</span> </span><span class="WHIT">	</span><span class="NAME">CONTROL_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"001"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>378</span> </span><span class="WHIT">	</span><span class="NAME">CONTROL_NUMBER_IDENTIFIER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"003"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>379</span> </span><span class="WHIT">	</span><span class="NAME">DATE_AND_TIME_OF_LATEST_TRANSACTION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"005"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>380</span> </span><span class="WHIT">	</span><span class="NAME">FIXED_LENGTH_DATA_ELEMENTS_ADDITIONAL_MATERIAL_CHARACTERISTICS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"006"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>381</span> </span><span class="WHIT">	</span><span class="NAME">PHYSICAL_DESCRIPTION_FIXED_FIELD</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"007"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>382</span> </span><span class="WHIT">	</span><span class="NAME">FIXED_LENGTH_DATA_ELEMENTS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"008"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>383</span> </span><span class="WHIT">	</span><span class="NAME">LIBRARY_OF_CONGRESS_CONTROL_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"010"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>384</span> </span><span class="WHIT">	</span><span class="NAME">PATENT_CONTROL_INFORMATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"013"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>385</span> </span><span class="WHIT">	</span><span class="NAME">NATIONAL_BIBLIOGRAPHY_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"015"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>386</span> </span><span class="WHIT">	</span><span class="NAME">NATIONAL_BIBLIOGRAPHIC_AGENCY_CONTROL_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"016"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>387</span> </span><span class="WHIT">	</span><span class="NAME">COPYRIGHT_OR_LEGAL_DEPOSIT_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"017"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>388</span> </span><span class="WHIT">	</span><span class="NAME">COPYRIGHT_ARTICLE_FEE_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"018"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>389</span> </span><span class="WHIT">	</span><span class="NAME">ISBN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"020"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">	</span><span class="NAME">ISSN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"022"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>391</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_STANDARD_IDENTIFIER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"024"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>392</span> </span><span class="WHIT">	</span><span class="NAME">OVERSEAS_ACQUISITION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"025"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>393</span> </span><span class="WHIT">	</span><span class="NAME">STANDARD_TECHNICAL_REPORT_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"027"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>394</span> </span><span class="WHIT">	</span><span class="NAME">PUBLISHER_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"028"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>395</span> </span><span class="WHIT">	</span><span class="NAME">CODEN_DESIGNATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"030"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>396</span> </span><span class="WHIT">	</span><span class="NAME">MUSICAL_INCIPITS_INFORMATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"031"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>397</span> </span><span class="WHIT">	</span><span class="NAME">POSTAL_REGISTRATION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"032"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>398</span> </span><span class="WHIT">	</span><span class="NAME">DATE_TIME_AND_PLACE_OF_AN_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"033"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>399</span> </span><span class="WHIT">	</span><span class="NAME">CODED_CARTOGRAPHIC_MATHEMATICAL_DATA</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"034"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>400</span> </span><span class="WHIT">	</span><span class="NAME">SYSTEM_CONTROL_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"035"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>401</span> </span><span class="WHIT">	</span><span class="NAME">ORIGINAL_STUDY_NUMBER_FOR_COMPUTER_DATA_FILES</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"036"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>402</span> </span><span class="WHIT">	</span><span class="NAME">SOURCE_OF_ACQUISITION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"037"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>403</span> </span><span class="WHIT">	</span><span class="NAME">RECORD_CONTENT_LICENSOR</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"038"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>404</span> </span><span class="WHIT">	</span><span class="NAME">CATALOGING_SOURCE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"040"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>405</span> </span><span class="WHIT">	</span><span class="NAME">LANGUAGE_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"041"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">	</span><span class="NAME">AUTHENTICATION_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"042"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">	</span><span class="NAME">GEOGRAPHIC_AREA_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"043"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">	</span><span class="NAME">COUNTRY_OF_PUBLISHING_PRODUCING_ENTITY_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"044"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>409</span> </span><span class="WHIT">	</span><span class="NAME">TIME_PERIOD_OF_CONTENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"045"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>410</span> </span><span class="WHIT">	</span><span class="NAME">SPECIAL_CODED_DATES</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"046"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>411</span> </span><span class="WHIT">	</span><span class="NAME">FORM_OF_MUSICAL_COMPOSITION_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"047"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>412</span> </span><span class="WHIT">	</span><span class="NAME">NUMBER_OF_MUSICAL_INSTRUMENTS_OR_VOICES_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"048"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>413</span> </span><span class="WHIT">	</span><span class="NAME">LIBRARY_OF_CONGRESS_CALL_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"050"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>414</span> </span><span class="WHIT">	</span><span class="NAME">LIBRARY_OF_CONGRESS_COPY_ISSUE_OFFPRINT_STATEMENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"051"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>415</span> </span><span class="WHIT">	</span><span class="NAME">GEOGRAPHIC_CLASSIFICATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"052"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>416</span> </span><span class="WHIT">	</span><span class="NAME">CLASSIFICATION_NUMBERS_ASSIGNED_IN_CANADA</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"055"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>417</span> </span><span class="WHIT">	</span><span class="NAME">NATIONAL_LIBRARY_OF_MEDICINE_CALL_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"060"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>418</span> </span><span class="WHIT">	</span><span class="NAME">NATIONAL_LIBRARY_OF_MEDICINE_COPY_STATEMENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"061"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>419</span> </span><span class="WHIT">	</span><span class="NAME">CHARACTER_SETS_PRESENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"066"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>420</span> </span><span class="WHIT">	</span><span class="NAME">NATIONAL_AGRICULTURAL_LIBRARY_CALL_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"070"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>421</span> </span><span class="WHIT">	</span><span class="NAME">NATIONAL_AGRICULTURAL_LIBRARY_COPY_STATEMENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"071"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>422</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_CATEGORY_CODE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"072"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>423</span> </span><span class="WHIT">	</span><span class="NAME">GPO_ITEM_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"074"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>424</span> </span><span class="WHIT">	</span><span class="NAME">UNIVERSAL_DECIMAL_CLASSIFICATION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"080"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>425</span> </span><span class="WHIT">	</span><span class="NAME">DEWEY_DECIMAL_CLASSIFICATION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"082"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>426</span> </span><span class="WHIT">	</span><span class="NAME">ADDITIONAL_DEWEY_DECIMAL_CLASSIFICATION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"083"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>427</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_CLASSIFICATION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"084"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>428</span> </span><span class="WHIT">	</span><span class="NAME">SYNTHESIZED_CLASSIFICATION_NUMBER_COMPONENTS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"085"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>429</span> </span><span class="WHIT">	</span><span class="NAME">GOVERNMENT_DOCUMENT_CLASSIFICATION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"086"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>430</span> </span><span class="WHIT">	</span><span class="NAME">REPORT_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"088"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>431</span> 
<span class='line'>432</span> </span><span class="WHIT">	</span><span class="NAME">MAIN_ENTRY_PERSONAL_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"100"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>433</span> </span><span class="WHIT">	</span><span class="NAME">MAIN_ENTRY_CORPORATE_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"110"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">	</span><span class="NAME">MAIN_ENTRY_MEETING_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"111"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">	</span><span class="NAME">MAIN_ENTRY_UNIFORM_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"130"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>436</span> 
<span class='line'>437</span> </span><span class="WHIT">	</span><span class="NAME">ABBREVIATED_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"210"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>438</span> </span><span class="WHIT">	</span><span class="NAME">KEY_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"222"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>439</span> </span><span class="WHIT">	</span><span class="NAME">UNIFORM_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"240"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>440</span> </span><span class="WHIT">	</span><span class="NAME">TRANSLATION_OF_TITLE_BY_CATALOGING_AGENCY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"242"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>441</span> </span><span class="WHIT">	</span><span class="NAME">COLLECTIVE_UNIFORM_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"243"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>442</span> </span><span class="WHIT">	</span><span class="NAME">TITLE_STATEMENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"245"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>443</span> </span><span class="WHIT">	</span><span class="NAME">VARYING_FORM_OF_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"246"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>444</span> </span><span class="WHIT">	</span><span class="NAME">FORMER_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"247"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>445</span> </span><span class="WHIT">	</span><span class="NAME">EDITION_STATEMENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"250"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>446</span> </span><span class="WHIT">	</span><span class="NAME">MUSICAL_PRESENTATION_STATEMENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"254"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>447</span> </span><span class="WHIT">	</span><span class="NAME">CARTOGRAPHIC_MATHEMATICAL_DATA</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"255"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>448</span> </span><span class="WHIT">	</span><span class="NAME">COMPUTER_FILE_CHARACTERISTICS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"256"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>449</span> </span><span class="WHIT">	</span><span class="NAME">COUNTRY_OF_PRODUCING_ENTITY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"257"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>450</span> </span><span class="WHIT">	</span><span class="NAME">PHILATELIC_ISSUE_DATA</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"258"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>451</span> </span><span class="WHIT">	</span><span class="NAME">PUBLICATION_DISTRIBUTION_ETC_IMPRINT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"260"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>452</span> </span><span class="WHIT">	</span><span class="NAME">PROJECTED_PUBLICATION_DATE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"263"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>453</span> </span><span class="WHIT">	</span><span class="NAME">ADDRESS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"270"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>454</span> 
<span class='line'>455</span> </span><span class="WHIT">	</span><span class="NAME">PHYSICAL_DESCRIPTION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"300"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>456</span> </span><span class="WHIT">	</span><span class="NAME">PLAYING_TIME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"306"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>457</span> </span><span class="WHIT">	</span><span class="NAME">HOURS_ETC</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"307"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>458</span> </span><span class="WHIT">	</span><span class="NAME">CURRENT_PUBLICATION_FREQUENCY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"310"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>459</span> </span><span class="WHIT">	</span><span class="NAME">FORMER_PUBLICATION_FREQUENCY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"321"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>460</span> </span><span class="WHIT">	</span><span class="NAME">CONTENT_TYPE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"336"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>461</span> </span><span class="WHIT">	</span><span class="NAME">MEDIA_TYPE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"337"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>462</span> </span><span class="WHIT">	</span><span class="NAME">CARRIER_TYPE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"338"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>463</span> </span><span class="WHIT">	</span><span class="NAME">PHYSICAL_MEDIUM</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"340"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>464</span> </span><span class="WHIT">	</span><span class="NAME">GEOSPATIAL_REFERENCE_DATA</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"342"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">	</span><span class="NAME">PLANAR_COORDINATE_DATA</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"343"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>466</span> </span><span class="WHIT">	</span><span class="NAME">ORGANIZATION_AND_ARRANGEMENT_OF_MATERIALS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"351"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>467</span> </span><span class="WHIT">	</span><span class="NAME">DIGITAL_GRAPHIC_REPRESENTATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"352"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>468</span> </span><span class="WHIT">	</span><span class="NAME">SECURITY_CLASSIFICATION_CONTROL</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"355"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>469</span> </span><span class="WHIT">	</span><span class="NAME">ORIGINATOR_DISSEMINATION_CONTROL</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"357"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>470</span> </span><span class="WHIT">	</span><span class="NAME">DATES_OF_PUBLICATION_AND_OR_SEQUENTIAL_DESIGNATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"362"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>471</span> </span><span class="WHIT">	</span><span class="NAME">NORMALIZED_DATE_AND_SEQUENTIAL_DESIGNATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"363"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>472</span> </span><span class="WHIT">	</span><span class="NAME">TRADE_PRICE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"365"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>473</span> </span><span class="WHIT">	</span><span class="NAME">TRADE_AVAILABILITY_INFORMATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"366"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>474</span> </span><span class="WHIT">	</span><span class="NAME">FORM_OF_WORK</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"380"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>475</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_DISTINGUISHING_CHARACTERISTICS_OF_WORK_OR_EXPRESSION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"381"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">	</span><span class="NAME">MEDIUM_OF_PERFORMANCE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"382"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>477</span> </span><span class="WHIT">	</span><span class="NAME">NUMERIC_DESIGNATION_OF_MUSICAL_WORK</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"383"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>478</span> </span><span class="WHIT">	</span><span class="NAME">KEY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"384"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>479</span> 
<span class='line'>480</span> </span><span class="WHIT">	</span><span class="NAME">SERIES_STATEMENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"490"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>481</span> 
<span class='line'>482</span> </span><span class="WHIT">	</span><span class="NAME">GENERAL_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"500"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>483</span> </span><span class="WHIT">	</span><span class="NAME">WITH_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"501"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>484</span> </span><span class="WHIT">	</span><span class="NAME">DISSERTATION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"502"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>485</span> </span><span class="WHIT">	</span><span class="NAME">BIBLIOGRAPHY_ETC_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"504"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>486</span> </span><span class="WHIT">	</span><span class="NAME">FORMATTED_CONTENTS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"505"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>487</span> </span><span class="WHIT">	</span><span class="NAME">RESTRICTIONS_ON_ACCESS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"506"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>488</span> </span><span class="WHIT">	</span><span class="NAME">SCALE_NOTE_FOR_GRAPHIC_MATERIAL</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"507"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>489</span> </span><span class="WHIT">	</span><span class="NAME">CREATION_PRODUCTION_CREDITS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"508"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>490</span> </span><span class="WHIT">	</span><span class="NAME">CITATION_REFERENCES_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"510"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>491</span> </span><span class="WHIT">	</span><span class="NAME">PARTICIPANT_OR_PERFORMER_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"511"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>492</span> </span><span class="WHIT">	</span><span class="NAME">TYPE_OF_REPORT_AND_PERIOD_COVERED_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"513"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>493</span> </span><span class="WHIT">	</span><span class="NAME">DATA_QUALITY_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"514"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>494</span> </span><span class="WHIT">	</span><span class="NAME">NUMBERING_PECULIARITIES_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"515"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>495</span> </span><span class="WHIT">	</span><span class="NAME">TYPE_OF_COMPUTER_FILE_OR_DATA_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"516"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>496</span> </span><span class="WHIT">	</span><span class="NAME">DATE_TIME_AND_PLACE_OF_AN_EVENT_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"518"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>497</span> </span><span class="WHIT">	</span><span class="NAME">SUMMARY_ETC</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"520"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>498</span> </span><span class="WHIT">	</span><span class="NAME">TARGET_AUDIENCE_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"521"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>499</span> </span><span class="WHIT">	</span><span class="NAME">GEOGRAPHIC_COVERAGE_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"522"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>500</span> </span><span class="WHIT">	</span><span class="NAME">PREFERRED_CITATION_OF_DESCRIBED_MATERIALS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"524"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>501</span> </span><span class="WHIT">	</span><span class="NAME">SUPPLEMENT_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"525"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>502</span> </span><span class="WHIT">	</span><span class="NAME">STUDY_PROGRAM_INFORMATION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"526"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>503</span> </span><span class="WHIT">	</span><span class="NAME">ADDITIONAL_PHYSICAL_FORM_AVAILABLE_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"530"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>504</span> </span><span class="WHIT">	</span><span class="NAME">REPRODUCTION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"533"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>505</span> </span><span class="WHIT">	</span><span class="NAME">ORIGINAL_VERSION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"534"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>506</span> </span><span class="WHIT">	</span><span class="NAME">LOCATION_OF_ORIGINALS_DUPLICATES_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"535"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>507</span> </span><span class="WHIT">	</span><span class="NAME">FUNDING_INFORMATION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"536"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>508</span> </span><span class="WHIT">	</span><span class="NAME">SYSTEM_DETAILS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"538"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>509</span> </span><span class="WHIT">	</span><span class="NAME">TERMS_GOVERNING_USE_AND_REPRODUCTION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"540"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>510</span> </span><span class="WHIT">	</span><span class="NAME">IMMEDIATE_SOURCE_OF_ACQUISITION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"541"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>511</span> </span><span class="WHIT">	</span><span class="NAME">INFORMATION_RELATING_TO_COPYRIGHT_STATUS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"542"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>512</span> </span><span class="WHIT">	</span><span class="NAME">LOCATION_OF_OTHER_ARCHIVAL_MATERIALS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"544"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>513</span> </span><span class="WHIT">	</span><span class="NAME">BIOGRAPHICAL_OR_HISTORICAL_DATA</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"545"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>514</span> </span><span class="WHIT">	</span><span class="NAME">LANGUAGE_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"546"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>515</span> </span><span class="WHIT">	</span><span class="NAME">FORMER_TITLE_COMPLEXITY_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"547"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>516</span> </span><span class="WHIT">	</span><span class="NAME">ISSUING_BODY_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"550"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>517</span> </span><span class="WHIT">	</span><span class="NAME">ENTITY_AND_ATTRIBUTE_INFORMATION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"552"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>518</span> </span><span class="WHIT">	</span><span class="NAME">CUMULATIVE_INDEX_FINDING_AIDS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"555"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>519</span> </span><span class="WHIT">	</span><span class="NAME">INFORMATION_ABOUT_DOCUMENTATION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"556"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>520</span> </span><span class="WHIT">	</span><span class="NAME">OWNERSHIP_AND_CUSTODIAL_HISTORY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"561"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>521</span> </span><span class="WHIT">	</span><span class="NAME">COPY_AND_VERSION_IDENTIFICATION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"562"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>522</span> </span><span class="WHIT">	</span><span class="NAME">BINDING_INFORMATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"563"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>523</span> </span><span class="WHIT">	</span><span class="NAME">CASE_FILE_CHARACTERISTICS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"565"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>524</span> </span><span class="WHIT">	</span><span class="NAME">METHODOLOGY_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"567"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>525</span> </span><span class="WHIT">	</span><span class="NAME">LINKING_ENTRY_COMPLEXITY_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"580"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>526</span> </span><span class="WHIT">	</span><span class="NAME">PUBLICATIONS_ABOUT_DESCRIBED_MATERIALS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"581"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>527</span> </span><span class="WHIT">	</span><span class="NAME">ACTION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"583"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>528</span> </span><span class="WHIT">	</span><span class="NAME">ACCUMULATION_AND_FREQUENCY_OF_USE_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"584"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>529</span> </span><span class="WHIT">	</span><span class="NAME">EXHIBITIONS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"585"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>530</span> </span><span class="WHIT">	</span><span class="NAME">AWARDS_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"586"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>531</span> </span><span class="WHIT">	</span><span class="NAME">SOURCE_OF_DESCRIPTION_NOTE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"588"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>532</span> 
<span class='line'>533</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_CORPORATE_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"610"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>534</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_MEETING_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"611"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>535</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_UNIFORM_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"630"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>536</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_CHRONOLOGICAL_TERM</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"648"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>537</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_TOPICAL_TERM</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"650"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>538</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_GEOGRAPHIC_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"651"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>539</span> </span><span class="WHIT">	</span><span class="NAME">INDEX_TERM_UNCONTROLLED</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"653"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>540</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_FACETED_TOPICAL_TERMS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"654"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>541</span> </span><span class="WHIT">	</span><span class="NAME">INDEX_TERM_GENRE_FORM</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"655"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>542</span> </span><span class="WHIT">	</span><span class="NAME">INDEX_TERM_OCCUPATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"656"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>543</span> </span><span class="WHIT">	</span><span class="NAME">INDEX_TERM_FUNCTION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"657"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>544</span> </span><span class="WHIT">	</span><span class="NAME">INDEX_TERM_CURRICULUM_OBJECTIVE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"658"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>545</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_ADDED_ENTRY_HIERARCHICAL_PLACE_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"662"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>546</span> 
<span class='line'>547</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_PERSONAL_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"700"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>548</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_CORPORATE_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"710"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>549</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_MEETING_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"711"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>550</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_UNCONTROLLED_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"720"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>551</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_UNIFORM_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"730"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>552</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_UNCONTROLLED_RELATED_ANALYTICAL_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"740"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>553</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_GEOGRAPHIC_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"751"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>554</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_HIERARCHICAL_PLACE_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"752"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>555</span> </span><span class="WHIT">	</span><span class="NAME">SYSTEM_DETAILS_ACCESS_TO_COMPUTER_FILES</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"753"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>556</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_ENTRY_TAXONOMIC_IDENTIFICATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"754"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>557</span> </span><span class="WHIT">	</span><span class="NAME">MAIN_SERIES_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"760"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>558</span> </span><span class="WHIT">	</span><span class="NAME">SUBSERIES_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"762"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>559</span> </span><span class="WHIT">	</span><span class="NAME">ORIGINAL_LANGUAGE_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"765"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>560</span> </span><span class="WHIT">	</span><span class="NAME">TRANSLATION_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"767"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>561</span> </span><span class="WHIT">	</span><span class="NAME">SUPPLEMENT_SPECIAL_ISSUE_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"770"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>562</span> </span><span class="WHIT">	</span><span class="NAME">SUPPLEMENT_PARENT_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"772"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>563</span> </span><span class="WHIT">	</span><span class="NAME">HOST_ITEM_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"773"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>564</span> </span><span class="WHIT">	</span><span class="NAME">CONSTITUENT_UNIT_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"774"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>565</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_EDITION_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"775"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>566</span> </span><span class="WHIT">	</span><span class="NAME">ADDITIONAL_PHYSICAL_FORM_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"776"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>567</span> </span><span class="WHIT">	</span><span class="NAME">ISSUED_WITH_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"777"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>568</span> </span><span class="WHIT">	</span><span class="NAME">PRECEDING_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"780"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>569</span> </span><span class="WHIT">	</span><span class="NAME">SUCCEEDING_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"785"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>570</span> </span><span class="WHIT">	</span><span class="NAME">DATA_SOURCE_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"786"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>571</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_RELATIONSHIP_ENTRY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"787"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>572</span> 
<span class='line'>573</span> </span><span class="WHIT">	</span><span class="NAME">SERIES_ADDED_ENTRY_PERSONAL_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"800"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>574</span> </span><span class="WHIT">	</span><span class="NAME">SERIES_ADDED_ENTRY_CORPORATE_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"810"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>575</span> </span><span class="WHIT">	</span><span class="NAME">SERIES_ADDED_ENTRY_MEETING_NAME</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"811"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>576</span> </span><span class="WHIT">	</span><span class="NAME">SERIES_ADDED_ENTRY_UNIFORM_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"830"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>577</span> </span><span class="WHIT">	</span><span class="NAME">HOLDING_INSTITUTION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"850"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>578</span> </span><span class="WHIT">	</span><span class="NAME">LOCATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"852"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>579</span> </span><span class="WHIT">	</span><span class="NAME">ELECTRONIC_LOCATION_AND_ACCESS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"856"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>580</span> </span><span class="WHIT">	</span><span class="NAME">ALTERNATE_GRAPHIC_REPRESENTATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"880"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>581</span> </span><span class="WHIT">	</span><span class="NAME">REPLACEMENT_RECORD_INFORMATION</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"882"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>582</span> </span><span class="WHIT">	</span><span class="NAME">FOREIGN_MARC_INFORMATION_FIELD</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"886"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>583</span> </span><span class="WHIT">	</span><span class="NAME">NON_MARC_INFORMATION_FIELD</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"887"</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>584</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>585</span> 
<span class='line'>586</span> </span><span class="COMM">/**
<span class='line'>587</span>  * @namespace Unimarc constants and utilities. 
<span class='line'>588</span>  **/</span><span class="WHIT">
<span class='line'>589</span> </span><span class="NAME">Marc.Unimarc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>590</span> </span><span class="WHIT">	</span><span class="COMM">/** Mapping of Zotero creatorTypes to their best Unimarc relator code matches.
<span class='line'>591</span> 	 * @see &lt;a href="http://archive.ifla.org/VI/3/p1996-1/appx-c.htm">UNIMARC relator codes&lt;/a> 
<span class='line'>592</span> 	 * */</span><span class="WHIT">
<span class='line'>593</span> </span><span class="WHIT">	</span><span class="NAME">creatorTypes</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>594</span> </span><span class="WHIT">		</span><span class="STRN">"author"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"070"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//author</span><span class="WHIT">
<span class='line'>595</span> </span><span class="WHIT">		</span><span class="STRN">"contributor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"205"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//contributor</span><span class="WHIT">
<span class='line'>596</span> </span><span class="WHIT">		</span><span class="STRN">"editor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"340"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//editor</span><span class="WHIT">
<span class='line'>597</span> </span><span class="WHIT">		</span><span class="STRN">"translator"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"730"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//translator</span><span class="WHIT">
<span class='line'>598</span> </span><span class="WHIT">		</span><span class="STRN">"seriesEditor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"651"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//publishing director</span><span class="WHIT">
<span class='line'>599</span> </span><span class="WHIT">		</span><span class="STRN">"interviewee"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"460"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//interviewee</span><span class="WHIT">
<span class='line'>600</span> </span><span class="WHIT">		</span><span class="STRN">"interviewer"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"470"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//interviewer</span><span class="WHIT">
<span class='line'>601</span> </span><span class="WHIT">		</span><span class="STRN">"director"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"300"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//director</span><span class="WHIT">
<span class='line'>602</span> </span><span class="WHIT">		</span><span class="STRN">"scriptwriter"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"690"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//scenarist</span><span class="WHIT">
<span class='line'>603</span> </span><span class="WHIT">		</span><span class="STRN">"producer"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"630"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//producer</span><span class="WHIT">
<span class='line'>604</span> </span><span class="WHIT">		</span><span class="STRN">"castMember"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"590"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//performer</span><span class="WHIT">
<span class='line'>605</span> </span><span class="WHIT">		</span><span class="STRN">"sponsor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"723"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//sponsor</span><span class="WHIT">
<span class='line'>606</span> </span><span class="WHIT">		</span><span class="STRN">"counsel"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"255"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//consultant</span><span class="WHIT">
<span class='line'>607</span> </span><span class="WHIT">		</span><span class="STRN">"inventor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"584"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//patent inventor</span><span class="WHIT">
<span class='line'>608</span> </span><span class="WHIT">		</span><span class="STRN">"attorneyAgent"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"582"</span><span class="PUNC">,</span><span class="WHIT">	</span><span class="COMM">//patent applicant</span><span class="WHIT">
<span class='line'>609</span> </span><span class="WHIT">		</span><span class="STRN">"recipient"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"660"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//recipient of letters</span><span class="WHIT">
<span class='line'>610</span> </span><span class="WHIT">		</span><span class="STRN">"performer"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"590"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//performer</span><span class="WHIT">
<span class='line'>611</span> </span><span class="WHIT">		</span><span class="STRN">"composer"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"230"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//composer</span><span class="WHIT">
<span class='line'>612</span> </span><span class="WHIT">		</span><span class="STRN">"wordsBy"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"520"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//lyricist</span><span class="WHIT">
<span class='line'>613</span> </span><span class="WHIT">		</span><span class="STRN">"cartographer"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"180"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//cartographer</span><span class="WHIT">
<span class='line'>614</span> </span><span class="WHIT">		</span><span class="STRN">"programmer"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"635"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//programmer</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">		</span><span class="STRN">"artist"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"040"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//artist</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">		</span><span class="STRN">"commenter"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"210"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//commentator</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">		</span><span class="STRN">"presenter"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"570"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//other</span><span class="WHIT">
<span class='line'>618</span> </span><span class="WHIT">		</span><span class="STRN">"guest"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"460"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//interviewee</span><span class="WHIT">
<span class='line'>619</span> </span><span class="WHIT">		</span><span class="STRN">"podcaster"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"070"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//author</span><span class="WHIT">
<span class='line'>620</span> </span><span class="WHIT">		</span><span class="STRN">"reviewedAuthor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"100"</span><span class="PUNC">,</span><span class="WHIT">	</span><span class="COMM">//bibliographic antecedent</span><span class="WHIT">
<span class='line'>621</span> </span><span class="WHIT">		</span><span class="STRN">"cosponsor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"400"</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="COMM">//funder</span><span class="WHIT">
<span class='line'>622</span> </span><span class="WHIT">		</span><span class="STRN">"bookAuthor"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"070"</span><span class="WHIT">		</span><span class="COMM">//author</span><span class="WHIT">
<span class='line'>623</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>624</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>625</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>626</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>627</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>628</span> 	 *  Return the best Unimarc relator code match for a Zotero creatorType.
<span class='line'>629</span> 	 *  @param {String} creatorType a Zotero creatorType
<span class='line'>630</span> 	 */</span><span class="WHIT">
<span class='line'>631</span> </span><span class="WHIT">	</span><span class="NAME">getRelatorCode</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">creatorType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>632</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">code</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.creatorTypes</span><span class="PUNC">[</span><span class="NAME">creatorType</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>633</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">code</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"070"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>634</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>635</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>636</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>637</span> 	 * Returns a valid Zotero creatorType for a Unimarc relator code.
<span class='line'>638</span> 	 * @param {String} relatorCode a three-digit Unimarc relator code
<span class='line'>639</span> 	 * @see &lt;a href="http://archive.ifla.org/VI/3/p1996-1/appx-c.htm">UNIMARC relator codes&lt;/a> 
<span class='line'>640</span> 	 */</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">	</span><span class="NAME">getCreatorType</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">relatorCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>642</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">relatorCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>643</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"005"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>644</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"250"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>645</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"275"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>646</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"590"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//performer</span><span class="WHIT">
<span class='line'>647</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"755"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//vocalist</span><span class="WHIT">
<span class='line'>648</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"performer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>649</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"040"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>650</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"130"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//book designer</span><span class="WHIT">
<span class='line'>651</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"740"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//type designer</span><span class="WHIT">
<span class='line'>652</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"750"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//typographer</span><span class="WHIT">
<span class='line'>653</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"350"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//engraver</span><span class="WHIT">
<span class='line'>654</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"360"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//etcher</span><span class="WHIT">
<span class='line'>655</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"430"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//illuminator</span><span class="WHIT">
<span class='line'>656</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"440"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//illustrator</span><span class="WHIT">
<span class='line'>657</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"510"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//lithographer</span><span class="WHIT">
<span class='line'>658</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"530"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//metal engraver</span><span class="WHIT">
<span class='line'>659</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"600"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//photographer</span><span class="WHIT">
<span class='line'>660</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"705"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//sculptor</span><span class="WHIT">
<span class='line'>661</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"760"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//wood engraver</span><span class="WHIT">
<span class='line'>662</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"artist"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>663</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"070"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>664</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"305"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>665</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"330"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>666</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>667</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>668</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"020"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>669</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"210"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>670</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"212"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>671</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"commenter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>672</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"180"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>673</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"cartographer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>674</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"220"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>675</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"340"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>676</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"editor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>677</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"651"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//publishing director</span><span class="WHIT">
<span class='line'>678</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">seriesEditor</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>679</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"230"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>680</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"composer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>681</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"245"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>682</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"inventor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>683</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"255"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>684</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"695"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//scientific advisor</span><span class="WHIT">
<span class='line'>685</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"727"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//thesis advisor</span><span class="WHIT">
<span class='line'>686</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"counsel"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>687</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"300"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>688</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"director"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>689</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"400"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//funder</span><span class="WHIT">
<span class='line'>690</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"723"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//sponsor</span><span class="WHIT">
<span class='line'>691</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"sponsor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>692</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"460"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>693</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"interviewee"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>694</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"470"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>695</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"interviewer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>696</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"480"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//librettist</span><span class="WHIT">
<span class='line'>697</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"520"</span><span class="PUNC">:</span><span class="WHIT">    </span><span class="COMM">//lyricist</span><span class="WHIT">
<span class='line'>698</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"wordsBy"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>699</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"605"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>700</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"presenter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>701</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"630"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>702</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"producer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"635"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>704</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"programmer"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"660"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>706</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"recipient"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>707</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"090"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//author of dialog</span><span class="WHIT">
<span class='line'>708</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"690"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//scenarist</span><span class="WHIT">
<span class='line'>709</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"scriptwriter"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>710</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"730"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>711</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"translator"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>712</span> </span><span class="WHIT">		</span><span class="COMM">//Ignore (no matching Zotero creatorType):</span><span class="WHIT">
<span class='line'>713</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"320"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//donor</span><span class="WHIT">
<span class='line'>714</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"610"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//printer</span><span class="WHIT">
<span class='line'>715</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"650"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="COMM">//publisher</span><span class="WHIT">
<span class='line'>716</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>717</span> </span><span class="WHIT">		</span><span class="COMM">//Default</span><span class="WHIT">
<span class='line'>718</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"205"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>719</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>720</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"contributor"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>721</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>722</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>724</span> </span><span class="WHIT">	</span><span class="COMM">/** Match an UNIMARC script code to IANA. 
<span class='line'>725</span> 	 * @param {String} code A UNIMARC script code
<span class='line'>726</span> 	 * @returns {String}
<span class='line'>727</span> 	 * @see &lt;a href="http://archive.ifla.org/VI/3/p1996-1/uni1.htm#100">UNIMARC Manual&lt;/a> 
<span class='line'>728</span> 	 * @see &lt;a href="http://www.iana.org/assignments/language-subtag-registry">IANA list&lt;/a> 
<span class='line'>729</span> 	 */</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">	</span><span class="NAME">Scripts</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">		</span><span class="NAME">ba</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Latn"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Latin</span><span class="WHIT">
<span class='line'>732</span> </span><span class="WHIT">		</span><span class="NAME">ca</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Cyrl"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Cyrillic</span><span class="WHIT">
<span class='line'>733</span> </span><span class="WHIT">		</span><span class="NAME">da</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Jpan"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Japanese - script unspecified</span><span class="WHIT">
<span class='line'>734</span> </span><span class="WHIT">		</span><span class="NAME">db</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Hani"</span><span class="PUNC">,</span><span class="WHIT"> 		</span><span class="COMM">//Japanese - kanji</span><span class="WHIT">
<span class='line'>735</span> </span><span class="WHIT">		</span><span class="NAME">dc</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Kana"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Japanese - kana</span><span class="WHIT">
<span class='line'>736</span> </span><span class="WHIT">		</span><span class="NAME">ea</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Hans"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Chinese</span><span class="WHIT">
<span class='line'>737</span> </span><span class="WHIT">		</span><span class="NAME">fa</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Arab"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Arab</span><span class="WHIT">
<span class='line'>738</span> </span><span class="WHIT">		</span><span class="NAME">ga</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Grek"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Greek</span><span class="WHIT">
<span class='line'>739</span> </span><span class="WHIT">		</span><span class="NAME">ha</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Hebr"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Hebrew</span><span class="WHIT">
<span class='line'>740</span> </span><span class="WHIT">		</span><span class="NAME">ia</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Thai"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Thai</span><span class="WHIT">
<span class='line'>741</span> </span><span class="WHIT">		</span><span class="NAME">ja</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Deva"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Devanagari</span><span class="WHIT">
<span class='line'>742</span> </span><span class="WHIT">		</span><span class="NAME">ka</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Kore"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Korean</span><span class="WHIT">
<span class='line'>743</span> </span><span class="WHIT">		</span><span class="NAME">la</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Taml"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Tamil</span><span class="WHIT">
<span class='line'>744</span> </span><span class="WHIT">		</span><span class="NAME">ma</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Geor"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Georgian</span><span class="WHIT">
<span class='line'>745</span> </span><span class="WHIT">		</span><span class="NAME">mb</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Armn"</span><span class="PUNC">,</span><span class="WHIT">			</span><span class="COMM">//Armenian</span><span class="WHIT">
<span class='line'>746</span> </span><span class="COMM">//		zz: Other</span><span class="WHIT">
<span class='line'>747</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>748</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>749</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>750</span> 
<span class='line'>751</span> 
<span class='line'>752</span> 
<span class='line'>753</span> 
<span class='line'>754</span> 
<span class='line'>755</span> </span><span class="COMM">/**
<span class='line'>756</span>  * @namespace Mapping of human-readable names to Unimarc tags. The type of each property
<span class='line'>757</span>  * is an object with a "tag" property containing the three-digit Unimarc tag and
<span class='line'>758</span>  * a "flag" property containg a bitwise or of relevant flags from {@link Marc.Tag.Flags}. 
<span class='line'>759</span>  */</span><span class="WHIT">
<span class='line'>760</span> </span><span class="NAME">Marc.Unimarc.Tags</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>761</span> </span><span class="WHIT">	</span><span class="NAME">RECORD_IDENTIFIER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"001"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.MANDATORY</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>762</span> </span><span class="WHIT">	</span><span class="NAME">VERSION_IDENTIFIER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"005"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>763</span> </span><span class="WHIT">	</span><span class="NAME">ISBN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"010"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>764</span> </span><span class="WHIT">	</span><span class="NAME">ISSN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"011"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>765</span> </span><span class="WHIT">	</span><span class="NAME">FINGERPRINT_IDENTIFIER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"012"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>766</span> </span><span class="WHIT">	</span><span class="NAME">ISMN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"013"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>767</span> </span><span class="WHIT">	</span><span class="NAME">ARTICLE_IDENTIFIER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"014"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>768</span> </span><span class="WHIT">	</span><span class="NAME">ISRN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"015"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>769</span> </span><span class="WHIT">	</span><span class="NAME">ISRC</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"016"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>770</span> </span><span class="WHIT">	</span><span class="NAME">NATIONAL_BIBLIOGRAPHY_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"020"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>771</span> </span><span class="WHIT">	</span><span class="NAME">LEGAL_DEPOSIT_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"021"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>772</span> </span><span class="WHIT">	</span><span class="NAME">GOVERNMENT_PUBLICATION_NUMBER</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"022"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>773</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_SYSTEM_CONTROL_NUMBERS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"035"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>774</span> </span><span class="WHIT">	</span><span class="NAME">CODEN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"040"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>775</span> </span><span class="WHIT">	</span><span class="NAME">PUBLISHERS_NUMBERS_FOR_MUSIC</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"071"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>776</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>777</span> </span><span class="WHIT">	</span><span class="NAME">GENERAL_PROCESSING_DATA</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"100"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.MANDATORY</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>778</span> </span><span class="WHIT">	</span><span class="NAME">LANGUAGE_OF_THE_ITEM</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"101"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>779</span> </span><span class="WHIT">	</span><span class="NAME">COUNTRY_OF_PUBLICATION_OR_PRODUCTION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"102"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>780</span> </span><span class="WHIT">	</span><span class="NAME">CODED_TEXTUAL_MATERIALS_MONOGRAPHIC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"105"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>781</span> </span><span class="WHIT">	</span><span class="NAME">CODED_TEXTUAL_MATERIALS_PHYSICAL_ATTRIBUTES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"106"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>782</span> </span><span class="WHIT">	</span><span class="NAME">CODED_SERIALS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"110"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>783</span> </span><span class="WHIT">	</span><span class="NAME">CODED_VISUAL_PROJECTIONS_VIDEORECORDINGS_AND_MOTION_PICTURES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"115"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>784</span> </span><span class="WHIT">	</span><span class="NAME">CODED_GRAPHICS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"116"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>785</span> </span><span class="WHIT">	</span><span class="NAME">CODED_THREE_DIMENSIONAL_ARTIFACTS_AND_REALIA</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"117"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>786</span> </span><span class="WHIT">	</span><span class="NAME">CODED_CARTOGRAPHIC_MATERIALS_GENERAL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"120"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>787</span> </span><span class="WHIT">	</span><span class="NAME">CODED_CARTOGRAPHIC_MATERIALS_PHYSICAL_ATTRIBUTES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"121"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>788</span> </span><span class="WHIT">	</span><span class="NAME">CODED_TIME_PERIOD_OF_ITEM_CONTENT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"122"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>789</span> </span><span class="WHIT">	</span><span class="NAME">CODED_CARTOGRAPHIC_MATERIALS_SCALE_AND_CO_ORDINATES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"123"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>790</span> </span><span class="WHIT">	</span><span class="NAME">CODED_CARTOGRAPHIC_MATERIALS_SPECIFIC_MATERIAL_DESIGNATION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"124"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>791</span> </span><span class="WHIT">	</span><span class="NAME">CODED_SOUND_RECORDINGS_AND_PRINTED_MUSIC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"125"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>792</span> </span><span class="WHIT">	</span><span class="NAME">CODED_SOUND_RECORDINGS_PHYSICAL_ATTRIBUTES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"126"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>793</span> </span><span class="WHIT">	</span><span class="NAME">CODED_DURATION_OF_SOUND_RECORDINGS_AND_PRINTED_MUSIC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"127"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>794</span> </span><span class="WHIT">	</span><span class="NAME">CODED_MUSICAL_PERFORMANCES_AND_SCORES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"128"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>795</span> </span><span class="WHIT">	</span><span class="NAME">CODED_MICROFORMS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"130"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>796</span> </span><span class="WHIT">	</span><span class="NAME">CODED_CARTOGRAPHIC_MATERIALS_GEODETIC_GRID_AND_VERTICAL_MEASUREMENT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"131"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>797</span> </span><span class="WHIT">	</span><span class="NAME">CODED_ELECTRONIC_RESOURCES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"135"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>798</span> </span><span class="WHIT">	</span><span class="NAME">CODED_ANTIQUARIAN_GENERAL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"140"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>799</span> </span><span class="WHIT">	</span><span class="NAME">CODED_ANTIQUARIAN_COPY_SPECIFIC_ATTRIBUTES</span><span class="WHIT">	</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"141"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>800</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>801</span> </span><span class="WHIT">	</span><span class="NAME">TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"200"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.MANDATORY</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>802</span> </span><span class="WHIT">	</span><span class="NAME">EDITION_STATEMENT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"205"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>803</span> </span><span class="WHIT">	</span><span class="NAME">MATERIAL_SPECIFIC_AREA_CARTOGRAPHIC_MATERIALS_MATHEMATICAL_DATA</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"206"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>804</span> </span><span class="WHIT">	</span><span class="NAME">MATERIAL_SPECIFIC_AREA_SERIALS_NUMBERING</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"207"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>805</span> </span><span class="WHIT">	</span><span class="NAME">MATERIAL_SPECIFIC_AREA_PRINTED_MUSIC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"208"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>806</span> </span><span class="WHIT">	</span><span class="NAME">PUBLICATION_DISTRIBUTION_ETC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"210"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>807</span> </span><span class="WHIT">	</span><span class="NAME">PROJECTED_PUBLICATION_DATE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"211"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>808</span> </span><span class="WHIT">	</span><span class="NAME">PHYSICAL_DESCRIPTION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"215"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>809</span> </span><span class="WHIT">	</span><span class="NAME">SERIES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"225"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>810</span> </span><span class="WHIT">	</span><span class="NAME">MATERIAL_SPECIFIC_AREA_ELECTRONIC_RESOURCE_CHARACTERISTICS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"230"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>811</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>812</span> </span><span class="WHIT">	</span><span class="NAME">GENERAL_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"300"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>813</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_IDENTIFICATION_NUMBERS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"301"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>814</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_CODED_INFORMATION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"302"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>815</span> </span><span class="WHIT">	</span><span class="NAME">GENERAL_NOTES_PERTAINING_TO_DESCRIPTIVE_INFORMATION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"303"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>816</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"304"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>817</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_EDITION_AND_BIBLIOGRAPHIC_HISTORY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"305"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>818</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_PUBLICATION_DISTRIBUTION_ETC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"306"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>819</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_PHYSICAL_DESCRIPTION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"307"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>820</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_SERIES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"308"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>821</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_BINDING_AND_AVAILABILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"310"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>822</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_LINKING_FIELDS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"311"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>823</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_RELATED_TITLES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"312"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>824</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_SUBJECT_ACCESS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"313"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>825</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"314"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>826</span> </span><span class="WHIT">	</span><span class="NAME">NOTES_PERTAINING_TO_MATERIAL_OR_TYPE_OF_PUBLICATION_SPECIFIC_INFORMATION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"315"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>827</span> </span><span class="WHIT">	</span><span class="NAME">NOTE_RELATING_TO_THE_COPY_IN_HAND</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"316"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>828</span> </span><span class="WHIT">	</span><span class="NAME">PROVENANCE_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"317"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>829</span> </span><span class="WHIT">	</span><span class="NAME">ACTION_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"318"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>830</span> </span><span class="WHIT">	</span><span class="NAME">INTERNAL_BIBLIOGRAPHIES_INDEXES_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"320"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>831</span> </span><span class="WHIT">	</span><span class="NAME">EXTERNAL_INDEXES_ABSTRACTS_REFERENCES_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"321"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>832</span> </span><span class="WHIT">	</span><span class="NAME">CREDITS_NOTE_PROJECTED_AND_VIDEO_MATERIAL_AND_SOUND_RECORDINGS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"322"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>833</span> </span><span class="WHIT">	</span><span class="NAME">CAST_NOTE_PROJECTED_AND_VIDEO_MATERIAL_AND_SOUND_RECORDINGS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"323"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>834</span> </span><span class="WHIT">	</span><span class="NAME">FACSIMILE_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"324"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>835</span> </span><span class="WHIT">	</span><span class="NAME">REPRODUCTION_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"325"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>836</span> </span><span class="WHIT">	</span><span class="NAME">FREQUENCY_STATEMENT_NOTE_SERIALS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"326"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>837</span> </span><span class="WHIT">	</span><span class="NAME">CONTENTS_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"327"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>838</span> </span><span class="WHIT">	</span><span class="NAME">DISSERTATION_THESIS_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"328"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>839</span> </span><span class="WHIT">	</span><span class="NAME">SUMMARY_OR_ABSTRACT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"330"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>840</span> </span><span class="WHIT">	</span><span class="NAME">PREFERRED_CITATION_OF_DESCRIBED_MATERIALS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"332"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>841</span> </span><span class="WHIT">	</span><span class="NAME">USERS_INTENDED_AUDIENCE_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"333"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>842</span> </span><span class="WHIT">	</span><span class="NAME">TYPE_OF_ELECTRONIC_RESOURCE_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"336"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>843</span> </span><span class="WHIT">	</span><span class="NAME">SYSTEM_REQUIREMENTS_NOTE_ELECTRONIC_RESOURCES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"337"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>844</span> </span><span class="WHIT">	</span><span class="NAME">ACQUISITION_INFORMATION_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"345"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>845</span> 
<span class='line'>846</span> </span><span class="WHIT">	</span><span class="NAME">SERIES_LINK</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"410"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>847</span> </span><span class="WHIT">	</span><span class="NAME">SUBSERIES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"411"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>848</span> </span><span class="WHIT">	</span><span class="NAME">SUPPLEMENT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"421"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>849</span> </span><span class="WHIT">	</span><span class="NAME">PARENT_OF_SUPPLEMENT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"422"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>850</span> </span><span class="WHIT">	</span><span class="NAME">ISSUED_WITH</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"423"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>851</span> </span><span class="WHIT">	</span><span class="NAME">CONTINUES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"430"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>852</span> </span><span class="WHIT">	</span><span class="NAME">FORMED_BY_MERGER_OF_AND</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"436"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>853</span> </span><span class="WHIT">	</span><span class="NAME">CONTINUED_BY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"440"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>854</span> </span><span class="WHIT">	</span><span class="NAME">SPLIT_INTO_AND</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"446"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>855</span> </span><span class="WHIT">	</span><span class="NAME">MERGED_WITH_AND_TO_FORM</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"447"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>856</span> </span><span class="WHIT">	</span><span class="NAME">CHANGED_BACK_TO</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"448"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>857</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_EDITION_IN_THE_SAME_MEDIUM</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"451"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>858</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_EDITION_IN_ANOTHER_MEDIUM</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"452"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>859</span> </span><span class="WHIT">	</span><span class="NAME">TRANSLATED_AS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"453"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>860</span> </span><span class="WHIT">	</span><span class="NAME">TRANSLATION_OF</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"454"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>861</span> </span><span class="WHIT">	</span><span class="NAME">REPRODUCTION_OF</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"455"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>862</span> </span><span class="WHIT">	</span><span class="NAME">REPRODUCED_AS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"456"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>863</span> </span><span class="WHIT">	</span><span class="NAME">SET</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"461"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>864</span> </span><span class="WHIT">	</span><span class="NAME">SUBSET</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"462"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>865</span> </span><span class="WHIT">	</span><span class="NAME">PIECE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"463"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>866</span> </span><span class="WHIT">	</span><span class="NAME">PIECE_ANALYTIC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"464"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>867</span> </span><span class="WHIT">	</span><span class="NAME">ITEM_REVIEWED</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"470"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>868</span> </span><span class="WHIT">	</span><span class="NAME">ALSO_BOUND_IN_THIS_VOLUME</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"481"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>869</span> </span><span class="WHIT">	</span><span class="NAME">BOUND_WITH</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"482"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>870</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_RELATED_WORK</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"488"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>871</span> 
<span class='line'>872</span> </span><span class="WHIT">	</span><span class="NAME">UNIFORM_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"500"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>873</span> </span><span class="WHIT">	</span><span class="NAME">COLLECTIVE_UNIFORM_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"501"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>874</span> </span><span class="WHIT">	</span><span class="NAME">UNIFORM_CONVENTIONAL_HEADING</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"503"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>875</span> </span><span class="WHIT">	</span><span class="NAME">PARALLEL_TITLE_PROPER</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"510"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>876</span> </span><span class="WHIT">	</span><span class="NAME">COVER_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"512"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>877</span> </span><span class="WHIT">	</span><span class="NAME">ADDED_TITLE_PAGE_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"513"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>878</span> </span><span class="WHIT">	</span><span class="NAME">CAPTION_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"514"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>879</span> </span><span class="WHIT">	</span><span class="NAME">RUNNING_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"515"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>880</span> </span><span class="WHIT">	</span><span class="NAME">SPINE_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"516"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>881</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_VARIANT_TITLES</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"517"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>882</span> </span><span class="WHIT">	</span><span class="NAME">TITLE_IN_STANDARD_MODERN_SPELLING</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"518"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>883</span> </span><span class="WHIT">	</span><span class="NAME">FORMER_TITLE_SERIALS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"520"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>884</span> </span><span class="WHIT">	</span><span class="NAME">KEY_TITLE_SERIALS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"530"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>885</span> </span><span class="WHIT">	</span><span class="NAME">ABBREVIATED_TITLE_SERIALS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"531"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>886</span> </span><span class="WHIT">	</span><span class="NAME">EXPANDED_TITLE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"532"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>887</span> </span><span class="WHIT">	</span><span class="NAME">ADDITIONAL_TITLE_SUPPLIED_BY_CATALOGUER</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"540"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>888</span> </span><span class="WHIT">	</span><span class="NAME">TRANSLATED_TITLE_SUPPLIED_BY_CATALOGUER</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"541"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>889</span> </span><span class="WHIT">	</span><span class="NAME">SECTION_TITLE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"545"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>890</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>891</span> </span><span class="WHIT">	</span><span class="NAME">PERSONAL_NAME_USED_AS_SUBJECT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"600"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>892</span> </span><span class="WHIT">	</span><span class="NAME">CORPORATE_BODY_NAME_USED_AS_SUBJECT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"601"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>893</span> </span><span class="WHIT">	</span><span class="NAME">FAMILY_NAME_USED_AS_SUBJECT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"602"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>894</span> </span><span class="WHIT">	</span><span class="NAME">NAME_AND_TITLE_USED_AS_SUBJECT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"604"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>895</span> </span><span class="WHIT">	</span><span class="NAME">TITLE_USED_AS_SUBJECT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"605"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>896</span> </span><span class="WHIT">	</span><span class="NAME">TOPICAL_NAME_USED_AS_SUBJECT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"606"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>897</span> </span><span class="WHIT">	</span><span class="NAME">GEOGRAPHICAL_NAME_USED_AS_SUBJECT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"607"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>898</span> </span><span class="WHIT">	</span><span class="NAME">FORM_GENRE_OR_PHYSICAL_CHARACTERISTICS_HEADING</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"608"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>899</span> </span><span class="WHIT">	</span><span class="NAME">UNCONTROLLED_SUBJECT_TERMS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"610"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>900</span> </span><span class="WHIT">	</span><span class="NAME">SUBJECT_CATEGORY_PROVISIONAL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"615"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>901</span> </span><span class="WHIT">	</span><span class="NAME">PLACE_ACCESS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"620"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>902</span> </span><span class="WHIT">	</span><span class="NAME">TECHNICAL_DETAILS_ACCESS_ELECTRONIC_RESOURCES_OBSOLETE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"626"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>903</span> </span><span class="WHIT">	</span><span class="NAME">GEOGRAPHIC_AREA_CODE_GAC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"660"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>904</span> </span><span class="WHIT">	</span><span class="NAME">TIME_PERIOD_CODE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"661"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>905</span> </span><span class="WHIT">	</span><span class="NAME">PRECIS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"670"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>906</span> </span><span class="WHIT">	</span><span class="NAME">UNIVERSAL_DECIMAL_CLASSIFICATION_UD</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"675"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>907</span> </span><span class="WHIT">	</span><span class="NAME">DEWEY_DECIMAL_CLASSIFICATION_DD</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"676"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>908</span> </span><span class="WHIT">	</span><span class="NAME">LIBRARY_OF_CONGRESS_CLASSIFICATION</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"680"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>909</span> </span><span class="WHIT">	</span><span class="NAME">OTHER_CLASS_NUMBERS</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"686"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>910</span> 
<span class='line'>911</span> </span><span class="WHIT">	</span><span class="NAME">PERSONAL_NAME_PRIMARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"700"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>912</span> </span><span class="WHIT">	</span><span class="NAME">PERSONAL_NAME_ALTERNATIVE_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"701"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>913</span> </span><span class="WHIT">	</span><span class="NAME">PERSONAL_NAME_SECONDARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"702"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>914</span> </span><span class="WHIT">	</span><span class="NAME">CORPORATE_BODY_NAME_PRIMARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"710"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>915</span> </span><span class="WHIT">	</span><span class="NAME">CORPORATE_BODY_NAME_ALTERNATIVE_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"711"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>916</span> </span><span class="WHIT">	</span><span class="NAME">CORPORATE_BODY_NAME_SECONDARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"712"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>917</span> </span><span class="WHIT">	</span><span class="NAME">FAMILY_NAME_PRIMARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"720"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>918</span> </span><span class="WHIT">	</span><span class="NAME">FAMILY_NAME_ALTERNATIVE_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"721"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>919</span> </span><span class="WHIT">	</span><span class="NAME">FAMILY_NAME_SECONDARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"722"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>920</span> </span><span class="WHIT">	</span><span class="NAME">NAME_INTELLECTUAL_RESPONSIBILITY</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"730"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>921</span> 
<span class='line'>922</span> </span><span class="WHIT">	</span><span class="NAME">ORIGINATING_SOURCE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"801"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.MANDATORY</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>923</span> </span><span class="WHIT">	</span><span class="NAME">ISSN_CENTRE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"802"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.NOTREPEATABLE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>924</span> </span><span class="WHIT">	</span><span class="NAME">GENERAL_CATALOGUERS_NOTE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"830"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>925</span> </span><span class="WHIT">	</span><span class="NAME">ELECTRONIC_LOCATION_AND_ACCESS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"856"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>926</span> </span><span class="WHIT">	</span><span class="NAME">DATA_NOT_CONVERTED_FROM_SOURCE_FORMAT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">(</span><span class="STRN">"886"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>927</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>928</span> 
<span class='line'>929</span> </span><span class="COMM">/** Check whether a given record is Unimarc. */</span><span class="WHIT">
<span class='line'>930</span> </span><span class="NAME">Marc.Unimarc.isUnimarc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>931</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">record</span><span class="WHIT">
<span class='line'>932</span> </span><span class="WHIT">		</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">record.hasField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>933</span> </span><span class="WHIT">		</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">record.hasField</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.TITLE_STATEMENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>934</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>935</span> 
<span class='line'>936</span> 
<span class='line'>937</span> </span><span class="COMM">/**
<span class='line'>938</span>  * Constructs an emprty MARC record. 
<span class='line'>939</span>  * @class Represents a MARC record.
<span class='line'>940</span>  **/</span><span class="WHIT">
<span class='line'>941</span> </span><span class="NAME">Marc.Record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>942</span> </span><span class="WHIT">	</span><span class="NAME">this._fields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>943</span> </span><span class="WHIT">	</span><span class="NAME">this._leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>944</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>945</span> 
<span class='line'>946</span> </span><span class="NAME">Marc.Record.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>947</span> </span><span class="WHIT">	</span><span class="NAME">constructor</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Marc.Record</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>948</span> </span><span class="WHIT">	</span><span class="COMM">/** Serialize the record. 
<span class='line'>949</span> 	 * @param {Object} [options] an object controlling the details of the serialization:
<span class='line'>950</span> 	 * @param {String} [options.fieldDelimiter="\\n"] will be inserted after each field
<span class='line'>951</span> 	 * @param {String} [options.tagDelimiter=""] will be inserted after each tag
<span class='line'>952</span> 	 * @param {boolean} [options.suppressLeader=false] causes the leader not to be included
<span class='line'>953</span> 	 * @param {String} [options.blankIndicator="#"] represents an absent indicator
<span class='line'>954</span> 	 * @param {String} [options.indicatorDelimiter=""] will be inserted after each indicator
<span class='line'>955</span> 	 * @param {String} [options.subfieldCharacter="$"] represents a subfield delimiter
<span class='line'>956</span> 	 * @param {String} [options.subfieldDelimiter=""] will be inserted after each subfield tag (e.g. $a)
<span class='line'>957</span> 	 */</span><span class="WHIT">
<span class='line'>958</span> </span><span class="WHIT">	</span><span class="NAME">serialize</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>959</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>960</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>961</span> </span><span class="WHIT">			</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>962</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>963</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.fieldDelimiter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>964</span> </span><span class="WHIT">			</span><span class="NAME">options.fieldDelimiter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\n"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>965</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>966</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.blankIndicator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>967</span> </span><span class="WHIT">			</span><span class="NAME">options.blankIndicator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'#'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>968</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>969</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.subfieldCharacter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>970</span> </span><span class="WHIT">			</span><span class="NAME">options.subfieldCharacter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'$'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>971</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>972</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.tagDelimiter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>973</span> </span><span class="WHIT">			</span><span class="NAME">options.tagDelimiter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>974</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>975</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.indicatorDelimiter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>976</span> </span><span class="WHIT">			</span><span class="NAME">options.indicatorDelimiter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>977</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>978</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.subfieldDelimiter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>979</span> </span><span class="WHIT">			</span><span class="NAME">options.subfieldDelimiter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>980</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>981</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._leader</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">options.suppressLeader</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>982</span> </span><span class="WHIT">			</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._leader.serialize</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">options.fieldDelimiter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>983</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>984</span> </span><span class="WHIT">		</span><span class="NAME">this._fields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>985</span> </span><span class="WHIT">			</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.serialize</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">options.fieldDelimiter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>986</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>987</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>988</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>989</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>990</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>991</span> 	 * @returns {Marc.Record.Field} the field at the given position
<span class='line'>992</span> 	 */</span><span class="WHIT">
<span class='line'>993</span> </span><span class="WHIT">	</span><span class="NAME">getField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>994</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>995</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>996</span> 
<span class='line'>997</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>998</span> 	 * Get the catalog language from 100
<span class='line'>999</span> 	 * @returns {String} the ISO-code of the catalog language.
<span class='line'>1000</span> 	 */</span><span class="WHIT">
<span class='line'>1001</span> </span><span class="WHIT">	</span><span class="NAME">getCatalogLanguage</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1002</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.GENERAL_PROCESSING_DATA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1003</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1004</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value.substr</span><span class="PUNC">(</span><span class="NUMB">22</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1005</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1006</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1007</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1008</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1009</span> 	 * @param {String|String[]|Object|Object[]|RegExp} tag specifies tags
<span class='line'>1010</span> 	 * @returns {boolean} true if at least one field matches the supplied tag
<span class='line'>1011</span> 	 */</span><span class="WHIT">
<span class='line'>1012</span> </span><span class="WHIT">	</span><span class="NAME">hasField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1013</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._buildFieldsPattern</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1014</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1015</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1016</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pattern.test</span><span class="PUNC">(</span><span class="NAME">field.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1017</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1018</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1019</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1020</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1021</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1022</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1023</span> </span><span class="WHIT">	</span><span class="NAME">_buildFieldsPattern</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1024</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pattern</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1025</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1026</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1027</span> </span><span class="WHIT">				</span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1028</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1029</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Marc.Tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1030</span> </span><span class="WHIT">				</span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="NAME">tag.tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1031</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1032</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"string"</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1033</span> </span><span class="WHIT">				</span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1034</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1035</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1036</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">expr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1037</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1038</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1039</span> </span><span class="WHIT">						</span><span class="NAME">expr.push</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1040</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1041</span> </span><span class="WHIT">					</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1042</span> </span><span class="WHIT">						</span><span class="NAME">expr.push</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1043</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1044</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1045</span> </span><span class="WHIT">				</span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="NAME">expr.join</span><span class="PUNC">(</span><span class="STRN">"|"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1046</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1047</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1048</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">pattern</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1049</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1050</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1051</span> </span><span class="WHIT">	</span><span class="COMM">/* Return an array of fields specified by the tags argument.
<span class='line'>1052</span> 	 * tags can be a string, a string array, a tag object ({tag: "XXX"}),
<span class='line'>1053</span> 	 * an array of tag objects or a RegExp matching different tags (/7\d\d/).
<span class='line'>1054</span> 	 */</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1055</span> </span><span class="WHIT">	</span><span class="NAME">getFields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1056</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._buildFieldsPattern</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1057</span> 
<span class='line'>1058</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1059</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1060</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1061</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pattern.test</span><span class="PUNC">(</span><span class="NAME">field.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1062</span> </span><span class="WHIT">				</span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1063</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1064</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1065</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1066</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1067</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1068</span> </span><span class="WHIT">	</span><span class="COMM">/* Delete fields matching the tags argument (see getFields). */</span><span class="WHIT">
<span class='line'>1069</span> </span><span class="WHIT">	</span><span class="NAME">deleteFields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1070</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._buildFieldsPattern</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1071</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">pattern</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1072</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1073</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1074</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">pattern.test</span><span class="PUNC">(</span><span class="NAME">field.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1075</span> </span><span class="WHIT">					</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1076</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1077</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1078</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1079</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1080</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1081</span> </span><span class="WHIT">	</span><span class="COMM">/* Find fields matching tag (see getFields) where condition returns
<span class='line'>1082</span> 	 * true for at least one of the subfields in subfieldIndexes. condition
<span class='line'>1083</span> 	 * is called with the field and subfield as arguments.
<span class='line'>1084</span> 	 */</span><span class="WHIT">
<span class='line'>1085</span> </span><span class="WHIT">	</span><span class="NAME">findFields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">condition</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldIndexes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1086</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1087</span> </span><span class="WHIT">		</span><span class="COMM">//field loop</span><span class="WHIT">
<span class='line'>1088</span> </span><span class="WHIT">		</span><span class="NAME">getFields</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1089</span> </span><span class="WHIT">			</span><span class="COMM">//Subfield loop</span><span class="WHIT">
<span class='line'>1090</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">subfieldIndexes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1091</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getSubfields</span><span class="PUNC">(</span><span class="NAME">subfieldIndexes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1092</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1093</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1094</span> </span><span class="WHIT">					</span><span class="COMM">//Subfield level filtering</span><span class="WHIT">
<span class='line'>1095</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">condition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1096</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">condition</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1097</span> </span><span class="WHIT">							</span><span class="NAME">results.push</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1098</span> </span><span class="WHIT">							</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1099</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1100</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1101</span> </span><span class="WHIT">					</span><span class="COMM">//Unconditional subfield matching</span><span class="WHIT">
<span class='line'>1102</span> </span><span class="WHIT">					</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1103</span> </span><span class="WHIT">						</span><span class="NAME">results.push</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1104</span> </span><span class="WHIT">						</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1105</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1106</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1107</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1108</span> </span><span class="WHIT">			</span><span class="COMM">//Field level filtering</span><span class="WHIT">
<span class='line'>1109</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">condition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1110</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">condition</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1111</span> </span><span class="WHIT">					</span><span class="NAME">results.push</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1112</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1113</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1114</span> </span><span class="WHIT">			</span><span class="COMM">//Unconditional field matching</span><span class="WHIT">
<span class='line'>1115</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1116</span> </span><span class="WHIT">				</span><span class="NAME">results.push</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1117</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1118</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1119</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1120</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1121</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1122</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1123</span> 	 * @returns {Marc.Record.Field} the field corresponding to the tag specification, if
<span class='line'>1124</span> 	 * there exists exactly one such field
<span class='line'>1125</span> 	 */</span><span class="WHIT">
<span class='line'>1126</span> </span><span class="WHIT">	</span><span class="NAME">getSingleField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1127</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFields</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1128</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fields.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1129</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">fields</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1130</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1131</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1132</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1133</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1134</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1135</span> 	 * @returns {Marc.Record.Leader} the leader of this record. If no leader data have been
<span class='line'>1136</span> 	 * set, a default leader will be returned.
<span class='line'>1137</span> 	 */</span><span class="WHIT">
<span class='line'>1138</span> </span><span class="WHIT">	</span><span class="NAME">getLeader</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1139</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._leader</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1140</span> </span><span class="WHIT">			</span><span class="NAME">this._leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._createLeader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1141</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1142</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._leader</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1143</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1144</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1145</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1146</span> 	 * Construct this record's leader from the given data.
<span class='line'>1147</span> 	 * @param {String} data the raw record leader data
<span class='line'>1148</span> 	 */</span><span class="WHIT">
<span class='line'>1149</span> </span><span class="WHIT">	</span><span class="NAME">setLeader</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1150</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1151</span> </span><span class="WHIT">			</span><span class="NAME">this._leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Leader</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1152</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._leader</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1153</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1154</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1155</span> 
<span class='line'>1156</span> </span><span class="WHIT">	</span><span class="NAME">_addField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1157</span> </span><span class="WHIT">		</span><span class="NAME">this._fields.push</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1158</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">field</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1159</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1160</span> 
<span class='line'>1161</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1162</span> 	 * Creates a field with the given tag and indicatorn and adds it to this record.
<span class='line'>1163</span> 	 * @param {String} the field's tag
<span class='line'>1164</span> 	 * @param {String} [indicator] the field indicator
<span class='line'>1165</span> 	 * @returns {Marc.Record.Field} the added field
<span class='line'>1166</span> 	 */</span><span class="WHIT">
<span class='line'>1167</span> </span><span class="WHIT">	</span><span class="NAME">addField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">indicator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1168</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._addField</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Field</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">indicator</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1169</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1170</span> 
<span class='line'>1171</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1172</span> 	 * Make sure all mandatory fields exist. Create dummies if necessary. 
<span class='line'>1173</span> 	 */</span><span class="WHIT">
<span class='line'>1174</span> </span><span class="WHIT">	</span><span class="NAME">ensureMandatoryFields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1175</span> </span><span class="WHIT">		</span><span class="NAME">this.getLeader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1176</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1177</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1178</span> </span><span class="WHIT">	</span><span class="NAME">_createLeader</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1179</span> </span><span class="WHIT">		</span><span class="NAME">this._leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Leader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1180</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1181</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1182</span> </span><span class="WHIT">	</span><span class="NAME">_sortFields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1183</span> </span><span class="WHIT">		</span><span class="NAME">this._fields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._fields.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1184</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">b.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1185</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1186</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1187</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">b.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1188</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1189</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1190</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1191</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1192</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1193</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1194</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1195</span> 
<span class='line'>1196</span> </span><span class="WHIT">	</span><span class="COMM">/** Get a processed value. 
<span class='line'>1197</span> 	 * @param {Object} [processing] An object with the following members : 
<span class='line'>1198</span> 	 * @param {Function} [processSubfield] function(value), called on each added subfield.
<span class='line'>1199</span> 	 * Returns the string to be added to the assembled value (default is to use subfield.getContent()).
<span class='line'>1200</span> 	 * @param {Function} [processField] function(value), called on the assembled value for each processed field
<span class='line'>1201</span> 	 * Returns the string to be added to the assembled value.
<span class='line'>1202</span> 	 * @param {Function} [processAll] function(value, ar1, arg2), called on the assembled value for all fields
<span class='line'>1203</span> 	 * Returns the final value.
<span class='line'>1204</span>  	 * processAll: function(value, arg1, arg2)
<span class='line'>1205</span>  	 * @param [arg1] argument to processAll
<span class='line'>1206</span>  	 * @param [arg2] argument to processAll
<span class='line'>1207</span>  	 * @param {String} [subfieldJoin] string used to join all matching subfield values for a single field
<span class='line'>1208</span>  	 * @param {String} [fieldJoin] string used to join the resulting strings from processing all matching fields
<span class='line'>1209</span> 	 * */</span><span class="WHIT">
<span class='line'>1210</span> </span><span class="WHIT">	</span><span class="NAME">getValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldIndexes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">processing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1211</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">subfieldIndexes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1212</span> </span><span class="WHIT">			</span><span class="NAME">subfieldIndexes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1213</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1214</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">processing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1215</span> </span><span class="WHIT">			</span><span class="NAME">processing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1216</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1217</span> </span><span class="WHIT">		</span><span class="COMM">//Get relevant fields</span><span class="WHIT">
<span class='line'>1218</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFields</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1219</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fieldResults</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1220</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">fields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1221</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1222</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fieldResult</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="NAME">subfieldIndexes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">processing</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1223</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fieldResult</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">fieldResult.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1224</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">processing.suppressDuplicates</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">Zotero.Utilities.inArray</span><span class="PUNC">(</span><span class="NAME">fieldResult</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fieldResults</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1225</span> </span><span class="WHIT">					</span><span class="NAME">fieldResults.push</span><span class="PUNC">(</span><span class="NAME">fieldResult</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1226</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1227</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1228</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1229</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fieldResults.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1230</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fieldResults.join</span><span class="PUNC">(</span><span class="NAME">processing.fieldJoin</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1231</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">processing.processAll</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1232</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">processing.processAll</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">processing.arg1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">processing.arg2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1233</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1234</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1235</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1236</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1237</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1238</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1239</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1240</span> 	 * Dump this record to the console.
<span class='line'>1241</span> 	 */</span><span class="WHIT">
<span class='line'>1242</span> </span><span class="WHIT">	</span><span class="NAME">dump</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1243</span> </span><span class="WHIT">		</span><span class="NAME">this._sortFields</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1244</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"MARC record:"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1245</span> </span><span class="WHIT">		</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\n"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._leader.debugString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1246</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1247</span> </span><span class="WHIT">			</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\n"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._fields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">debugString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1248</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1249</span> </span><span class="WHIT">		</span><span class="NAME">Zotero.debug</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1250</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1251</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1252</span> 
<span class='line'>1253</span> </span><span class="COMM">/** Constructs a record leader. 
<span class='line'>1254</span>  * @class Represents a record leader (or label).
<span class='line'>1255</span>  * @param {String} [data] the raw label data. If missing, the leader will have default values. 
<span class='line'>1256</span>  * */</span><span class="WHIT">
<span class='line'>1257</span> </span><span class="NAME">Marc.Record.Leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1258</span> </span><span class="WHIT">	</span><span class="NAME">this._data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._getDefaultData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1259</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1260</span> 
<span class='line'>1261</span> </span><span class="NAME">Marc.Record.Leader.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1262</span> </span><span class="WHIT">	</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Leader</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1263</span> </span><span class="WHIT">	</span><span class="COMM">/** Default data. */</span><span class="WHIT">
<span class='line'>1264</span> </span><span class="WHIT">	</span><span class="NAME">_getDefaultData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1265</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.lpad</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">24</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1266</span> </span><span class="WHIT">		</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'a'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1267</span> </span><span class="WHIT">		</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'m'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1268</span> </span><span class="WHIT">		</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'2'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1269</span> </span><span class="WHIT">		</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'2'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1270</span> </span><span class="WHIT">		</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">20</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'4'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1271</span> </span><span class="WHIT">		</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">21</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'5'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1272</span> </span><span class="WHIT">		</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">22</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'0'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1273</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1274</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1275</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1276</span> 	 *  Serialize the leader. See Record.serialize for available options.
<span class='line'>1277</span> 	 *  @returns {String}
<span class='line'>1278</span> 	 */</span><span class="WHIT">
<span class='line'>1279</span> </span><span class="WHIT">	</span><span class="NAME">serialize</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1280</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1281</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.suppressLeader</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1282</span> </span><span class="WHIT">			</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"000"</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1283</span> </span><span class="WHIT">				</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">options.tagDelimiter</span><span class="WHIT">
<span class='line'>1284</span> </span><span class="WHIT">				</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._data</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1285</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1286</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1287</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1288</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1289</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1290</span> 	 * @returns {String} a string representation fitting for console output
<span class='line'>1291</span> 	 */</span><span class="WHIT">
<span class='line'>1292</span> </span><span class="WHIT">	</span><span class="NAME">debugString</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1293</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"000:\n\t"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._data</span><span class="WHIT">
<span class='line'>1294</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\trecord length: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getRecordLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1295</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\trecord status: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getRecordStatus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1296</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\trecord type: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getRecordType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1297</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\timplementation codes: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getImplementationCodes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1298</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\tindicator length: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getIndicatorLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1299</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\tsubfield delimiter length: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getSubfieldDelimiterLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1300</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\tbase address: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getBaseAddress</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1301</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\tdir length length: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getDirectoryLengthLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1302</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\tdir start address length: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getDirectoryStartLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1303</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\n\tdir impl data length: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getDirectoryImplLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1304</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1305</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1306</span> 	 * @return {Integer}
<span class='line'>1307</span> 	 */</span><span class="WHIT">
<span class='line'>1308</span> </span><span class="WHIT">	</span><span class="NAME">getRecordLength</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1309</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1310</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1311</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1312</span> 	 * @return {String} the record status
<span class='line'>1313</span> 	 */</span><span class="WHIT">
<span class='line'>1314</span> </span><span class="WHIT">	</span><span class="NAME">getRecordStatus</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1315</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1316</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1317</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1318</span> 	 * @return {String} the record type
<span class='line'>1319</span> 	 */</span><span class="WHIT">
<span class='line'>1320</span> </span><span class="WHIT">	</span><span class="NAME">getRecordType</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1321</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1322</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1323</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1324</span> 	 * @return {String} the implementation specific codes at positions 7-9
<span class='line'>1325</span> 	 */</span><span class="WHIT">
<span class='line'>1326</span> </span><span class="WHIT">	</span><span class="NAME">getImplementationCodes</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1327</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">7</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1328</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1329</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1330</span> 	 * @return {Integer}
<span class='line'>1331</span> 	 */</span><span class="WHIT">
<span class='line'>1332</span> </span><span class="WHIT">	</span><span class="NAME">getIndicatorLength</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1333</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1334</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1335</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1336</span> 	 * @return {Integer}
<span class='line'>1337</span> 	 */</span><span class="WHIT">
<span class='line'>1338</span> </span><span class="WHIT">	</span><span class="NAME">getSubfieldDelimiterLength</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1339</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">11</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1340</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1341</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1342</span> 	 * @return {Integer}
<span class='line'>1343</span> 	 */</span><span class="WHIT">
<span class='line'>1344</span> </span><span class="WHIT">	</span><span class="NAME">getBaseAddress</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1345</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">12</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1346</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1347</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1348</span> 	 * @return {Integer}
<span class='line'>1349</span> 	 */</span><span class="WHIT">
<span class='line'>1350</span> </span><span class="WHIT">	</span><span class="NAME">getDirectoryLengthLength</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1351</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">20</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1352</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1353</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1354</span> 	 * @return {Integer}
<span class='line'>1355</span> 	 */</span><span class="WHIT">
<span class='line'>1356</span> </span><span class="WHIT">	</span><span class="NAME">getDirectoryStartLength</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1357</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">21</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1358</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1359</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1360</span> 	 * @return {Integer}
<span class='line'>1361</span> 	 */</span><span class="WHIT">
<span class='line'>1362</span> </span><span class="WHIT">	</span><span class="NAME">getDirectoryImplLength</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1363</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NUMB">22</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1364</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1365</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1366</span> 	 * @return {String} an arbitrary substring of the leader's data
<span class='line'>1367</span> 	 */</span><span class="WHIT">
<span class='line'>1368</span> </span><span class="WHIT">	</span><span class="NAME">getDataSubstr</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">start</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1369</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._data.substr</span><span class="PUNC">(</span><span class="NAME">start</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1370</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1371</span> 
<span class='line'>1372</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1373</span> 
<span class='line'>1374</span> 
<span class='line'>1375</span> </span><span class="COMM">/**
<span class='line'>1376</span>  *  Constructs an empty Unimarc record. Currently used by exports only.
<span class='line'>1377</span>  *  @class An Unimarc record. 
<span class='line'>1378</span>  *  @augments Marc.Record
<span class='line'>1379</span>  *  */</span><span class="WHIT">
<span class='line'>1380</span> </span><span class="NAME">Marc.UnimarcRecord</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1381</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1382</span> 
<span class='line'>1383</span> </span><span class="NAME">Marc.UnimarcRecord.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Record</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1384</span> </span><span class="NAME">Marc.UnimarcRecord.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcRecord</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1385</span> </span><span class="NAME">Marc.UnimarcRecord.prototype.ensureMandatoryFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1386</span> </span><span class="WHIT">	</span><span class="NAME">Marc.Record.prototype.ensureMandatoryFields.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1387</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1388</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1389</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag.flags</span><span class="WHIT"> </span><span class="PUNC">&</span><span class="WHIT"> </span><span class="NAME">Marc.Tag.Flags.MANDATORY</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1390</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasField</span><span class="PUNC">(</span><span class="NAME">tag.tag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1391</span> </span><span class="WHIT">				</span><span class="NAME">this._createMandatoryField</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tag.tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1392</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1393</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1394</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1395</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1396</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1397</span> </span><span class="NAME">Marc.UnimarcRecord.prototype._createMandatoryField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1398</span> </span><span class="WHIT">	</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1399</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.RECORD_IDENTIFIER.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1400</span> </span><span class="WHIT">		</span><span class="NAME">this._createRecordIdentifier</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1401</span> </span><span class="WHIT">		</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1402</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.GENERAL_PROCESSING_DATA.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1403</span> </span><span class="WHIT">		</span><span class="NAME">this._createGeneralProcessingData</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1404</span> </span><span class="WHIT">		</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1405</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1406</span> </span><span class="WHIT">		</span><span class="NAME">this._createTitle</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1407</span> </span><span class="WHIT">		</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1408</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.ORIGINATING_SOURCE.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1409</span> </span><span class="WHIT">		</span><span class="NAME">this._createOriginatingSource</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1410</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1411</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1412</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1413</span> </span><span class="NAME">Marc.UnimarcRecord.prototype._createRecordIdentifier</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1414</span> </span><span class="WHIT">	</span><span class="NAME">this.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.RECORD_IDENTIFIER</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1415</span> </span><span class="WHIT">		</span><span class="PUNC">.</span><span class="NAME">addSingleContent</span><span class="PUNC">(</span><span class="STRN">"ZoteroItem"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1416</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1417</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1418</span> </span><span class="NAME">Marc.UnimarcRecord.prototype._createGeneralProcessingData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1419</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.lpad</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"#"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">36</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1420</span> </span><span class="WHIT">	</span><span class="NAME">this.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.GENERAL_PROCESSING_DATA</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1421</span> </span><span class="WHIT">		</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1422</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1423</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1424</span> </span><span class="NAME">Marc.UnimarcRecord.prototype._createTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1425</span> </span><span class="WHIT">	</span><span class="NAME">this.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1426</span> </span><span class="WHIT">		</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"[No title]"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1427</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1428</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1429</span> </span><span class="NAME">Marc.UnimarcRecord.prototype._createOriginatingSource</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1430</span> </span><span class="WHIT">	</span><span class="NAME">this.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.ORIGINATING_SOURCE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">" 0"</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1431</span> </span><span class="WHIT">		</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"Zotero"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1432</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1433</span> 
<span class='line'>1434</span> 
<span class='line'>1435</span> </span><span class="COMM">/**
<span class='line'>1436</span>  * @namespace Record utilities.
<span class='line'>1437</span>  **/</span><span class="WHIT">
<span class='line'>1438</span> </span><span class="NAME">Marc.Records</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1439</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1440</span> 	 * @param {String} [type="generic"] the MARC type ("marc21", "unimarc", "generic")
<span class='line'>1441</span> 	 * @returns {Marc.Record} an empty record of the given type
<span class='line'>1442</span> 	 */</span><span class="WHIT">
<span class='line'>1443</span> </span><span class="WHIT">	</span><span class="NAME">newRecord</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1444</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1445</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"unimarc"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1446</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcRecord</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1447</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"marc21"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1448</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"generic"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1449</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1450</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Record</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1451</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1452</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1453</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1454</span> 
<span class='line'>1455</span> 
<span class='line'>1456</span> </span><span class="COMM">/* Fields */</span><span class="WHIT">
<span class='line'>1457</span> 
<span class='line'>1458</span> </span><span class="COMM">/**
<span class='line'>1459</span>  * Constructs a MARC field.
<span class='line'>1460</span>  * @class A MARC field.
<span class='line'>1461</span>  * @param {Marc.Record} record the containing record
<span class='line'>1462</span>  * @param {String} tag the field's tag
<span class='line'>1463</span>  * @param {String} [indicator] the field's indicator
<span class='line'>1464</span>  */</span><span class="WHIT">
<span class='line'>1465</span> </span><span class="NAME">Marc.Record.Field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">indicator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1466</span> </span><span class="WHIT">	</span><span class="NAME">this._record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1467</span> </span><span class="WHIT">	</span><span class="NAME">this._tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tag.tag</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1468</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._tag.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1469</span> </span><span class="WHIT">		</span><span class="NAME">this._tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._tag.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1470</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1471</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._tag.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1472</span> </span><span class="WHIT">		</span><span class="NAME">this._tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.lpad</span><span class="PUNC">(</span><span class="NAME">this._tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"0"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1473</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1474</span> </span><span class="WHIT">	</span><span class="NAME">this._indicator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">indicator</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"  "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1475</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._tag.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"00"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1476</span> </span><span class="WHIT">		</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._indicator</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1477</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1478</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1479</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">indicatorLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._record.getLeader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getIndicatorLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1480</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._indicator.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">indicatorLength</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1481</span> </span><span class="WHIT">			</span><span class="NAME">this._indicator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._indicator.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">indicatorLength</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1482</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1483</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._indicator.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">indicatorLength</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1484</span> </span><span class="WHIT">			</span><span class="NAME">this._indicator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.lpad</span><span class="PUNC">(</span><span class="NAME">this._indicator</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">indicatorLength</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1485</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1486</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1487</span> </span><span class="WHIT">	</span><span class="NAME">this._subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1488</span> </span><span class="WHIT">	</span><span class="NAME">this._embeddedFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1489</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1490</span> 
<span class='line'>1491</span> </span><span class="NAME">Marc.Record.Field.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1492</span> </span><span class="WHIT">	</span><span class="NAME">constructor</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Field</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1493</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1494</span> 	 *  Serialize the field. See {@link Marc.Record#serialize} for available options.
<span class='line'>1495</span> 	 */</span><span class="WHIT">
<span class='line'>1496</span> </span><span class="WHIT">	</span><span class="NAME">serialize</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1497</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">options.tagDelimiter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1498</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._indicator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1499</span> </span><span class="WHIT">			</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._indicator.replace</span><span class="PUNC">(</span><span class="REGX">/ /g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options.blankIndicator</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1500</span> </span><span class="WHIT">				</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">options.indicatorDelimiter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1501</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1502</span> </span><span class="WHIT">		</span><span class="NAME">this._subfields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1503</span> </span><span class="WHIT">			</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.serialize</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1504</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1505</span> </span><span class="WHIT">		</span><span class="NAME">this._embeddedFields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">embeddedField</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1506</span> </span><span class="WHIT">			</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options.subfieldCharacter</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"1"</span><span class="WHIT">
<span class='line'>1507</span> </span><span class="WHIT">				</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">embeddedField.serialize</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1508</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1509</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1510</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1511</span> 
<span class='line'>1512</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1513</span> 	 * @returns {String} a suitable string for console debugging. Do not
<span class='line'>1514</span> 	 * call Zotero.debug() on a field instance (inifinite loop).
<span class='line'>1515</span> 	 */</span><span class="WHIT">
<span class='line'>1516</span> </span><span class="WHIT">	</span><span class="NAME">debugString</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1517</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1518</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._indicator</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1519</span> </span><span class="WHIT">			</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" ["</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._indicator</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"]"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1520</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1521</span> </span><span class="WHIT">		</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">":"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1522</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._subfields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1523</span> </span><span class="WHIT">			</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\n"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._subfields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">debugString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1524</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1525</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._embeddedFields.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1526</span> </span><span class="WHIT">			</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"Embedded fields:"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1527</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._embeddedFields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1528</span> </span><span class="WHIT">				</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\n"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._embeddedFields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">debugString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1529</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1530</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1531</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1532</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1533</span> 
<span class='line'>1534</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1535</span> 	 * Get the parent record.
<span class='line'>1536</span> 	 * @returns {Marc.Record}
<span class='line'>1537</span> 	 */</span><span class="WHIT">
<span class='line'>1538</span> </span><span class="WHIT">	</span><span class="NAME">getRecord</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1539</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._record</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1540</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1541</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1542</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1543</span> 	 * @returns {String} the three-digit tag of this field.
<span class='line'>1544</span> 	 */</span><span class="WHIT">
<span class='line'>1545</span> </span><span class="WHIT">	</span><span class="NAME">getTag</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1546</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._tag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1547</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1548</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1549</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1550</span> 	 * @returns {String} the two-character indicator of this field, or
<span class='line'>1551</span> 	 * nothing in the case of control fields (00X)
<span class='line'>1552</span> 	 */</span><span class="WHIT">
<span class='line'>1553</span> </span><span class="WHIT">	</span><span class="NAME">getIndicator</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1554</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._indicator</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1555</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1556</span> 
<span class='line'>1557</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1558</span> 	 * @returns {Marc.Record.Subfield} the subfield at the given index
<span class='line'>1559</span> 	 */</span><span class="WHIT">
<span class='line'>1560</span> </span><span class="WHIT">	</span><span class="NAME">getSubfield</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1561</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._subfields</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1562</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1563</span> 
<span class='line'>1564</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1565</span> 	 * @returns {Marc.Record.Subfield[]} an array of subfields specified by the tags argument.
<span class='line'>1566</span> 	 * @param {String|String[]} [tag] a matching condition for the subfields to be returned.
<span class='line'>1567</span> 	 * Can be a string of subfield tags ("a", "aef") or an array of strings (["a", "e", "f"]).
<span class='line'>1568</span> 	 * If the argument is missing, all subfields will be terurned.
<span class='line'>1569</span> 	 */</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1570</span> </span><span class="WHIT">	</span><span class="NAME">getSubfields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1571</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1572</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tag.length</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1573</span> </span><span class="WHIT">			</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tag.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1574</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1575</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._subfields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1576</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._subfields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1577</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tag.indexOf</span><span class="PUNC">(</span><span class="NAME">subfield.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1578</span> </span><span class="WHIT">				</span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1579</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1580</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1581</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1582</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1583</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1584</span> </span><span class="WHIT">	</span><span class="COMM">/** Assemble subfield values to a single string.
<span class='line'>1585</span> 	 * @returns {String} the assembled value from all matching subfields
<span class='line'>1586</span> 	 * @param {String} subfieldIndexes a subfield selector. See {@link #getSubfields}
<span class='line'>1587</span> 	 * @param {Object} [processing] controls the assembly of subfield values into
<span class='line'>1588</span> 	 * a single string. See {#link Marc.Record#getValue}.
<span class='line'>1589</span> 	 */</span><span class="WHIT">
<span class='line'>1590</span> </span><span class="WHIT">	</span><span class="NAME">getValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">processing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1591</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">processing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1592</span> </span><span class="WHIT">			</span><span class="NAME">processing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1593</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1594</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">results</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1595</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getSubfields</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1596</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1597</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1598</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">processing.processSubfield</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1599</span> </span><span class="WHIT">				</span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">processing.processSubfield</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1600</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1601</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1602</span> </span><span class="WHIT">				</span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1603</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1604</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">processing.suppressDuplicates</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">Zotero.Utilities.inArray</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">results</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1605</span> </span><span class="WHIT">				</span><span class="NAME">results.push</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1606</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1607</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1608</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">results.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1609</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">results.join</span><span class="PUNC">(</span><span class="NAME">processing.subfieldJoin</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1610</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">processing.processField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1611</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">processing.processField</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1612</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1613</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1614</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1615</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1616</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1617</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1618</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1619</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1620</span> </span><span class="WHIT">	</span><span class="COMM">/** Check whether at least one subfield matched the tag condition.
<span class='line'>1621</span> 	 * @param {String} tag a subfield selector. See {@link #getSubfields}
<span class='line'>1622</span> 	 */</span><span class="WHIT">
<span class='line'>1623</span> </span><span class="WHIT">	</span><span class="NAME">hasSubfield</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1624</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tag.length</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1625</span> </span><span class="WHIT">			</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tag.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1626</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1627</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._subfields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1628</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._subfields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1629</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tag.indexOf</span><span class="PUNC">(</span><span class="NAME">subfield.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1630</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1631</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1632</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1633</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1634</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1635</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1636</span> 	 * Get the embedded fields of this field.
<span class='line'>1637</span> 	 * @returns {Marc.Record.Field[]} array of embedded fields
<span class='line'>1638</span> 	 */</span><span class="WHIT">
<span class='line'>1639</span> </span><span class="WHIT">	</span><span class="NAME">getEmbeddedFields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1640</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._embeddedFields</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1641</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1642</span> 
<span class='line'>1643</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1644</span> 	 * Initialize this field from raw field data.
<span class='line'>1645</span> 	 * @param {String} data the raw field data including the indicator but without the tag
<span class='line'>1646</span> 	 * @returns {Marc.Record.Field} this field
<span class='line'>1647</span> 	 */</span><span class="WHIT">
<span class='line'>1648</span> </span><span class="WHIT">	</span><span class="NAME">parse</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1649</span> </span><span class="WHIT">		</span><span class="COMM">//Control field?</span><span class="WHIT">
<span class='line'>1650</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._tag.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"00"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1651</span> </span><span class="WHIT">			</span><span class="COMM">//Indicator</span><span class="WHIT">
<span class='line'>1652</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">indicatorLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._record.getLeader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getIndicatorLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1653</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">Marc.Delimiters.SUBFIELD_DELIMITER</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1654</span> </span><span class="WHIT">				</span><span class="NAME">this._indicator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">indicatorLength</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1655</span> </span><span class="WHIT">				</span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data.substr</span><span class="PUNC">(</span><span class="NAME">indicatorLength</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1656</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1657</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1658</span> </span><span class="WHIT">				</span><span class="NAME">this._indicator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.lpad</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1659</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1660</span> </span><span class="WHIT">			</span><span class="COMM">//Subfields</span><span class="WHIT">
<span class='line'>1661</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data.split</span><span class="PUNC">(</span><span class="NAME">Marc.Delimiters.SUBFIELD_SPLITTER</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1662</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1663</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1664</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">subfield.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1665</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfieldIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1666</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfieldData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.substr</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1667</span> </span><span class="WHIT">					</span><span class="COMM">//Embedded field?</span><span class="WHIT">
<span class='line'>1668</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">subfieldIndex</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"1"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1669</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subtag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfieldData.substr</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1670</span> </span><span class="WHIT">						</span><span class="NAME">subfieldData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfieldData.substr</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1671</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">embeddedField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Field</span><span class="PUNC">(</span><span class="NAME">subtag</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parse</span><span class="PUNC">(</span><span class="NAME">subfieldData</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1672</span> </span><span class="WHIT">						</span><span class="NAME">this.embeddedFields.push</span><span class="PUNC">(</span><span class="NAME">embeddedField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1673</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1674</span> </span><span class="WHIT">					</span><span class="COMM">//Subfield</span><span class="WHIT">
<span class='line'>1675</span> </span><span class="WHIT">					</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1676</span> </span><span class="WHIT">						</span><span class="NAME">this.addSubfield</span><span class="PUNC">(</span><span class="NAME">subfieldIndex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldData</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1677</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1678</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1679</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1680</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1681</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1682</span> </span><span class="WHIT">			</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._indicator</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1683</span> </span><span class="WHIT">			</span><span class="NAME">this.addSingleContent</span><span class="PUNC">(</span><span class="NAME">data.replace</span><span class="PUNC">(</span><span class="NAME">Marc.Delimiters.FIELD_TERMINATOR</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1684</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1685</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1686</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1687</span> 
<span class='line'>1688</span> </span><span class="WHIT">	</span><span class="NAME">_addSubfield</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1689</span> </span><span class="WHIT">		</span><span class="NAME">this._subfields.push</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1690</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1691</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1692</span> 
<span class='line'>1693</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1694</span> 	 * Add a subfield to this field.
<span class='line'>1695</span> 	 * @param {String} tag the subfield tag (e.g. "a")
<span class='line'>1696</span> 	 * @param {String} content the content of the new subfield (e.g. "Doe, John")
<span class='line'>1697</span> 	 * @returns {Marc.Record.Field} this field (not the subfield! see example)
<span class='line'>1698</span> 	 * @example
<span class='line'>1699</span> 	 * record.addField(Marc.Marc21.Tags.TITLE_STATEMENT)
<span class='line'>1700</span> 	 * 	.addSubfield("a", "Zotero:")
<span class='line'>1701</span> 	 *  .addSubfields("b", "an Introduction");
<span class='line'>1702</span> 	 */</span><span class="WHIT">
<span class='line'>1703</span> </span><span class="WHIT">	</span><span class="NAME">addSubfield</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1704</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">content</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1705</span> </span><span class="WHIT">			</span><span class="NAME">this._addSubfield</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Subfield</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1706</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1707</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1708</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1709</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1710</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1711</span> 	 * Add content to a control field (00X) that won't have any subfields.
<span class='line'>1712</span> 	 * @param {String} content the field content
<span class='line'>1713</span> 	 * @returns {Marc.Record.Field} this field
<span class='line'>1714</span> 	 * @throws an execption if applied to a field that is not a 00X
<span class='line'>1715</span> 	 * */</span><span class="WHIT">
<span class='line'>1716</span> </span><span class="WHIT">	</span><span class="NAME">addSingleContent</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">content</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1717</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"00"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1718</span> </span><span class="WHIT">			</span><span class="NAME">this._subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1719</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.addSubfield</span><span class="PUNC">(</span><span class="STRN">"?"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1720</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1721</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1722</span> </span><span class="WHIT">			</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"Single content is allowed for 00X fields only"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1723</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1724</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1725</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1726</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1727</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1728</span> 	 * Get the content of a control field (00X) that does not have any subfields.
<span class='line'>1729</span> 	 * @returns {String} content the field content
<span class='line'>1730</span> 	 * @throws an execption if applied to a field that is not a 00X
<span class='line'>1731</span> 	 * */</span><span class="WHIT">
<span class='line'>1732</span> </span><span class="WHIT">	</span><span class="NAME">getSingleContent</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1733</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"00"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1734</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">getSubfields</span><span class="PUNC">(</span><span class="STRN">"?"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1735</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1736</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1737</span> </span><span class="WHIT">			</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"Single content is allowed for 00X fields only"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1738</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1739</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1740</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1741</span> 
<span class='line'>1742</span> </span><span class="COMM">/* Subfields */</span><span class="WHIT">
<span class='line'>1743</span> 
<span class='line'>1744</span> </span><span class="COMM">/**
<span class='line'>1745</span>  * Constructs a new subfield.
<span class='line'>1746</span>  * @class Represents a single subfield.
<span class='line'>1747</span>  */</span><span class="WHIT">
<span class='line'>1748</span> </span><span class="NAME">Marc.Record.Subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1749</span> </span><span class="WHIT">	</span><span class="NAME">this._tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1750</span> </span><span class="WHIT">	</span><span class="NAME">this._content</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1751</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1752</span> 
<span class='line'>1753</span> </span><span class="NAME">Marc.Record.Subfield.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1754</span> </span><span class="WHIT">	</span><span class="NAME">constructor</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Marc.Record.Subfield</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1755</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1756</span> 	 *  Serialize the subfield. See {@linc Marc.Record#serialize} for available options.
<span class='line'>1757</span> 	 *  @returns {String}
<span class='line'>1758</span> 	 */</span><span class="WHIT">
<span class='line'>1759</span> </span><span class="WHIT">	</span><span class="NAME">serialize</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1760</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1761</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"?"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1762</span> </span><span class="WHIT">			</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options.subfieldCharacter</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">options.subfieldDelimiter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1763</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1764</span> </span><span class="WHIT">		</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1765</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1766</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1767</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1768</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1769</span> 	 * Get the subfield tag, e.g. "a"
<span class='line'>1770</span> 	 * @returns {String} the subfield tag
<span class='line'>1771</span> 	 */</span><span class="WHIT">
<span class='line'>1772</span> </span><span class="WHIT">	</span><span class="NAME">getTag</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1773</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._tag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1774</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1775</span> 
<span class='line'>1776</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1777</span> 	 * Get the subfield content, e.g. "Doe, John"
<span class='line'>1778</span> 	 * @returns {String} the subfield tag
<span class='line'>1779</span> 	 */</span><span class="WHIT">
<span class='line'>1780</span> </span><span class="WHIT">	</span><span class="NAME">getContent</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1781</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._content</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1782</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1783</span> 
<span class='line'>1784</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1785</span> 	 * Get a suitable string for console output
<span class='line'>1786</span> 	 * @returns {String}
<span class='line'>1787</span> 	 */</span><span class="WHIT">
<span class='line'>1788</span> </span><span class="WHIT">	</span><span class="NAME">debugString</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1789</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._index</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._index</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1790</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"\t$"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._index</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">": "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._content</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1791</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1792</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1793</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"\t"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._content</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1794</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1795</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1796</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1797</span> 
<span class='line'>1798</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1799</span> </span><span class="COMM">/**
<span class='line'>1800</span>  *  Constructs an export converter base class.
<span class='line'>1801</span>  *  @class ExportConverter instances build Marc records from Zotero items.
<span class='line'>1802</span>  *  This is an abstract base class; derived classes must take actions 
<span class='line'>1803</span>  *  for a specific Marc format.
<span class='line'>1804</span>  */</span><span class="WHIT">
<span class='line'>1805</span> </span><span class="NAME">Marc.ExportConverter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1806</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1807</span> 
<span class='line'>1808</span> </span><span class="COMM">/**
<span class='line'>1809</span>  *  Takes a Zotero item and creates a MARC record. Must be overridden by subclasses.
<span class='line'>1810</span>  *  @param {Zotero.Item} item the Zotero item
<span class='line'>1811</span>  *  @returns {Marc.Record} the record, filled with data from item 
<span class='line'>1812</span>  **/</span><span class="WHIT">
<span class='line'>1813</span> </span><span class="NAME">Marc.ExportConverter.prototype.convert</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1814</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Records.newRecord</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1815</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1816</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1817</span> 
<span class='line'>1818</span> 
<span class='line'>1819</span> </span><span class="COMM">/**
<span class='line'>1820</span>  * Constructs a UnimarcExportConverter.
<span class='line'>1821</span>  * @class An ExportConverter rendering Unimarc records.
<span class='line'>1822</span>  * @augments Marc.ExportConverter
<span class='line'>1823</span>  *  */</span><span class="WHIT">
<span class='line'>1824</span> </span><span class="NAME">Marc.UnimarcExportConverter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1825</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1826</span> </span><span class="NAME">Marc.UnimarcExportConverter.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.ExportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1827</span> </span><span class="NAME">Marc.UnimarcExportConverter.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcExportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1828</span> 
<span class='line'>1829</span> </span><span class="NAME">Marc.UnimarcExportConverter.prototype._convertCreators</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1830</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">item.creators</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1831</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">creator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">  </span><span class="NAME">item.creators</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1832</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1833</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">creator.creatorType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">record.hasField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_PRIMARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1834</span> </span><span class="WHIT">			</span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_PRIMARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1835</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1836</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1837</span> </span><span class="WHIT">			</span><span class="NAME">field</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_ALTERNATIVE_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1838</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1839</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1840</span> </span><span class="WHIT">			</span><span class="NAME">field.addSubfield</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">creator.lastName</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1841</span> </span><span class="WHIT">				</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">creator.firstName</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1842</span> </span><span class="WHIT">				</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"4"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.getRelatorCode</span><span class="PUNC">(</span><span class="NAME">creator.creatorType</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1843</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1844</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1845</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1846</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1847</span> </span><span class="NAME">Marc.UnimarcExportConverter.prototype._convertTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1848</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.title</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1849</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">shortTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.shortTitle</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1850</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">shortTitle</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1851</span> </span><span class="WHIT">		</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">shortTitle.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT">
<span class='line'>1852</span> </span><span class="WHIT">		</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">shortTitle.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">title.length</span><span class="WHIT">
<span class='line'>1853</span> </span><span class="WHIT">		</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">shortTitle</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">title.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">shortTitle.length</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1854</span> </span><span class="WHIT">		</span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1855</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">shortTitle</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1856</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"e"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">title.substr</span><span class="PUNC">(</span><span class="NAME">shortTitle.length</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1857</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1858</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1859</span> </span><span class="WHIT">		</span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1860</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">title</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1861</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1862</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1863</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1864</span> </span><span class="NAME">Marc.UnimarcExportConverter.prototype._convertEdition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1865</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.edition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1866</span> </span><span class="WHIT">		</span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.EDITION_STATEMENT</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1867</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item.edition</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1868</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1869</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.place</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">item.publisher</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">item.date</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1870</span> </span><span class="WHIT">		</span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PUBLICATION_DISTRIBUTION_ETC</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1871</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item.place</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1872</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item.publisher</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1873</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">addSubfield</span><span class="PUNC">(</span><span class="STRN">"d"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item.date</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1874</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1875</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1876</span> 
<span class='line'>1877</span> </span><span class="COMM">/**
<span class='line'>1878</span>  * Overrides {@link Marc.ExportConverter#convert}. Creates a
<span class='line'>1879</span>  * {@link Marc.UnimarcRecord} and filles it with item data.
<span class='line'>1880</span>  */</span><span class="WHIT">
<span class='line'>1881</span> </span><span class="NAME">Marc.UnimarcExportConverter.prototype.convert</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1882</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Records.newRecord</span><span class="PUNC">(</span><span class="STRN">"unimarc"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1883</span> </span><span class="WHIT">	</span><span class="COMM">//Creators</span><span class="WHIT">
<span class='line'>1884</span> </span><span class="WHIT">	</span><span class="NAME">this._convertCreators</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1885</span> </span><span class="WHIT">	</span><span class="COMM">//Title</span><span class="WHIT">
<span class='line'>1886</span> </span><span class="WHIT">	</span><span class="NAME">this._convertTitle</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1887</span> </span><span class="WHIT">	</span><span class="COMM">//Edition</span><span class="WHIT">
<span class='line'>1888</span> </span><span class="WHIT">	</span><span class="NAME">this._convertEdition</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1889</span> 
<span class='line'>1890</span> </span><span class="WHIT">	</span><span class="COMM">//Ensure mandatory fields, creates dummies if necessary</span><span class="WHIT">
<span class='line'>1891</span> </span><span class="WHIT">	</span><span class="NAME">record.ensureMandatoryFields</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1892</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1893</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1894</span> 
<span class='line'>1895</span> 
<span class='line'>1896</span> </span><span class="COMM">/** Constructs an ImportConverter.
<span class='line'>1897</span>  * @class ImportConverters create Zotero items from a given Marc record.
<span class='line'>1898</span>  * This is an abstract base class; derived classes must take actions 
<span class='line'>1899</span>  *  for a specific Marc format.
<span class='line'>1900</span>  **/</span><span class="WHIT">
<span class='line'>1901</span> </span><span class="NAME">Marc.ImportConverter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1902</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1903</span> 
<span class='line'>1904</span> </span><span class="COMM">/**
<span class='line'>1905</span>  *  Takes a MARC record and return a Zotero item.
<span class='line'>1906</span>  *  Creates an empty item and calls the _getXXX methods of this class.
<span class='line'>1907</span>  *  Subclasses do not necessarily need to override this method, it may suffice
<span class='line'>1908</span>  *  to override the _getXXX member functions.
<span class='line'>1909</span>  *  @param {Marc.Record} the Marc record to be converted
<span class='line'>1910</span>  *  @returns {Zotero.Item} an item filled with the record's data
<span class='line'>1911</span>  **/</span><span class="WHIT">
<span class='line'>1912</span> </span><span class="NAME">Marc.ImportConverter.prototype.convert</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1913</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Zotero.Item</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1914</span> </span><span class="WHIT">	</span><span class="NAME">this._getItemType</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1915</span> </span><span class="WHIT">	</span><span class="NAME">this._getLanguage</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1916</span> </span><span class="WHIT">	</span><span class="NAME">this._getISBN</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1917</span> </span><span class="WHIT">	</span><span class="NAME">this._getISSN</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1918</span> </span><span class="WHIT">	</span><span class="NAME">this._getCreators</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1919</span> </span><span class="WHIT">	</span><span class="NAME">this._getTitle</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1920</span> </span><span class="WHIT">	</span><span class="NAME">this._getAbstract</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1921</span> </span><span class="WHIT">	</span><span class="NAME">this._getEdition</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1922</span> </span><span class="WHIT">	</span><span class="NAME">this._getMaterialDescription</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1923</span> </span><span class="WHIT">	</span><span class="NAME">this._getSeries</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1924</span> </span><span class="WHIT">	</span><span class="NAME">this._getTags</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1925</span> </span><span class="WHIT">	</span><span class="NAME">this._getCallNumber</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1926</span> </span><span class="WHIT">	</span><span class="NAME">this._getExtra</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1927</span> </span><span class="WHIT">	</span><span class="NAME">this._getNotes</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1928</span> </span><span class="WHIT">	</span><span class="NAME">this._getAttachments</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1929</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1930</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1931</span> 
<span class='line'>1932</span> </span><span class="COMM">/** Add tag, if not present yet in the item.
<span class='line'>1933</span>  * @param {Zotero.Item} item the target item
<span class='line'>1934</span>  * @param {String} tag a tag to be added
<span class='line'>1935</span>  * @public
<span class='line'>1936</span>  */</span><span class="WHIT">
<span class='line'>1937</span> </span><span class="NAME">Marc.ImportConverter.prototype._addTag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1938</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">item.tags</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1939</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.tags</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1940</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1941</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1942</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1943</span> </span><span class="WHIT">	</span><span class="NAME">item.tags.push</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1944</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1945</span> 
<span class='line'>1946</span> 
<span class='line'>1947</span> </span><span class="COMM">/**
<span class='line'>1948</span>  *  Add extra text.
<span class='line'>1949</span>  * */</span><span class="WHIT">
<span class='line'>1950</span> </span><span class="NAME">Marc.ImportConverter.prototype._addExtra</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">noteText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">extra</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1951</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">extra</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1952</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="REGX">/\.\?$/</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">noteText</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1953</span> </span><span class="WHIT">			</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">". "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1954</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1955</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1956</span> </span><span class="WHIT">			</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1957</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1958</span> </span><span class="WHIT">		</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.trim</span><span class="PUNC">(</span><span class="NAME">extra</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1959</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1960</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">noteText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1961</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1962</span> 
<span class='line'>1963</span> 
<span class='line'>1964</span> </span><span class="COMM">/** Set a multi field. */</span><span class="WHIT">
<span class='line'>1965</span> </span><span class="NAME">Marc.ImportConverter.prototype._setMultiField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fieldName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1966</span> </span><span class="WHIT">	</span><span class="COMM">//Base value?</span><span class="WHIT">
<span class='line'>1967</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">item</span><span class="PUNC">[</span><span class="NAME">fieldName</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1968</span> </span><span class="WHIT">		</span><span class="NAME">item</span><span class="PUNC">[</span><span class="NAME">fieldName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1969</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1970</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1971</span> </span><span class="WHIT">		</span><span class="NAME">item.multi.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1972</span> </span><span class="WHIT">			</span><span class="NAME">fieldName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">fieldName</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1973</span> </span><span class="WHIT">			</span><span class="NAME">val</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1974</span> </span><span class="WHIT">			</span><span class="NAME">lang</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT">
<span class='line'>1975</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1976</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1977</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1978</span> 
<span class='line'>1979</span> </span><span class="COMM">/** 
<span class='line'>1980</span>  * Get item type from a record. the default implementation will evaluate the
<span class='line'>1981</span>  * leader's record type flag. Derived classes may use finer methods.
<span class='line'>1982</span>  * @param {Marc.Record} record the source record 
<span class='line'>1983</span>  * @param {Zotero.Item} the target item 
<span class='line'>1984</span>  **/</span><span class="WHIT">
<span class='line'>1985</span> </span><span class="NAME">Marc.ImportConverter.prototype._getItemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1986</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getLeader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1987</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">leader</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1988</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">leader.getRecordType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1989</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"g"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1990</span> </span><span class="WHIT">			</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"film"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1991</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1992</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"e"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1993</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"f"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1994</span> </span><span class="WHIT">			</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"map"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1995</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1996</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"i"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1997</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"j"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>1998</span> </span><span class="WHIT">			</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"audioRecording"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1999</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2000</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"k"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2001</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"r"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2002</span> </span><span class="WHIT">			</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"artwork"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2003</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2004</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"t"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2005</span> </span><span class="WHIT">			</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"manuscript"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2006</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2007</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2008</span> </span><span class="WHIT">			</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"book"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2009</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2010</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2011</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2012</span> </span><span class="WHIT">		</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"book"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2013</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2014</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2015</span> 
<span class='line'>2016</span> </span><span class="COMM">/** 
<span class='line'>2017</span>  * Get the ISBN from a record. The default implementation will do nothing.
<span class='line'>2018</span>  * @param {Marc.Record} record the source record 
<span class='line'>2019</span>  * @param {Zotero.Item} the target item 
<span class='line'>2020</span>  **/</span><span class="WHIT">
<span class='line'>2021</span> </span><span class="NAME">Marc.ImportConverter.prototype._getISBN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2022</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2023</span> 
<span class='line'>2024</span> </span><span class="COMM">/** 
<span class='line'>2025</span>  * Get the ISSN from a record. The default implementation will do nothing.
<span class='line'>2026</span>  * @param {Marc.Record} record the source record 
<span class='line'>2027</span>  * @param {Zotero.Item} the target item 
<span class='line'>2028</span>  **/</span><span class="WHIT">
<span class='line'>2029</span> </span><span class="NAME">Marc.ImportConverter.prototype._getISSN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2030</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2031</span> 
<span class='line'>2032</span> </span><span class="COMM">/** 
<span class='line'>2033</span>  * Get the creators from a record. The default implementation will do nothing.
<span class='line'>2034</span>  * @param {Marc.Record} record the source record 
<span class='line'>2035</span>  * @param {Zotero.Item} the target item 
<span class='line'>2036</span>  **/</span><span class="WHIT">
<span class='line'>2037</span> </span><span class="NAME">Marc.ImportConverter.prototype._getCreators</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2038</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2039</span> 
<span class='line'>2040</span> </span><span class="COMM">/** 
<span class='line'>2041</span>  * Get the title from a record. The default implementation will do nothing.
<span class='line'>2042</span>  * @param {Marc.Record} record the source record 
<span class='line'>2043</span>  * @param {Zotero.Item} the target item 
<span class='line'>2044</span>  **/</span><span class="WHIT">
<span class='line'>2045</span> </span><span class="NAME">Marc.ImportConverter.prototype._getTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2046</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2047</span> 
<span class='line'>2048</span> </span><span class="COMM">/** 
<span class='line'>2049</span>  * Get the language from a record. The default implementation will do nothing.
<span class='line'>2050</span>  * @param {Marc.Record} record the source record 
<span class='line'>2051</span>  * @param {Zotero.Item} the target item 
<span class='line'>2052</span>  **/</span><span class="WHIT">
<span class='line'>2053</span> </span><span class="NAME">Marc.ImportConverter.prototype._getLanguage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2054</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2055</span> 
<span class='line'>2056</span> </span><span class="COMM">/** 
<span class='line'>2057</span>  * Get an abstract from a record. The default implementation will do nothing.
<span class='line'>2058</span>  * @param {Marc.Record} record the source record 
<span class='line'>2059</span>  * @param {Zotero.Item} the target item 
<span class='line'>2060</span>  **/</span><span class="WHIT">
<span class='line'>2061</span> </span><span class="NAME">Marc.ImportConverter.prototype._getAbstract</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2062</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2063</span> 
<span class='line'>2064</span> </span><span class="COMM">/** 
<span class='line'>2065</span>  * Get the edition details (edition statement, place, publisher, date) from a record. 
<span class='line'>2066</span>  * The default implementation will do nothing.
<span class='line'>2067</span>  * @param {Marc.Record} record the source record 
<span class='line'>2068</span>  * @param {Zotero.Item} the target item 
<span class='line'>2069</span>  **/</span><span class="WHIT">
<span class='line'>2070</span> </span><span class="NAME">Marc.ImportConverter.prototype._getEdition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2071</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2072</span> 
<span class='line'>2073</span> </span><span class="COMM">/** 
<span class='line'>2074</span>  * Get tags from a record. The default implementation will do nothing.
<span class='line'>2075</span>  * @param {Marc.Record} record the source record 
<span class='line'>2076</span>  * @param {Zotero.Item} the target item 
<span class='line'>2077</span>  **/</span><span class="WHIT">
<span class='line'>2078</span> </span><span class="NAME">Marc.ImportConverter.prototype._getTags</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2079</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2080</span> 
<span class='line'>2081</span> </span><span class="COMM">/** 
<span class='line'>2082</span>  * Get the material description (e.g. number of pages) from a record. The default implementation will do nothing.
<span class='line'>2083</span>  * @param {Marc.Record} record the source record 
<span class='line'>2084</span>  * @param {Zotero.Item} the target item 
<span class='line'>2085</span>  **/</span><span class="WHIT">
<span class='line'>2086</span> </span><span class="NAME">Marc.ImportConverter.prototype._getMaterialDescription</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2087</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2088</span> 
<span class='line'>2089</span> </span><span class="COMM">/** 
<span class='line'>2090</span>  * Get series information (series name, number) from a record. The default implementation will do nothing.
<span class='line'>2091</span>  * @param {Marc.Record} record the source record 
<span class='line'>2092</span>  * @param {Zotero.Item} the target item 
<span class='line'>2093</span>  **/</span><span class="WHIT">
<span class='line'>2094</span> </span><span class="NAME">Marc.ImportConverter.prototype._getSeries</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2095</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2096</span> 
<span class='line'>2097</span> </span><span class="COMM">/** 
<span class='line'>2098</span>  * Get extra information from a record into the item's extra field. 
<span class='line'>2099</span>  * The default implementation will do nothing.
<span class='line'>2100</span>  * @param {Marc.Record} record the source record 
<span class='line'>2101</span>  * @param {Zotero.Item} the target item 
<span class='line'>2102</span>  **/</span><span class="WHIT">
<span class='line'>2103</span> </span><span class="NAME">Marc.ImportConverter.prototype._getExtra</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2104</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2105</span> 
<span class='line'>2106</span> </span><span class="COMM">/** 
<span class='line'>2107</span>  * Generate notes from a record. The default implementation will create a note
<span class='line'>2108</span>  * containing the serialized MARC record.
<span class='line'>2109</span>  * @param {Marc.Record} record the source record 
<span class='line'>2110</span>  * @param {Zotero.Item} the target item 
<span class='line'>2111</span>  **/</span><span class="WHIT">
<span class='line'>2112</span> </span><span class="NAME">Marc.ImportConverter.prototype._getNotes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2113</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">marcCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.serialize</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fieldDelimiter</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"&lt;/br>"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2114</span> </span><span class="WHIT">	</span><span class="NAME">item.notes.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"MARC code"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">note</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"&lt;pre>"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">marcCode</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"&lt;/pre>"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2115</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2116</span> 
<span class='line'>2117</span> </span><span class="COMM">/** 
<span class='line'>2118</span>  * Get the call number(s) from a record. The default implementation will do nothing.
<span class='line'>2119</span>  * @param {Marc.Record} record the source record 
<span class='line'>2120</span>  * @param {Zotero.Item} the target item 
<span class='line'>2121</span>  **/</span><span class="WHIT">
<span class='line'>2122</span> </span><span class="NAME">Marc.ImportConverter.prototype._getCallNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2123</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2124</span> 
<span class='line'>2125</span> </span><span class="COMM">/** 
<span class='line'>2126</span>  * Generate attachments from a record. The default implementation will do nothing.
<span class='line'>2127</span>  * @param {Marc.Record} record the source record 
<span class='line'>2128</span>  * @param {Zotero.Item} the target item 
<span class='line'>2129</span>  **/</span><span class="WHIT">
<span class='line'>2130</span> </span><span class="NAME">Marc.ImportConverter.prototype._getAttachments</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2131</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2132</span> 
<span class='line'>2133</span> 
<span class='line'>2134</span> </span><span class="COMM">/**
<span class='line'>2135</span>  * Constructs a Marc21 import converter.
<span class='line'>2136</span>  * @class ImportConverter implementation for records in Marc-21 format.
<span class='line'>2137</span>  * @augments Marc.ImportConverter 
<span class='line'>2138</span>  * */</span><span class="WHIT">
<span class='line'>2139</span> </span><span class="NAME">Marc.Marc21ImportConverter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2140</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2141</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.ImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2142</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21ImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2143</span> 
<span class='line'>2144</span> 
<span class='line'>2145</span> </span><span class="COMM">/**
<span class='line'>2146</span>  * General purpose cleaning. Trims heading and trailing .,/;; and whitespace.
<span class='line'>2147</span>  * Collapses double whitespace.
<span class='line'>2148</span>  */</span><span class="WHIT">
<span class='line'>2149</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._clean</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2150</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.replace</span><span class="PUNC">(</span><span class="REGX">/^[\s\.\,\/\:;]+/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2151</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.replace</span><span class="PUNC">(</span><span class="REGX">/[\s\.\,\/\:;]+$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2152</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.replace</span><span class="PUNC">(</span><span class="REGX">/ +/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2153</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2154</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">char1</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2155</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">char2</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">[</span><span class="NAME">value.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2156</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">char1</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"["</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">char2</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"]"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">char1</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"("</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">char2</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2157</span> </span><span class="WHIT">		</span><span class="COMM">// chop of extraneous characters</span><span class="WHIT">
<span class='line'>2158</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value.substr</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2159</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2160</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2161</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2162</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2163</span> 
<span class='line'>2164</span> </span><span class="COMM">/** Get a linked 880 field.
<span class='line'>2165</span>  *  @param {Marc.Record.Field} field 
<span class='line'>2166</span>  *  @returns {Marc.RecordField} 
<span class='line'>2167</span>  */</span><span class="WHIT">
<span class='line'>2168</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getLinkedField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2169</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">link</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"6"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2170</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">link</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">link.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2171</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/(\d{3})-(\d+)/</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">link</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2172</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkData</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2173</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">field.getRecord</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getFields</span><span class="PUNC">(</span><span class="NAME">linkData</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">linkData</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2174</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2175</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2176</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2177</span> 
<span class='line'>2178</span> </span><span class="COMM">/**
<span class='line'>2179</span>  * From a linked field, try to extract script information.
<span class='line'>2180</span>  * @param {Marc.Record.Field} field a linked 880 field
<span class='line'>2181</span>  * @return {String} a IANA script code
<span class='line'>2182</span>  */</span><span class="WHIT">
<span class='line'>2183</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getLinkScript</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2184</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">link</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"6"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2185</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/(\d{3})-(\d+)\/?([^\/]+)?/</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">link</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2186</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkData</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">linkData</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2187</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Scripts</span><span class="PUNC">[</span><span class="NAME">linkData</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">substr</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2188</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2189</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2190</span> 
<span class='line'>2191</span> </span><span class="COMM">/** Number extraction */</span><span class="WHIT">
<span class='line'>2192</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._pullNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2193</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pullRe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[0-9]+/</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2194</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pullRe.exec</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2195</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2196</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2197</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2198</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2199</span> 
<span class='line'>2200</span> </span><span class="COMM">/** ISBN/ISSN extraction. */</span><span class="WHIT">
<span class='line'>2201</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._pullISBN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2202</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pullRe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[0-9X\-]+/</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2203</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pullRe.exec</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2204</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2205</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2206</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2207</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2208</span> 
<span class='line'>2209</span> </span><span class="COMM">/** Language from 008, 35-37. */</span><span class="WHIT">
<span class='line'>2210</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getLanguage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2211</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.FIXED_LENGTH_DATA_ELEMENTS</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2212</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2213</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.substr</span><span class="PUNC">(</span><span class="NUMB">35</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2214</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/[a-z]{3}/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">lang</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2215</span> </span><span class="WHIT">			</span><span class="NAME">item.language</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2216</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2217</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2218</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2219</span> 
<span class='line'>2220</span> 
<span class='line'>2221</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getISBN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2222</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.ISBN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2223</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2224</span> </span><span class="WHIT">		</span><span class="NAME">item.ISBN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._pullISBN</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2225</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2226</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2227</span> 
<span class='line'>2228</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getISSN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2229</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.ISSN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2230</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2231</span> </span><span class="WHIT">		</span><span class="NAME">item.ISSN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._pullISBN</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2232</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2233</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2234</span> 
<span class='line'>2235</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getCreator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2236</span> </span><span class="WHIT">	</span><span class="COMM">//Get names</span><span class="WHIT">
<span class='line'>2237</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">firstName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2238</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2239</span> </span><span class="WHIT">	</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">field.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2240</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_PERSONAL_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2241</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_PERSONAL_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2242</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">field.getIndicator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2243</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"0"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2244</span> </span><span class="WHIT">			</span><span class="NAME">firstName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"ac"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2245</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2246</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"1"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2247</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2248</span> </span><span class="WHIT">			</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.cleanAuthor</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2249</span> </span><span class="WHIT">			</span><span class="NAME">firstName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.firstName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2250</span> </span><span class="WHIT">			</span><span class="NAME">lastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.lastName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2251</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2252</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"3"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2253</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2254</span> </span><span class="WHIT">			</span><span class="NAME">lastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2255</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2256</span> </span><span class="WHIT">		</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2257</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_CORPORATE_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2258</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_MEETING_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2259</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_CORPORATE_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2260</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_MEETING_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2261</span> </span><span class="WHIT">	</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2262</span> </span><span class="WHIT">		</span><span class="NAME">lastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2263</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2264</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2265</span> </span><span class="WHIT">	</span><span class="COMM">//Loop through relators</span><span class="WHIT">
<span class='line'>2266</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">relators</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getSubfields</span><span class="PUNC">(</span><span class="STRN">"e"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2267</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">relators.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2268</span> </span><span class="WHIT">		</span><span class="NAME">relators.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2269</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">relatorCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2270</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.getCreatorType</span><span class="PUNC">(</span><span class="NAME">relatorCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2271</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">creatorType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2272</span> </span><span class="WHIT">				</span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">firstName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">firstName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2273</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2274</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2275</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2276</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2277</span> </span><span class="WHIT">		</span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">firstName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">firstName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2278</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2279</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2280</span> 
<span class='line'>2281</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getCreators</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2282</span> </span><span class="WHIT">	</span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>2283</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_PERSONAL_NAME</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2284</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_CORPORATE_NAME</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2285</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_MEETING_NAME</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2286</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_PERSONAL_NAME</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2287</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_CORPORATE_NAME</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2288</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_MEETING_NAME</span><span class="WHIT">
<span class='line'>2289</span> </span><span class="WHIT">	                 </span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2290</span> </span><span class="WHIT">		</span><span class="NAME">this._getCreator</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2291</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2292</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2293</span> 
<span class='line'>2294</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2295</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.TITLE_STATEMENT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"ab"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2296</span> </span><span class="WHIT">	                 </span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2297</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2298</span> </span><span class="WHIT">		</span><span class="NAME">item.title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2299</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2300</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2301</span> 
<span class='line'>2302</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getEdition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2303</span> </span><span class="WHIT">	</span><span class="COMM">//Extract edition</span><span class="WHIT">
<span class='line'>2304</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.EDITION_STATEMENT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"ab"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2305</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2306</span> </span><span class="WHIT">		</span><span class="NAME">item.edition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2307</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2308</span> 
<span class='line'>2309</span> </span><span class="WHIT">	</span><span class="COMM">// Extract place info</span><span class="WHIT">
<span class='line'>2310</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.PUBLICATION_DISTRIBUTION_ETC_IMPRINT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2311</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2312</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2313</span> </span><span class="WHIT">		</span><span class="NAME">item.place</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2314</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2315</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2316</span> </span><span class="WHIT">	</span><span class="COMM">// Extract publisher/distributor</span><span class="WHIT">
<span class='line'>2317</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.PUBLICATION_DISTRIBUTION_ETC_IMPRINT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2318</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2319</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2320</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"film"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2321</span> </span><span class="WHIT">			</span><span class="NAME">item.distributor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2322</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2323</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2324</span> </span><span class="WHIT">			</span><span class="NAME">item.publisher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2325</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2326</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2327</span> 
<span class='line'>2328</span> </span><span class="WHIT">	</span><span class="COMM">// Extract date</span><span class="WHIT">
<span class='line'>2329</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.PUBLICATION_DISTRIBUTION_ETC_IMPRINT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2330</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2331</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2332</span> </span><span class="WHIT">		</span><span class="NAME">item.date</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._pullNumber</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2333</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2334</span> 
<span class='line'>2335</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2336</span> 
<span class='line'>2337</span> 
<span class='line'>2338</span> </span><span class="COMM">/**
<span class='line'>2339</span>  * Constructs a multilingual Marc-21 import converter.
<span class='line'>2340</span>  * @class ImportConverter implementation for records in Marc-21 format.
<span class='line'>2341</span>  * Makes use of Zotero's multilingual features wherever possible.
<span class='line'>2342</span>  * @augments Marc.ImportConverter 
<span class='line'>2343</span>  * */</span><span class="WHIT">
<span class='line'>2344</span> </span><span class="NAME">Marc.Marc21MultilingualImportConverter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2345</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2346</span> </span><span class="NAME">Marc.Marc21MultilingualImportConverter.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21ImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2347</span> </span><span class="NAME">Marc.Marc21MultilingualImportConverter.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21MultilingualImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2348</span> 
<span class='line'>2349</span> 
<span class='line'>2350</span> </span><span class="NAME">Marc.Marc21ImportConverter.prototype._getCreator</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2351</span> </span><span class="WHIT">	</span><span class="COMM">//Linked items?</span><span class="WHIT">
<span class='line'>2352</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkedField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkedField</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2353</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkedLang</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2354</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2355</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">script</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkScript</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2356</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">script</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2357</span> </span><span class="WHIT">			</span><span class="NAME">linkedLang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.language.split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">script</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2358</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2359</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2360</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2361</span> </span><span class="WHIT">	</span><span class="COMM">//Get names</span><span class="WHIT">
<span class='line'>2362</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">firstName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">linkedFirstName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2363</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">linkedLastName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2364</span> </span><span class="WHIT">	</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">field.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2365</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_PERSONAL_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2366</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_PERSONAL_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2367</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">field.getIndicator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2368</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"0"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2369</span> </span><span class="WHIT">			</span><span class="NAME">firstName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"ac"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2370</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2371</span> </span><span class="WHIT">				</span><span class="NAME">linkedFirstName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"ac"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2372</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2373</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2374</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"1"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2375</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2376</span> </span><span class="WHIT">			</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.cleanAuthor</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2377</span> </span><span class="WHIT">			</span><span class="NAME">firstName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.firstName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2378</span> </span><span class="WHIT">			</span><span class="NAME">lastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.lastName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2379</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2380</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2381</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.cleanAuthor</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2382</span> </span><span class="WHIT">				</span><span class="NAME">linkedFirstName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.firstName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2383</span> </span><span class="WHIT">				</span><span class="NAME">linkedLastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.lastName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2384</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2385</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2386</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"3"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2387</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2388</span> </span><span class="WHIT">			</span><span class="NAME">lastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2389</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2390</span> </span><span class="WHIT">				</span><span class="NAME">linkedLastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2391</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2392</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2393</span> </span><span class="WHIT">		</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2394</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_CORPORATE_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2395</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.MAIN_ENTRY_MEETING_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2396</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_CORPORATE_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2397</span> </span><span class="WHIT">	</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.Tags.ADDED_ENTRY_MEETING_NAME.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2398</span> </span><span class="WHIT">	</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2399</span> </span><span class="WHIT">		</span><span class="NAME">lastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2400</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2401</span> </span><span class="WHIT">			</span><span class="NAME">linkedLastName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2402</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2403</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2404</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2405</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2406</span> </span><span class="WHIT">	</span><span class="COMM">//Loop through relators</span><span class="WHIT">
<span class='line'>2407</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">relators</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getSubfields</span><span class="PUNC">(</span><span class="STRN">"e"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2408</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">relators.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2409</span> </span><span class="WHIT">		</span><span class="NAME">relators.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2410</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">relatorCode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2411</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21.getCreatorType</span><span class="PUNC">(</span><span class="NAME">relatorCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2412</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">creatorType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2413</span> </span><span class="WHIT">				</span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">firstName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">firstName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2414</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2415</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">masterIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.creators.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2416</span> </span><span class="WHIT">					</span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">firstName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">linkedFirstName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2417</span> </span><span class="WHIT">						</span><span class="NAME">lastName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">linkedLastName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2418</span> </span><span class="WHIT">						</span><span class="NAME">creatorType</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2419</span> </span><span class="WHIT">						</span><span class="NAME">servantLang</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">linkedLang</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2420</span> </span><span class="WHIT">						</span><span class="NAME">masterIndex</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">masterIndex</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2421</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2422</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2423</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2424</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2425</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2426</span> </span><span class="WHIT">		</span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">firstName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">firstName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">lastName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">creatorType</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2427</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2428</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">masterIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.creators.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2429</span> </span><span class="WHIT">			</span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">firstName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">linkedFirstName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2430</span> </span><span class="WHIT">				</span><span class="NAME">lastName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">linkedLastName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2431</span> </span><span class="WHIT">				</span><span class="NAME">creatorType</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2432</span> </span><span class="WHIT">				</span><span class="NAME">servantLang</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">linkedLang</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2433</span> </span><span class="WHIT">				</span><span class="NAME">masterIndex</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">masterIndex</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2434</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2435</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2436</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2437</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2438</span> 
<span class='line'>2439</span> 
<span class='line'>2440</span> </span><span class="NAME">Marc.Marc21MultilingualImportConverter.prototype._getEdition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2441</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">titleFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.EDITION_STATEMENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2442</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2443</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parallelTitles</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2444</span> </span><span class="WHIT">	</span><span class="NAME">titleFields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2445</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">titleField.getValue</span><span class="PUNC">(</span><span class="STRN">"ab"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2446</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2447</span> </span><span class="WHIT">			</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2448</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2449</span> </span><span class="WHIT">		</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2450</span> </span><span class="WHIT">		</span><span class="COMM">//Check for linked field</span><span class="WHIT">
<span class='line'>2451</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkedField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkedField</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2452</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2453</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">script</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkScript</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2454</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">script</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2455</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"ab"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2456</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.language.split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">script</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2457</span> </span><span class="WHIT">				</span><span class="NAME">parallelTitles.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2458</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2459</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2460</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2461</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2462</span> </span><span class="WHIT">		</span><span class="NAME">item.edition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baseTitle</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2463</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2464</span> </span><span class="WHIT">	</span><span class="NAME">parallelTitles.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2465</span> </span><span class="WHIT">		</span><span class="NAME">this._setMultiField</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"edition"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2466</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2467</span> 
<span class='line'>2468</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2469</span> </span><span class="WHIT">	</span><span class="COMM">// Extract place info</span><span class="WHIT">
<span class='line'>2470</span> </span><span class="WHIT">	</span><span class="NAME">titleFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.PUBLICATION_DISTRIBUTION_ETC_IMPRINT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2471</span> </span><span class="WHIT">	</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2472</span> </span><span class="WHIT">	</span><span class="NAME">parallelTitles</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2473</span> </span><span class="WHIT">	</span><span class="NAME">titleFields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2474</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">titleField.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2475</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2476</span> </span><span class="WHIT">			</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2477</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2478</span> </span><span class="WHIT">		</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2479</span> </span><span class="WHIT">		</span><span class="COMM">//Check for linked field</span><span class="WHIT">
<span class='line'>2480</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkedField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkedField</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2481</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2482</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">script</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkScript</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2483</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">script</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2484</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2485</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.language.split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">script</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2486</span> </span><span class="WHIT">				</span><span class="NAME">parallelTitles.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2487</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2488</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2489</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2490</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2491</span> </span><span class="WHIT">		</span><span class="NAME">item.place</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baseTitle</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2492</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2493</span> </span><span class="WHIT">	</span><span class="NAME">parallelTitles.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2494</span> </span><span class="WHIT">		</span><span class="NAME">this._setMultiField</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"place"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2495</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2496</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2497</span> </span><span class="WHIT">	</span><span class="COMM">// Extract publisher/distributor</span><span class="WHIT">
<span class='line'>2498</span> </span><span class="WHIT">	</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2499</span> </span><span class="WHIT">	</span><span class="NAME">parallelTitles</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2500</span> </span><span class="WHIT">	</span><span class="NAME">titleFields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2501</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">titleField.getValue</span><span class="PUNC">(</span><span class="STRN">"b"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2502</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2503</span> </span><span class="WHIT">			</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2504</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2505</span> </span><span class="WHIT">		</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2506</span> </span><span class="WHIT">		</span><span class="COMM">//Check for linked field</span><span class="WHIT">
<span class='line'>2507</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkedField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkedField</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2508</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2509</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">script</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkScript</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2510</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">script</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2511</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"b"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2512</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.language.split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">script</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2513</span> </span><span class="WHIT">				</span><span class="NAME">parallelTitles.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2514</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2515</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2516</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2517</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2518</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"film"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2519</span> </span><span class="WHIT">			</span><span class="NAME">item.distributor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">baseTitle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2520</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2521</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2522</span> </span><span class="WHIT">			</span><span class="NAME">item.publisher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">baseTitle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2523</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2524</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2525</span> </span><span class="WHIT">	</span><span class="NAME">parallelTitles.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2526</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"film"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2527</span> </span><span class="WHIT">			</span><span class="NAME">this._setMultiField</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"distributor"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2528</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2529</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2530</span> </span><span class="WHIT">			</span><span class="NAME">this._setMultiField</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"publisher"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2531</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2532</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2533</span> 
<span class='line'>2534</span> </span><span class="WHIT">	</span><span class="COMM">// Extract date</span><span class="WHIT">
<span class='line'>2535</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.PUBLICATION_DISTRIBUTION_ETC_IMPRINT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2536</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2537</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2538</span> </span><span class="WHIT">		</span><span class="NAME">item.date</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._pullNumber</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2539</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2540</span> 
<span class='line'>2541</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2542</span> 
<span class='line'>2543</span> 
<span class='line'>2544</span> </span><span class="NAME">Marc.Marc21MultilingualImportConverter.prototype._getTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2545</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">titleFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">Marc.Marc21.Tags.TITLE_STATEMENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2546</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2547</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parallelTitles</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2548</span> </span><span class="WHIT">	</span><span class="NAME">titleFields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2549</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">titleField.getValue</span><span class="PUNC">(</span><span class="STRN">"ab"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2550</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2551</span> </span><span class="WHIT">			</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2552</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2553</span> </span><span class="WHIT">		</span><span class="NAME">baseTitle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2554</span> </span><span class="WHIT">		</span><span class="COMM">//Check for linked field</span><span class="WHIT">
<span class='line'>2555</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">linkedField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkedField</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2556</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2557</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">script</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._getLinkScript</span><span class="PUNC">(</span><span class="NAME">linkedField</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2558</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">script</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2559</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._clean</span><span class="PUNC">(</span><span class="NAME">linkedField.getValue</span><span class="PUNC">(</span><span class="STRN">"ab"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2560</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.language.split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">script</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2561</span> </span><span class="WHIT">				</span><span class="NAME">parallelTitles.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2562</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2563</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2564</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2565</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">baseTitle.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2566</span> </span><span class="WHIT">		</span><span class="NAME">item.title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baseTitle</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2567</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2568</span> </span><span class="WHIT">	</span><span class="NAME">parallelTitles.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2569</span> </span><span class="WHIT">		</span><span class="NAME">this._setMultiField</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2570</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2571</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2572</span> 
<span class='line'>2573</span> 
<span class='line'>2574</span> 
<span class='line'>2575</span> </span><span class="COMM">/**
<span class='line'>2576</span>  * Constructs a Unimarc import converter.
<span class='line'>2577</span>  * @class ImportConverter implementation for records in Unimarc format.
<span class='line'>2578</span>  * @augments Marc.ImportConverter 
<span class='line'>2579</span>  * */</span><span class="WHIT">
<span class='line'>2580</span> </span><span class="NAME">Marc.UnimarcImportConverter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2581</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2582</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.ImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2583</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2584</span> 
<span class='line'>2585</span> </span><span class="COMM">/**
<span class='line'>2586</span>  * Set the item's itemType. Extends the base class implementation by adding
<span class='line'>2587</span>  * support for manusripts (record type 'b') and thesis. 
<span class='line'>2588</span>  **/</span><span class="WHIT">
<span class='line'>2589</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getItemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2590</span> </span><span class="WHIT">	</span><span class="NAME">Marc.ImportConverter.prototype._getItemType.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2591</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getLeader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2592</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">leader</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2593</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">leader.getRecordType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2594</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"b"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2595</span> </span><span class="WHIT">			</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"manuscript"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2596</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2597</span> </span><span class="COMM">//		//Bibliograhical level (TODO: any good?)</span><span class="WHIT">
<span class='line'>2598</span> </span><span class="COMM">//		switch(leader.getImplementationCodes()[0]) {</span><span class="WHIT">
<span class='line'>2599</span> </span><span class="COMM">//		case "a": 	//analytic</span><span class="WHIT">
<span class='line'>2600</span> </span><span class="COMM">//			if(itemType == "book") {</span><span class="WHIT">
<span class='line'>2601</span> </span><span class="COMM">//				item.itemType = "article";</span><span class="WHIT">
<span class='line'>2602</span> </span><span class="COMM">//			}</span><span class="WHIT">
<span class='line'>2603</span> </span><span class="COMM">//		}</span><span class="WHIT">
<span class='line'>2604</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2605</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2606</span> </span><span class="WHIT">	</span><span class="COMM">//Thesis?</span><span class="WHIT">
<span class='line'>2607</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">record.hasField</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.DISSERTATION_THESIS_NOTE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2608</span> </span><span class="WHIT">		</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"thesis"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2609</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2610</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2611</span> 
<span class='line'>2612</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getISBN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2613</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.ISBN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2614</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2615</span> </span><span class="WHIT">		</span><span class="NAME">item.ISBN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2616</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2617</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2618</span> 
<span class='line'>2619</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getISSN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2620</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.ISSN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2621</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2622</span> </span><span class="WHIT">		</span><span class="NAME">item.ISSN</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2623</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2624</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2625</span> 
<span class='line'>2626</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getCreators</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2627</span> </span><span class="WHIT">	</span><span class="COMM">//Clear creators</span><span class="WHIT">
<span class='line'>2628</span> </span><span class="WHIT">	</span><span class="NAME">item.creators</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2629</span> </span><span class="WHIT">	</span><span class="COMM">// Extract creators (700, 701 & 702)</span><span class="WHIT">
<span class='line'>2630</span> </span><span class="WHIT">	</span><span class="PUNC">[</span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_PRIMARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2631</span> </span><span class="WHIT">	 </span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_ALTERNATIVE_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2632</span> </span><span class="WHIT">	 </span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_SECONDARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2633</span> </span><span class="WHIT">		 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">authorFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2634</span> </span><span class="WHIT">		 </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">authorFields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2635</span> </span><span class="WHIT">			 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">authorField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">authorFields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2636</span> </span><span class="WHIT">			 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.getCreatorType</span><span class="PUNC">(</span><span class="NAME">authorField.getValue</span><span class="PUNC">(</span><span class="STRN">"4"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2637</span> </span><span class="WHIT">			 </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2638</span> </span><span class="WHIT">				 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">authorText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">authorField.getValue</span><span class="PUNC">(</span><span class="STRN">"ab"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2639</span> </span><span class="WHIT">				 </span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="NAME">Zotero.Utilities.cleanAuthor</span><span class="PUNC">(</span><span class="NAME">authorText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2640</span> </span><span class="WHIT">			 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2641</span> </span><span class="WHIT">		 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2642</span> </span><span class="WHIT">	 </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2643</span> </span><span class="WHIT">	</span><span class="COMM">// Extract corporate creators (710, 711 & 712)</span><span class="WHIT">
<span class='line'>2644</span> </span><span class="WHIT">	</span><span class="PUNC">[</span><span class="NAME">Marc.Unimarc.Tags.CORPORATE_BODY_NAME_PRIMARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2645</span> </span><span class="WHIT">	 </span><span class="NAME">Marc.Unimarc.Tags.CORPORATE_BODY_NAME_ALTERNATIVE_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2646</span> </span><span class="WHIT">	 </span><span class="NAME">Marc.Unimarc.Tags.CORPORATE_BODY_NAME_SECONDARY_INTELLECTUAL_RESPONSIBILITY</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2647</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">authorFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2648</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">authorFields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2649</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">authorField</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">authorFields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2650</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.getCreatorType</span><span class="PUNC">(</span><span class="NAME">authorField.getValue</span><span class="PUNC">(</span><span class="STRN">"4"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2651</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2652</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">authorText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">authorField.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2653</span> </span><span class="WHIT">				</span><span class="NAME">item.creators.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2654</span> </span><span class="WHIT">					</span><span class="NAME">lastName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">authorText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2655</span> </span><span class="WHIT">					</span><span class="NAME">creatorType</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2656</span> </span><span class="WHIT">					</span><span class="NAME">fieldMode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2657</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2658</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2659</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2660</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2661</span> 
<span class='line'>2662</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2663</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"ae"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2664</span> </span><span class="WHIT">		</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2665</span> </span><span class="WHIT">			</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" : "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2666</span> </span><span class="WHIT">			</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2667</span> </span><span class="WHIT">			</span><span class="NAME">processSubfield</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2668</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">item.shortTitle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2669</span> </span><span class="WHIT">					</span><span class="NAME">item.shortTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2670</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2671</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">subfield.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2672</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2673</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2674</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2675</span> </span><span class="WHIT">		</span><span class="NAME">item.title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2676</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2677</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2678</span> 
<span class='line'>2679</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getLanguage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2680</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.LANGUAGE_OF_THE_ITEM</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2681</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2682</span> </span><span class="WHIT">		</span><span class="NAME">item.language</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2683</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2684</span> </span><span class="WHIT">	</span><span class="COMM">//Original language?</span><span class="WHIT">
<span class='line'>2685</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.LANGUAGE_OF_THE_ITEM</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"c"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2686</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2687</span> </span><span class="WHIT">		</span><span class="NAME">item.notes.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">note</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Original language: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2688</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2689</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2690</span> 
<span class='line'>2691</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getCountry</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2692</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.COUNTRY_OF_PUBLICATION_OR_PRODUCTION</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2693</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2694</span> </span><span class="WHIT">		</span><span class="NAME">item.country</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2695</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2696</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2697</span> 
<span class='line'>2698</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getCallNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2699</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2700</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.DEWEY_DECIMAL_CLASSIFICATION_DD</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2701</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2702</span> </span><span class="WHIT">		</span><span class="NAME">text.push</span><span class="PUNC">(</span><span class="STRN">"Dewey: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2703</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2704</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.UNIVERSAL_DECIMAL_CLASSIFICATION_UD</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2705</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2706</span> </span><span class="WHIT">		</span><span class="NAME">text.push</span><span class="PUNC">(</span><span class="STRN">"UDC: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2707</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2708</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.LIBRARY_OF_CONGRESS_CLASSIFICATION</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2709</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2710</span> </span><span class="WHIT">		</span><span class="NAME">text.push</span><span class="PUNC">(</span><span class="STRN">"LCC: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2711</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2712</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.UNIVERSAL_DECIMAL_CLASSIFICATION_UD</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2713</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2714</span> </span><span class="WHIT">		</span><span class="NAME">text.push</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2715</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2716</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">text.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2717</span> </span><span class="WHIT">		</span><span class="NAME">item.callNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text.join</span><span class="PUNC">(</span><span class="STRN">";"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2718</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2719</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2720</span> 
<span class='line'>2721</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getAbstract</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2722</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">Marc.Unimarc.Tags.DISSERTATION_THESIS_NOTE</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2723</span> </span><span class="WHIT">	                             </span><span class="NAME">Marc.Unimarc.Tags.SUMMARY_OR_ABSTRACT</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2724</span> </span><span class="WHIT">	                             </span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2725</span> </span><span class="WHIT">	                             </span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"\n"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2726</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2727</span> </span><span class="WHIT">		</span><span class="NAME">item.abstractNote</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2728</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2729</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2730</span> 
<span class='line'>2731</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getEdition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2732</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.EDITION_STATEMENT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"ab"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2733</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2734</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2735</span> </span><span class="WHIT">		</span><span class="NAME">item.edition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2736</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2737</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PUBLICATION_DISTRIBUTION_ETC</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2738</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2739</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2740</span> </span><span class="WHIT">		</span><span class="NAME">item.place</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2741</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2742</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PUBLICATION_DISTRIBUTION_ETC</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2743</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2744</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2745</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"film"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2746</span> </span><span class="WHIT">			</span><span class="NAME">item.distributor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2747</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2748</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2749</span> </span><span class="WHIT">			</span><span class="NAME">item.publisher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2750</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2751</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2752</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PUBLICATION_DISTRIBUTION_ETC</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"d"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2753</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">suppressDuplicates</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2754</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2755</span> </span><span class="WHIT">		</span><span class="NAME">item.date</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2756</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2757</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2758</span> 
<span class='line'>2759</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getMaterialDescription</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2760</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PHYSICAL_DESCRIPTION</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2761</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2762</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pages</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[^\d]*(\d+)\s+p\..*/</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2763</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">pages</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2764</span> </span><span class="WHIT">			</span><span class="NAME">item.numPages</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pages</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2765</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2766</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">vols</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[^\d]*(\d+)\s+vol\..*/</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2767</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">vols</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2768</span> </span><span class="WHIT">			</span><span class="NAME">item.numberOfVolumes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">vols</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2769</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2770</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2771</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2772</span> 
<span class='line'>2773</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getSeries</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2774</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">seriesText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2775</span> </span><span class="WHIT">	</span><span class="COMM">//Get series tag 225</span><span class="WHIT">
<span class='line'>2776</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">seriesFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2777</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">seriesFields.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2778</span> </span><span class="WHIT">		</span><span class="COMM">//Multiple series fields: no seriesNumber, inline volume numbers</span><span class="WHIT">
<span class='line'>2779</span> </span><span class="WHIT">		</span><span class="NAME">item.series</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2780</span> </span><span class="WHIT">			</span><span class="STRN">"av"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"; "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2781</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2782</span> </span><span class="WHIT">	</span><span class="COMM">//Single series field</span><span class="WHIT">
<span class='line'>2783</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2784</span> </span><span class="WHIT">		</span><span class="NAME">item.series</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2785</span> </span><span class="WHIT">			</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2786</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2787</span> </span><span class="WHIT">			</span><span class="STRN">"v"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2788</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2789</span> </span><span class="WHIT">			</span><span class="NAME">item.seriesNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2790</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2791</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2792</span> </span><span class="WHIT">	</span><span class="COMM">//Try 410 (collection link)</span><span class="WHIT">
<span class='line'>2793</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">item.series</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2794</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">seriesFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES_LINK</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2795</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">seriesFields.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2796</span> </span><span class="WHIT">			</span><span class="COMM">//Multiple series fields: no seriesNumber, inline volume numbers</span><span class="WHIT">
<span class='line'>2797</span> </span><span class="WHIT">			</span><span class="NAME">item.series</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES_LINK</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2798</span> </span><span class="WHIT">				</span><span class="STRN">"tv"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"; "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2799</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2800</span> </span><span class="WHIT">		</span><span class="COMM">//Single series field</span><span class="WHIT">
<span class='line'>2801</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2802</span> </span><span class="WHIT">			</span><span class="NAME">item.series</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES_LINK</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2803</span> </span><span class="WHIT">				</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2804</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SERIES_LINK</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2805</span> </span><span class="WHIT">				</span><span class="STRN">"v"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2806</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2807</span> </span><span class="WHIT">				</span><span class="NAME">item.seriesNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2808</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2809</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2810</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2811</span> </span><span class="WHIT">	</span><span class="COMM">//Try 461 (set link)</span><span class="WHIT">
<span class='line'>2812</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">item.series</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2813</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">seriesFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SET</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2814</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">seriesFields.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2815</span> </span><span class="WHIT">			</span><span class="COMM">//Multiple series fields: no seriesNumber, inline volume numbers</span><span class="WHIT">
<span class='line'>2816</span> </span><span class="WHIT">			</span><span class="NAME">item.series</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SET</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2817</span> </span><span class="WHIT">				</span><span class="STRN">"tv"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"; "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2818</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2819</span> </span><span class="WHIT">		</span><span class="COMM">//Single series field</span><span class="WHIT">
<span class='line'>2820</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2821</span> </span><span class="WHIT">			</span><span class="NAME">item.series</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SET</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2822</span> </span><span class="WHIT">				</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2823</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.SET</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2824</span> </span><span class="WHIT">				</span><span class="STRN">"v"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2825</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2826</span> </span><span class="WHIT">				</span><span class="NAME">item.seriesNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2827</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2828</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2829</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2830</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2831</span> 
<span class='line'>2832</span> 
<span class='line'>2833</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getTags</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2834</span> 
<span class='line'>2835</span> </span><span class="WHIT">	</span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_USED_AS_SUBJECT</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2836</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.CORPORATE_BODY_NAME_USED_AS_SUBJECT</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2837</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.FAMILY_NAME_USED_AS_SUBJECT</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2838</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.NAME_AND_TITLE_USED_AS_SUBJECT</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2839</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.TITLE_USED_AS_SUBJECT</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2840</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.TOPICAL_NAME_USED_AS_SUBJECT</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2841</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.GEOGRAPHICAL_NAME_USED_AS_SUBJECT</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2842</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.FORM_GENRE_OR_PHYSICAL_CHARACTERISTICS_HEADING</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2843</span> </span><span class="WHIT">	                  </span><span class="NAME">Marc.Unimarc.Tags.UNCONTROLLED_SUBJECT_TERMS</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2844</span> </span><span class="WHIT">         </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tagText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2845</span> </span><span class="WHIT">         </span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">field.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2846</span> </span><span class="WHIT">         </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.PERSONAL_NAME_USED_AS_SUBJECT.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2847</span> </span><span class="WHIT">         </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.FAMILY_NAME_USED_AS_SUBJECT.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2848</span> </span><span class="WHIT">         </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.NAME_AND_TITLE_USED_AS_SUBJECT.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2849</span> </span><span class="WHIT">        	 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"b"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//First name</span><span class="WHIT">
<span class='line'>2850</span> </span><span class="WHIT">        	 </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2851</span> </span><span class="WHIT">        		 </span><span class="NAME">tagText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2852</span> </span><span class="WHIT">        	 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2853</span> </span><span class="WHIT">        	 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"f"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Dates</span><span class="WHIT">
<span class='line'>2854</span> </span><span class="WHIT">        	 </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2855</span> </span><span class="WHIT">        		 </span><span class="NAME">tagText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" ("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">")"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2856</span> </span><span class="WHIT">        	 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2857</span> </span><span class="WHIT">        	 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"t"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Title</span><span class="WHIT">
<span class='line'>2858</span> </span><span class="WHIT">        	 </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2859</span> </span><span class="WHIT">        		 </span><span class="NAME">tagText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2860</span> </span><span class="WHIT">        	 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2861</span> </span><span class="WHIT">        	 </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2862</span> </span><span class="WHIT">         </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.TOPICAL_NAME_USED_AS_SUBJECT.tag</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>2863</span> </span><span class="WHIT">        	 </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getValue</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">//Subheadings</span><span class="WHIT">
<span class='line'>2864</span> </span><span class="WHIT">        			 </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2865</span> </span><span class="WHIT">        		 		</span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" - "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2866</span> </span><span class="WHIT">        		 		</span><span class="NAME">processSubfield</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">subfield</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Zotero.Utilities.trim</span><span class="PUNC">(</span><span class="NAME">subfield.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2867</span> </span><span class="WHIT">        			 </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2868</span> </span><span class="WHIT">        	 </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2869</span> </span><span class="WHIT">        		 </span><span class="NAME">tagText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2870</span> </span><span class="WHIT">        	 </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2871</span> </span><span class="WHIT">        	 </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2872</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2873</span> </span><span class="WHIT">         </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tagText.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2874</span> </span><span class="WHIT">        	 </span><span class="NAME">this._addTag</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tagText</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2875</span> </span><span class="WHIT">         </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2876</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2877</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2878</span> 
<span class='line'>2879</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getExtra</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2880</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2881</span> </span><span class="WHIT">	</span><span class="COMM">//Material description</span><span class="WHIT">
<span class='line'>2882</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.PHYSICAL_DESCRIPTION</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"acde"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2883</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">". "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2884</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2885</span> </span><span class="WHIT">		</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._addExtra</span><span class="PUNC">(</span><span class="NAME">noteText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2886</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2887</span> </span><span class="WHIT">	</span><span class="COMM">//Note</span><span class="WHIT">
<span class='line'>2888</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">Marc.Unimarc.Tags.GENERAL_NOTE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2889</span> </span><span class="WHIT">	                             </span><span class="NAME">Marc.Unimarc.Tags.NOTES_PERTAINING_TO_EDITION_AND_BIBLIOGRAPHIC_HISTORY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2890</span> </span><span class="WHIT">	                             </span><span class="NAME">Marc.Unimarc.Tags.INTERNAL_BIBLIOGRAPHIES_INDEXES_NOTE</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2891</span> </span><span class="WHIT">	                             </span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2892</span> </span><span class="WHIT">	                             </span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">". "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2893</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2894</span> </span><span class="WHIT">		</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._addExtra</span><span class="PUNC">(</span><span class="NAME">noteText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2895</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2896</span> </span><span class="WHIT">	</span><span class="COMM">//Original text</span><span class="WHIT">
<span class='line'>2897</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.TRANSLATION_OF</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2898</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" : "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2899</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2900</span> </span><span class="WHIT">		</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._addExtra</span><span class="PUNC">(</span><span class="NAME">noteText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"Original title: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2901</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2902</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='line'>2903</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">noteText</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2904</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="REGX">/\.$/</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">noteText</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2905</span> </span><span class="WHIT">        	</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2906</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2907</span> </span><span class="WHIT">		</span><span class="NAME">noteText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">noteText.replace</span><span class="PUNC">(</span><span class="REGX">/^\s*\.\s*/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2908</span> </span><span class="WHIT">			</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\.\.+/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2909</span> </span><span class="WHIT">		</span><span class="NAME">item.extra</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">noteText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2910</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2911</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2912</span> 
<span class='line'>2913</span> </span><span class="NAME">Marc.UnimarcImportConverter.prototype._getNotes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2914</span> </span><span class="WHIT">	</span><span class="NAME">Marc.ImportConverter.prototype._getNotes.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2915</span> </span><span class="WHIT">	</span><span class="COMM">//Note the primary statements of responsability for book without "proper" authors,</span><span class="WHIT">
<span class='line'>2916</span> </span><span class="WHIT">	</span><span class="COMM">// the secondary statements of responsability for all cases</span><span class="WHIT">
<span class='line'>2917</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"fg"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2918</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.itemType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"book"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2919</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">item.creators</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2920</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">item.creators</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">creatorType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"author"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2921</span> </span><span class="WHIT">				</span><span class="NAME">subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"g"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2922</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2923</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2924</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2925</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2926</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2927</span> </span><span class="WHIT">				</span><span class="NAME">subfields</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2928</span> </span><span class="WHIT">				</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"; "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2929</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2930</span> </span><span class="WHIT">		</span><span class="NAME">item.notes.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">note</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2931</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2932</span> 
<span class='line'>2933</span> </span><span class="WHIT">	</span><span class="COMM">//Cover title</span><span class="WHIT">
<span class='line'>2934</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.COVER_TITLE</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2935</span> </span><span class="WHIT">			</span><span class="STRN">"ae"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2936</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"; "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2937</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2938</span> </span><span class="WHIT">		</span><span class="NAME">item.notes.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">note</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Cover title: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2939</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2940</span> </span><span class="WHIT">	</span><span class="COMM">//Contents</span><span class="WHIT">
<span class='line'>2941</span> </span><span class="WHIT">	</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getValue</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.Tags.CONTENTS_NOTE</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2942</span> </span><span class="WHIT">			</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2943</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="NAME">fieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">" / "</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">subfieldJoin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"; "</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2944</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2945</span> </span><span class="WHIT">		</span><span class="NAME">item.notes.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">note</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"Contents: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2946</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2947</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2948</span> 
<span class='line'>2949</span> 
<span class='line'>2950</span> </span><span class="COMM">/**
<span class='line'>2951</span>  * Constructs a multilingual Unimarc import converter.
<span class='line'>2952</span>  * @class ImportConverter implementation for records in Unimarc format.
<span class='line'>2953</span>  * Makes use of Zotero's multilingual features wherever possible.
<span class='line'>2954</span>  * @augments Marc.ImportConverter 
<span class='line'>2955</span>  * */</span><span class="WHIT">
<span class='line'>2956</span> </span><span class="NAME">Marc.UnimarcMultilingualImportConverter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2957</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2958</span> </span><span class="NAME">Marc.UnimarcMultilingualImportConverter.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2959</span> </span><span class="NAME">Marc.UnimarcMultilingualImportConverter.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcMultilingualImportConverter</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2960</span> 
<span class='line'>2961</span> </span><span class="COMM">//Marc.UnimarcMultilingualImportConverter.prototype._getLanguage = function(record, item) {</span><span class="WHIT">
<span class='line'>2962</span> </span><span class="COMM">//	var value = record.getValue(Marc.Unimarc.Tags.LANGUAGE_OF_THE_ITEM, "a");</span><span class="WHIT">
<span class='line'>2963</span> </span><span class="COMM">//	if(value) {</span><span class="WHIT">
<span class='line'>2964</span> </span><span class="COMM">//		item.language = value.split(" ")[0];</span><span class="WHIT">
<span class='line'>2965</span> </span><span class="COMM">//	}</span><span class="WHIT">
<span class='line'>2966</span> </span><span class="COMM">//	//Original language?</span><span class="WHIT">
<span class='line'>2967</span> </span><span class="COMM">//	value = record.getValue(Marc.Unimarc.Tags.LANGUAGE_OF_THE_ITEM, "c");</span><span class="WHIT">
<span class='line'>2968</span> </span><span class="COMM">//	if(value) {</span><span class="WHIT">
<span class='line'>2969</span> </span><span class="COMM">//		item.notes.push({note: "Original language: " + value});</span><span class="WHIT">
<span class='line'>2970</span> </span><span class="COMM">//	}</span><span class="WHIT">
<span class='line'>2971</span> </span><span class="COMM">//};</span><span class="WHIT">
<span class='line'>2972</span> 
<span class='line'>2973</span> 
<span class='line'>2974</span> </span><span class="COMM">/**
<span class='line'>2975</span>  * Get multilingual titles. Handles three cases: &lt;ul>
<span class='line'>2976</span>  * &lt;li>$d-subfields in field 200, with subsequent $z subfields containing the langugae code&lt;/li>
<span class='line'>2977</span>  * &lt;li>510 fields containing parallel titles, with $z subfields containing the langugae code.
<span class='line'>2978</span>  * When $z is missing, assume the calaging language.&lt;/li>
<span class='line'>2979</span>  * &lt;li>Multiple 200 fields with $7 subfields holding a script identifier. The item's
<span class='line'>2980</span>  * main language is assumed to be the title's language.&lt;/li>
<span class='line'>2981</span>  * &lt;/ul> 
<span class='line'>2982</span>  */</span><span class="WHIT">
<span class='line'>2983</span> </span><span class="NAME">Marc.UnimarcMultilingualImportConverter.prototype._getTitle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2984</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">script</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2985</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">defLang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">item.language.split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2986</span> </span><span class="WHIT">	</span><span class="COMM">//Commit and reset</span><span class="WHIT">
<span class='line'>2987</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">commit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2988</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2989</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">script</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2990</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">defLang</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2991</span> </span><span class="WHIT">				</span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">script</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2992</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2993</span> </span><span class="WHIT">			</span><span class="NAME">this._setMultiField</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2994</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2995</span> </span><span class="WHIT">		</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2996</span> </span><span class="WHIT">		</span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2997</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2998</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">titleFields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getFields</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>2999</span> </span><span class="WHIT">	       </span><span class="NAME">Marc.Unimarc.Tags.TITLE_AND_STATEMENT_OF_RESPONSIBILITY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3000</span> </span><span class="WHIT">	       </span><span class="NAME">Marc.Unimarc.Tags.PARALLEL_TITLE_PROPER</span><span class="WHIT">
<span class='line'>3001</span> </span><span class="WHIT">	</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3002</span> </span><span class="WHIT">	</span><span class="COMM">//BnF has multiple 200 entries for different scripts (http://www.bnf.fr/documents/UNIMARC%28B%29_conversion.pdf)</span><span class="WHIT">
<span class='line'>3003</span> </span><span class="WHIT">	</span><span class="NAME">titleFields.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">titleField</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3004</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">titleField.getSubfields</span><span class="PUNC">(</span><span class="STRN">"adez"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Main, parallel, subtitle, parallel lang</span><span class="WHIT">
<span class='line'>3005</span> </span><span class="WHIT">		</span><span class="NAME">script</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Scripts</span><span class="PUNC">[</span><span class="NAME">titleField.getValue</span><span class="PUNC">(</span><span class="STRN">"7"</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3006</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3007</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subfield</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfields</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3008</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">content</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subfield.getContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3009</span> </span><span class="WHIT">			</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">subfield.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3010</span> </span><span class="WHIT">			</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"a"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3011</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">;</span><span class="WHIT">			</span><span class="COMM">//Initialize new title</span><span class="WHIT">
<span class='line'>3012</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3013</span> </span><span class="WHIT">			</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"e"</span><span class="PUNC">:</span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3014</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">" : "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">;</span><span class="WHIT">	</span><span class="COMM">//add to title</span><span class="WHIT">
<span class='line'>3015</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3016</span> </span><span class="WHIT">			</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"d"</span><span class="PUNC">:</span><span class="WHIT">						</span><span class="COMM">//Start parallel title</span><span class="WHIT">
<span class='line'>3017</span> </span><span class="WHIT">				</span><span class="NAME">commit.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3018</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3019</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3020</span> </span><span class="WHIT">			</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"z"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3021</span> </span><span class="WHIT">				</span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">content</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3022</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3023</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3024</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3025</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">titleField.getTag</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">Marc.Unimarc.Tags.PARALLEL_TITLE_PROPER.tag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3026</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3027</span> </span><span class="WHIT">				</span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.getCatalogLanguage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3028</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3029</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">lang</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3030</span> </span><span class="WHIT">				</span><span class="NAME">commit.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3031</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3032</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3033</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3034</span> </span><span class="WHIT">			</span><span class="NAME">commit.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3035</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3036</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3037</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3038</span> 
<span class='line'>3039</span> 
<span class='line'>3040</span> </span><span class="COMM">/**
<span class='line'>3041</span>  * @namespace Import/ExportConverters utilities. */</span><span class="WHIT">
<span class='line'>3042</span> </span><span class="NAME">Marc.Converters</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3043</span> </span><span class="WHIT">	</span><span class="COMM">/** Check whether this Zotero environment is multilingual.
<span class='line'>3044</span> 	 * @returns {Boolean}
<span class='line'>3045</span> 	 * */</span><span class="WHIT">
<span class='line'>3046</span> </span><span class="WHIT">	</span><span class="NAME">_isMultilingual</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3047</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"undefined"</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Zotero.Item</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multi</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3048</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3049</span> </span><span class="WHIT">	</span><span class="COMM">/** Get an appropriate ExpoortConverter for a given Marc type.
<span class='line'>3050</span> 	 * @returns {Marc.ExportConverter}
<span class='line'>3051</span> 	 * @param {String} type the Marc type ("unimarc" or "marc21")
<span class='line'>3052</span> 	 */</span><span class="WHIT">
<span class='line'>3053</span> </span><span class="WHIT">	</span><span class="NAME">getExportConverter</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3054</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3055</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"unimarc"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3056</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcExportConverter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3057</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"marc21"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3058</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3059</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.ExportConverter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3060</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3061</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3062</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3063</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3064</span> 	 * For given type and/or record, instantiate the appropriate import converter.
<span class='line'>3065</span> 	 * @param {String|Marc.Record} recordOrType the Marc type ("unimarc" or "marc21") or a record to
<span class='line'>3066</span> 	 * be converted. In the latter case, the Marc type will be auto-detected from the
<span class='line'>3067</span> 	 * record's fields.
<span class='line'>3068</span> 	 * @returns {Marc.ImportConverter}
<span class='line'>3069</span> 	 */</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3070</span> </span><span class="WHIT">	</span><span class="NAME">getImportConverter</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">recordOrType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3071</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"marc21"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3072</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">recordOrType</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Marc.Record</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3073</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Marc.Unimarc.isUnimarc</span><span class="PUNC">(</span><span class="NAME">recordOrType</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3074</span> </span><span class="WHIT">				</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"unimarc"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3075</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3076</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3077</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3078</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">multilingual</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._isMultilingual</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3079</span> 
<span class='line'>3080</span> </span><span class="WHIT">		</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3081</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"unimarc"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3082</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">multilingual</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3083</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcMultilingualImportConverter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3084</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3085</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3086</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.UnimarcImportConverter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3087</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3088</span> </span><span class="WHIT">		</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"marc21"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3089</span> </span><span class="WHIT">		</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>3090</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">multilingual</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3091</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Marc21MultilingualImportConverter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3092</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3093</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3094</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.ImportConverter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3095</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3096</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3097</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3098</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3099</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3100</span> 	 * Returns a constructor derived from the appropriate import converter. This
<span class='line'>3101</span> 	 * allows client translators to subclass converters.
<span class='line'>3102</span> 	 * @param {String|Marc.Record} recordOrType the Marc type ("unimarc" or "marc21") or a record to
<span class='line'>3103</span> 	 * be converted. In the latter case, the Marc type will be auto-detected from the
<span class='line'>3104</span> 	 * record's fields.
<span class='line'>3105</span> 	 * @param {Object} [overrides] an object containing method overrides
<span class='line'>3106</span> 	 * @example
<span class='line'>3107</span> 	 * var converterClass = Marc.Converters.subclassImportConverter(myrecord, {
<span class='line'>3108</span> 	 *		//Include some non-standard subfields
<span class='line'>3109</span> 	 *		_getAbstract : function(record, item) {
<span class='line'>3110</span> 	 *			var value = record.getValue(
<span class='line'>3111</span> 	 *				[Marc.Unimarc.Tags.DISSERTATION_THESIS_NOTE,
<span class='line'>3112</span> 	 *		         Marc.Unimarc.Tags.SUMMARY_OR_ABSTRACT], 
<span class='line'>3113</span> 	 *				"abced",
<span class='line'>3114</span> 	 *	    		{fieldJoin: "\n"});
<span class='line'>3115</span> 	 *			if(value) {
<span class='line'>3116</span> 	 *				item.abstractNote = value;
<span class='line'>3117</span> 	 *			};
<span class='line'>3118</span> 	 *		},
<span class='line'>3119</span> 	 *		//Call superclass
<span class='line'>3120</span> 	 *		_getTitle : function(record, item) {
<span class='line'>3121</span> 	 *			Marc.UnimarcImportConverter.prototype.call(this, record, item);
<span class='line'>3122</span> 	 *			item.title = "[ADDED BY SUBCLASS]" + item.title;
<span class='line'>3123</span> 	 *		}
<span class='line'>3124</span> 	 * });
<span class='line'>3125</span> 	 * var converter = new converterClass();
<span class='line'>3126</span> 	 * var item = converter.convert(myrecord);
<span class='line'>3127</span> 	 */</span><span class="WHIT">
<span class='line'>3128</span> </span><span class="WHIT">	</span><span class="NAME">subclassImportConverter</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">recordOrType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">overrides</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3129</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">superclass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getImportConverter</span><span class="PUNC">(</span><span class="NAME">recordOrType</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3130</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">subclass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3131</span> </span><span class="WHIT">		</span><span class="NAME">subclass.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">superclass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3132</span> </span><span class="WHIT">		</span><span class="NAME">subclass.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">subclass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3133</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">overrides</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3134</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">overrides</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3135</span> </span><span class="WHIT">				</span><span class="NAME">subclass.prototype</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">overrides</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3136</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3137</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3138</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">subclass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3139</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3140</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3141</span> 
<span class='line'>3142</span> </span><span class="COMM">//IO</span><span class="WHIT">
<span class='line'>3143</span> 
<span class='line'>3144</span> </span><span class="COMM">/**
<span class='line'>3145</span>  * Constructs an Importer.
<span class='line'>3146</span>  * @class Importers are responsible for setting up a Marc.Record instance from external data,
<span class='line'>3147</span>  * e.g. binary record data or pairs of field tags and raw field data.
<span class='line'>3148</span>  */</span><span class="WHIT">
<span class='line'>3149</span> </span><span class="NAME">Marc.Importer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3150</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3151</span> 
<span class='line'>3152</span> </span><span class="NAME">Marc.Importer.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3153</span> </span><span class="WHIT">	</span><span class="NAME">constructor</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Marc.Importer</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3154</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3155</span> 	 * Fill a record from binary MARC data.
<span class='line'>3156</span> 	 * @param {String} data "binary" source data in string form. Character set conversion
<span class='line'>3157</span> 	 * is supposed to have happened at this point.
<span class='line'>3158</span> 	 * @returns {Marc.Record} the created record
<span class='line'>3159</span> 	 */</span><span class="WHIT">
<span class='line'>3160</span> </span><span class="WHIT">	</span><span class="NAME">parseBinary</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3161</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Records.newRecord</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3162</span> </span><span class="WHIT">		</span><span class="COMM">// get directory and leader</span><span class="WHIT">
<span class='line'>3163</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">header</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">data.indexOf</span><span class="PUNC">(</span><span class="NAME">Marc.Delimiters.FIELD_TERMINATOR</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3164</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">leader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">record.setLeader</span><span class="PUNC">(</span><span class="NAME">header.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">24</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3165</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">directory</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">header.substr</span><span class="PUNC">(</span><span class="NUMB">24</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3166</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3167</span> </span><span class="WHIT">		</span><span class="COMM">// get various data</span><span class="WHIT">
<span class='line'>3168</span> </span><span class="WHIT">		</span><span class="NAME">this.indicatorLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">leader.getIndicatorLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3169</span> </span><span class="WHIT">		</span><span class="NAME">this.subfieldCodeLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">leader.getSubfieldDelimiterLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3170</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">baseAddress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">leader.getBaseAddress</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3171</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dirEntryLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3172</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">leader.getDirectoryLengthLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>3173</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">leader.getDirectoryStartLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>3174</span> </span><span class="WHIT">			</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">leader.getDirectoryImplLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3175</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3176</span> </span><span class="WHIT">		</span><span class="COMM">// get record data</span><span class="WHIT">
<span class='line'>3177</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">contentTmp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data.substr</span><span class="PUNC">(</span><span class="NAME">baseAddress</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3178</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3179</span> </span><span class="WHIT">		</span><span class="COMM">// MARC wants one-byte characters, so when we have multi-byte UTF-8</span><span class="WHIT">
<span class='line'>3180</span> </span><span class="WHIT">		</span><span class="COMM">// sequences, add null characters so that the directory shows up right. we</span><span class="WHIT">
<span class='line'>3181</span> </span><span class="WHIT">		</span><span class="COMM">// can strip the nulls later.</span><span class="WHIT">
<span class='line'>3182</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">content</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3183</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">contentTmp.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3184</span> </span><span class="WHIT">			</span><span class="NAME">content</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">contentTmp</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3185</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">contentTmp.charCodeAt</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0x00FFFF</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3186</span> </span><span class="WHIT">				</span><span class="NAME">content</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\x00\x00\x00"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3187</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3188</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">contentTmp.charCodeAt</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0x0007FF</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3189</span> </span><span class="WHIT">				</span><span class="NAME">content</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\x00\x00"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3190</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3191</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">contentTmp.charCodeAt</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0x00007F</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3192</span> </span><span class="WHIT">				</span><span class="NAME">content</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"\x00"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3193</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3194</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3195</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3196</span> </span><span class="WHIT">		</span><span class="COMM">// read directory</span><span class="WHIT">
<span class='line'>3197</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">directory.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dirEntryLength</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3198</span> </span><span class="WHIT">			</span><span class="COMM">//Parse directory entry</span><span class="WHIT">
<span class='line'>3199</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">directory.substr</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3200</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">directory.substr</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">leader.getDirectoryLengthLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3201</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">directory.substr</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">+</span><span class="NAME">leader.getDirectoryLengthLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3202</span> </span><span class="WHIT">					</span><span class="NAME">leader.getDirectoryStartLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3203</span> </span><span class="WHIT">					</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3204</span> </span><span class="WHIT">			</span><span class="COMM">//Get field contents</span><span class="WHIT">
<span class='line'>3205</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">content.substr</span><span class="PUNC">(</span><span class="NAME">pos</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\x00/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3206</span> </span><span class="WHIT">			</span><span class="COMM">//Add field</span><span class="WHIT">
<span class='line'>3207</span> </span><span class="WHIT">			</span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parse</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3208</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3209</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3210</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3211</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3212</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3213</span> 	 * Fill a record from preprocessed data.
<span class='line'>3214</span> 	 * @param {Array} data an array of objects with the properties "tag" and "value",
<span class='line'>3215</span> 	 * holding each a field tag and the corresonding raw value (including the indicator,
<span class='line'>3216</span> 	 * if applicable). The record leader's tag must be either empty
<span class='line'>3217</span> 	 * or have one of the following conventional values: "000", "LDR".
<span class='line'>3218</span> 	 * @returns {Marc.Record} the created record.
<span class='line'>3219</span> 	 */</span><span class="WHIT">
<span class='line'>3220</span> </span><span class="WHIT">	</span><span class="NAME">parseFields</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3221</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Records.newRecord</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3222</span> </span><span class="WHIT">		</span><span class="NAME">data.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3223</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">field.tag</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">field.tag</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"000"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">field.tag</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"LDR"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3224</span> </span><span class="WHIT">				</span><span class="NAME">record.setLeader</span><span class="PUNC">(</span><span class="NAME">field.value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3225</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3226</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3227</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/\d{3}/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">field.tag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3228</span> </span><span class="WHIT">					</span><span class="COMM">//Replace common subfield delimiters</span><span class="WHIT">
<span class='line'>3229</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.value.replace</span><span class="PUNC">(</span><span class="REGX">/[\xa4\$]([a-z0-9])/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3230</span> </span><span class="WHIT">							</span><span class="NAME">Marc.Delimiters.SUBFIELD_DELIMITER</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"$1"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3231</span> </span><span class="WHIT">					</span><span class="NAME">record.addField</span><span class="PUNC">(</span><span class="NAME">field.tag</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parse</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3232</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3233</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3234</span> </span><span class="WHIT">					</span><span class="NAME">Zotero.debug</span><span class="PUNC">(</span><span class="STRN">"Skipping invalid tag \""</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">field.tag</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"\""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3235</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3236</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3237</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3238</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3239</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3240</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3241</span> 
<span class='line'>3242</span> </span><span class="COMM">/**
<span class='line'>3243</span>  * @namespace Importer utilities
<span class='line'>3244</span>  */</span><span class="WHIT">
<span class='line'>3245</span> </span><span class="NAME">Marc.IO</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3246</span> </span><span class="WHIT">	</span><span class="NAME">_maxRecords</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3247</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3248</span> 	 * Get an appropriate Importer instance for a giben format. Currently, this will always
<span class='line'>3249</span> 	 * return new {@link Marc.Importer}.
<span class='line'>3250</span> 	 * @returns {Marc.Importer}
<span class='line'>3251</span> 	 */</span><span class="WHIT">
<span class='line'>3252</span> </span><span class="WHIT">	</span><span class="NAME">getImporter</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">format</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3253</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Marc.Importer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3254</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3255</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3256</span> </span><span class="WHIT">	</span><span class="COMM">/** Limit the number of records to be imported from binary sources. 
<span class='line'>3257</span> 	 * @param {Integer} max the maximum number of records to be imported. -1 means no limit. */</span><span class="WHIT">
<span class='line'>3258</span> </span><span class="WHIT">	</span><span class="NAME">setMaxImportRecords</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">max</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3259</span> </span><span class="WHIT">		</span><span class="NAME">this._maxRecords</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">max</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3260</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3261</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3262</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3263</span> </span><span class="WHIT">	</span><span class="COMM">/**  
<span class='line'>3264</span> 	 * @returns {Integer} the maximum number of records to be imported. -1 means no limit. 
<span class='line'>3265</span> 	 * */</span><span class="WHIT">
<span class='line'>3266</span> </span><span class="WHIT">	</span><span class="NAME">getMaxImportRecords</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3267</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._maxRecords</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3268</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3269</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3270</span> 
<span class='line'>3271</span> 
<span class='line'>3272</span> </span><span class="COMM">/* Initialization. */</span><span class="WHIT">
<span class='line'>3273</span> </span><span class="NAME">Marc.Config.setTypeOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3274</span> 
<span class='line'>3275</span> </span><span class="COMM">//Public API</span><span class="WHIT">
<span class='line'>3276</span> 
<span class='line'>3277</span> </span><span class="COMM">//Debugging</span><span class="WHIT">
<span class='line'>3278</span> </span><span class="NAME">Marc.IO.setMaxImportRecords</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3279</span> 
<span class='line'>3280</span> </span><span class="COMM">/**
<span class='line'>3281</span>  * Detect binary record leader.
<span class='line'>3282</span>  * TODO: sniff charset and call Zotero.setCharacterSet() ? 
<span class='line'>3283</span>  * */</span><span class="WHIT">
<span class='line'>3284</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">detectImport</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3285</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">marcRecordRegexp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/^[0-9]{5}[a-z ]{3}$/</span><span class="WHIT">
<span class='line'>3286</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">read</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.read</span><span class="PUNC">(</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3287</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">marcRecordRegexp.test</span><span class="PUNC">(</span><span class="NAME">read</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3288</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3289</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3290</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3291</span> 
<span class='line'>3292</span> </span><span class="COMM">/**
<span class='line'>3293</span>  * Import binary MARC data
<span class='line'>3294</span>  */</span><span class="WHIT">
<span class='line'>3295</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">doImport</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3296</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">maxRecords</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.IO.getMaxImportRecords</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3297</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">recordsRead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3298</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3299</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">holdOver</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">	</span><span class="COMM">// part of the text held over from the last loop</span><span class="WHIT">
<span class='line'>3300</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">importer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.IO.getImporter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3301</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3302</span> </span><span class="WHIT">	</span><span class="COMM">// read in 4096 byte increments</span><span class="WHIT">
<span class='line'>3303</span> </span><span class="WHIT">	</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.read</span><span class="PUNC">(</span><span class="NUMB">4096</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3304</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">records</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text.split</span><span class="PUNC">(</span><span class="NAME">Marc.Delimiters.RECORD_TERMINATOR</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3305</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3306</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">records.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3307</span> </span><span class="WHIT">			</span><span class="NAME">records</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">holdOver</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">records</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3308</span> </span><span class="WHIT">			</span><span class="NAME">holdOver</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">records.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// skip last record, since it's not done</span><span class="WHIT">
<span class='line'>3309</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3310</span> </span><span class="WHIT">			</span><span class="COMM">//Record loop</span><span class="WHIT">
<span class='line'>3311</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">records</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3312</span> </span><span class="WHIT">				</span><span class="COMM">//Parse binary data</span><span class="WHIT">
<span class='line'>3313</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">importer.parseBinary</span><span class="PUNC">(</span><span class="NAME">records</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">record</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3314</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3315</span> </span><span class="WHIT">					</span><span class="COMM">//Get converter</span><span class="WHIT">
<span class='line'>3316</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">converter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Converters.getImportConverter</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3317</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>3318</span> </span><span class="WHIT">					</span><span class="COMM">//Translate</span><span class="WHIT">
<span class='line'>3319</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">converter.convert</span><span class="PUNC">(</span><span class="NAME">record</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3320</span> </span><span class="WHIT">					</span><span class="NAME">item.complete</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3321</span> </span><span class="WHIT">					</span><span class="NAME">recordsRead</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3322</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">maxRecords</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">recordsRead</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">maxRecords</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3323</span> </span><span class="WHIT">						</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3324</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3325</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3326</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3327</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3328</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3329</span> </span><span class="WHIT">			</span><span class="NAME">holdOver</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3330</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3331</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">maxRecords</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">recordsRead</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">maxRecords</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3332</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3333</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3334</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3335</span> 
<span class='line'>3336</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3337</span> 
<span class='line'>3338</span> </span><span class="COMM">/**
<span class='line'>3339</span>  * Export binary MARC format. Currently not operational (unimarc records will be
<span class='line'>3340</span>  * constructed, but no output is yet generated).
<span class='line'>3341</span>  */</span><span class="WHIT">
<span class='line'>3342</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">doExport</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3343</span> </span><span class="WHIT">	</span><span class="NAME">Zotero.setCharacterSet</span><span class="PUNC">(</span><span class="STRN">"utf-8"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3344</span> </span><span class="WHIT">	</span><span class="COMM">//Get MARC style</span><span class="WHIT">
<span class='line'>3345</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">marcType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Config.getTypeOption</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3346</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">marcType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3347</span> </span><span class="WHIT">		</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">"Choose a single export format"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3348</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3349</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3350</span> </span><span class="WHIT">	</span><span class="COMM">//Get converter (item -> record)</span><span class="WHIT">
<span class='line'>3351</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">converter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Marc.Converters.get</span><span class="PUNC">(</span><span class="NAME">marcType</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3352</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3353</span> </span><span class="WHIT">	</span><span class="COMM">//Item loop</span><span class="WHIT">
<span class='line'>3354</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">item</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3355</span> </span><span class="WHIT">	</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">item</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Zotero.nextItem</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3356</span> </span><span class="WHIT">		</span><span class="NAME">Zotero.debug</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3357</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">record</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">converter.convert</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3358</span> </span><span class="WHIT">		</span><span class="NAME">record.dump</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3359</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3360</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3361</span> 
<span class='line'>3362</span> 
<span class='line'>3363</span> </span></pre></body></html>